<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Quarto Template Repo to Create Big Reports and Very Long Title Because Long Titles are Common - 4&nbsp; 4 Transformação de dados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_funcoes.html" rel="next">
<link href="./03_objetcs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04_transfomacao-de-dados.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">4  Transformação de dados</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A Quarto Template Repo to Create Big Reports and Very Long Title Because Long Titles are Common</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RVerse-Tutorials/QmdReport" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./A-Quarto-Template-Repo-to-Create-Big-Reports-and-Very-Long-Title-Because-Long-Titles-are-Common.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./A-Quarto-Template-Repo-to-Create-Big-Reports-and-Very-Long-Title-Because-Long-Titles-are-Common.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Informações Úteis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_basicR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">2 Conceitos Básicos do Ambiente R e Importação e Exportação de Dados e Objetos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_objetcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">3 Objetos em R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_transfomacao-de-dados.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">4 Transformação de dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_funcoes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">5 Funções e Expressões</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_loopings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">6 Estruturas de Repetição: <em>Loopings</em></span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pipes" id="toc-pipes" class="nav-link active" data-scroll-target="#pipes"><span class="header-section-number">4.1</span> 4.1 Pipes</a>
  <ul class="collapse">
  <li><a href="#uso-do-pipe" id="toc-uso-do-pipe" class="nav-link" data-scroll-target="#uso-do-pipe"><span class="header-section-number">4.1.1</span> 4.1.1 Uso do pipe</a></li>
  <li><a href="#benefícios-dos-pipes" id="toc-benefícios-dos-pipes" class="nav-link" data-scroll-target="#benefícios-dos-pipes"><span class="header-section-number">4.1.2</span> 4.1.2 Benefícios dos Pipes</a></li>
  <li><a href="#pipe-de-atribuição" id="toc-pipe-de-atribuição" class="nav-link" data-scroll-target="#pipe-de-atribuição"><span class="header-section-number">4.1.3</span> 4.1.3 Pipe de atribuição</a></li>
  </ul></li>
  <li><a href="#manipulação-de-dados" id="toc-manipulação-de-dados" class="nav-link" data-scroll-target="#manipulação-de-dados"><span class="header-section-number">4.2</span> 4.2 Manipulação de Dados</a>
  <ul class="collapse">
  <li><a href="#seleção-de-variáveis" id="toc-seleção-de-variáveis" class="nav-link" data-scroll-target="#seleção-de-variáveis"><span class="header-section-number">4.2.1</span> 4.2.1 Seleção de Variáveis</a></li>
  <li><a href="#seleção-de-observações" id="toc-seleção-de-observações" class="nav-link" data-scroll-target="#seleção-de-observações"><span class="header-section-number">4.2.2</span> 4.2.2 Seleção de Observações</a></li>
  <li><a href="#resumo-de-informações" id="toc-resumo-de-informações" class="nav-link" data-scroll-target="#resumo-de-informações"><span class="header-section-number">4.2.3</span> 4.2.3 Resumo de informações</a></li>
  </ul></li>
  <li><a href="#exercício" id="toc-exercício" class="nav-link" data-scroll-target="#exercício"><span class="header-section-number">4.3</span> 4.3 Exercício</a></li>
  <li><a href="#manipulação-de-data-no-r" id="toc-manipulação-de-data-no-r" class="nav-link" data-scroll-target="#manipulação-de-data-no-r"><span class="header-section-number">4.4</span> 4.4 Manipulação de Data no R</a>
  <ul class="collapse">
  <li><a href="#transformando-strings-em-datas" id="toc-transformando-strings-em-datas" class="nav-link" data-scroll-target="#transformando-strings-em-datas"><span class="header-section-number">4.4.1</span> 4.4.1 Transformando Strings em Datas</a></li>
  <li><a href="#manipulação-de-datas" id="toc-manipulação-de-datas" class="nav-link" data-scroll-target="#manipulação-de-datas"><span class="header-section-number">4.4.2</span> 4.4.2 Manipulação de Datas</a></li>
  <li><a href="#lubridate-facilitando-a-manipulação-de-datas-no-r" id="toc-lubridate-facilitando-a-manipulação-de-datas-no-r" class="nav-link" data-scroll-target="#lubridate-facilitando-a-manipulação-de-datas-no-r"><span class="header-section-number">4.4.3</span> 4.4.3 Lubridate: Facilitando a Manipulação de Datas no R</a></li>
  </ul></li>
  <li><a href="#exercícios" id="toc-exercícios" class="nav-link" data-scroll-target="#exercícios"><span class="header-section-number">4.5</span> 4.5 Exercícios</a></li>
  <li><a href="#junção-de-dados" id="toc-junção-de-dados" class="nav-link" data-scroll-target="#junção-de-dados"><span class="header-section-number">4.6</span> 4.6 Junção de dados</a>
  <ul class="collapse">
  <li><a href="#dados" id="toc-dados" class="nav-link" data-scroll-target="#dados"><span class="header-section-number">4.6.1</span> 4.6.1 Dados</a></li>
  <li><a href="#chaves-primárias-e-chaves-estrangeiras" id="toc-chaves-primárias-e-chaves-estrangeiras" class="nav-link" data-scroll-target="#chaves-primárias-e-chaves-estrangeiras"><span class="header-section-number">4.6.2</span> 4.6.2 Chaves Primárias e Chaves Estrangeiras</a></li>
  <li><a href="#combinando-dados" id="toc-combinando-dados" class="nav-link" data-scroll-target="#combinando-dados"><span class="header-section-number">4.6.3</span> 4.6.3 Combinando dados</a></li>
  <li><a href="#junções-mutacionais" id="toc-junções-mutacionais" class="nav-link" data-scroll-target="#junções-mutacionais"><span class="header-section-number">4.6.4</span> 4.6.4 Junções Mutacionais</a></li>
  <li><a href="#junções-de-filtragem" id="toc-junções-de-filtragem" class="nav-link" data-scroll-target="#junções-de-filtragem"><span class="header-section-number">4.6.5</span> 4.6.5 Junções de Filtragem</a></li>
  </ul></li>
  <li><a href="#exercícios-1" id="toc-exercícios-1" class="nav-link" data-scroll-target="#exercícios-1"><span class="header-section-number">4.7</span> 4.7 Exercícios</a></li>
  <li><a href="#organização-de-dados" id="toc-organização-de-dados" class="nav-link" data-scroll-target="#organização-de-dados"><span class="header-section-number">4.8</span> 4.8 Organização de dados</a>
  <ul class="collapse">
  <li><a href="#pivotagem" id="toc-pivotagem" class="nav-link" data-scroll-target="#pivotagem"><span class="header-section-number">4.8.1</span> 4.8.1 Pivotagem</a></li>
  <li><a href="#exercício-1" id="toc-exercício-1" class="nav-link" data-scroll-target="#exercício-1"><span class="header-section-number">4.8.2</span> 4.8.2 Exercício</a></li>
  <li><a href="#pivotando-dados-em-r" id="toc-pivotando-dados-em-r" class="nav-link" data-scroll-target="#pivotando-dados-em-r"><span class="header-section-number">4.8.3</span> 4.8.2 Pivotando dados em R</a></li>
  <li><a href="#exemplo" id="toc-exemplo" class="nav-link" data-scroll-target="#exemplo"><span class="header-section-number">4.8.4</span> 4.8.3 Exemplo</a></li>
  <li><a href="#exercícios-2" id="toc-exercícios-2" class="nav-link" data-scroll-target="#exercícios-2"><span class="header-section-number">4.8.5</span> 4.8.4 Exercícios</a></li>
  </ul></li>
  <li><a href="#strings" id="toc-strings" class="nav-link" data-scroll-target="#strings"><span class="header-section-number">4.9</span> 4.9 Strings</a>
  <ul class="collapse">
  <li><a href="#caracteres-especiais" id="toc-caracteres-especiais" class="nav-link" data-scroll-target="#caracteres-especiais"><span class="header-section-number">4.9.1</span> 4.9.1 Caracteres especiais</a></li>
  <li><a href="#concatenando-strings" id="toc-concatenando-strings" class="nav-link" data-scroll-target="#concatenando-strings"><span class="header-section-number">4.9.2</span> 4.9.2 Concatenando strings</a></li>
  <li><a href="#separando-strings" id="toc-separando-strings" class="nav-link" data-scroll-target="#separando-strings"><span class="header-section-number">4.9.3</span> 4.9.3 Separando Strings</a></li>
  <li><a href="#formatação-básica" id="toc-formatação-básica" class="nav-link" data-scroll-target="#formatação-básica"><span class="header-section-number">4.9.4</span> 4.9.4 Formatação básica</a></li>
  <li><a href="#comprimento-de-string" id="toc-comprimento-de-string" class="nav-link" data-scroll-target="#comprimento-de-string"><span class="header-section-number">4.9.5</span> 4.9.5 Comprimento de string</a></li>
  <li><a href="#substituição-de-strings" id="toc-substituição-de-strings" class="nav-link" data-scroll-target="#substituição-de-strings"><span class="header-section-number">4.9.6</span> 4.9.6 Substituição de strings</a></li>
  <li><a href="#expressões-regulares" id="toc-expressões-regulares" class="nav-link" data-scroll-target="#expressões-regulares"><span class="header-section-number">4.9.7</span> 4.9.7 Expressões Regulares</a></li>
  <li><a href="#exercício-2" id="toc-exercício-2" class="nav-link" data-scroll-target="#exercício-2"><span class="header-section-number">4.9.8</span> 4.9.8 Exercício</a></li>
  </ul></li>
  <li><a href="#cheatsheets" id="toc-cheatsheets" class="nav-link" data-scroll-target="#cheatsheets"><span class="header-section-number">4.10</span> 4.10 Cheatsheets</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RVerse-Tutorials/QmdReport/edit/main/04_transfomacao-de-dados.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/RVerse-Tutorials/QmdReport/blob/main/04_transfomacao-de-dados.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/RVerse-Tutorials/QmdReport/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">4 Transformação de dados</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pipes" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="pipes"><span class="header-section-number">4.1</span> 4.1 Pipes</h2>
<p><img src="./imagens/pipes.png" class="img-fluid"></p>
<p>Uma maneira de fazermos os códigos em R mais legíveis é através da utilização dos operadores pipe. Os pipes fazem com a sequência das análises se torne mais aparente, o que torna o código muito menos complexo e mais fácil de ser alterado.</p>
<p>Tomemos como exemplo a seguinte análise: Seja <code>x</code> um vetor com 9 elementos, queremos obter um vetor ordenado do cosseno desses valores. Para fazer isso em R podemos aninhar diversas funções.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -4 -3 -2 -1  0  1  2  3  4</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0000000  0.5403023  0.5403023 -0.4161468 -0.4161468 -0.6536436 -0.6536436
[8] -0.9899925 -0.9899925</code></pre>
</div>
</div>
<p>O que torna o código pouco legível e difícil de ser interpretado.</p>
<p>Podemos identar o código para faciliar a leitura:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0000000  0.5403023  0.5403023 -0.4161468 -0.4161468 -0.6536436 -0.6536436
[8] -0.9899925 -0.9899925</code></pre>
</div>
</div>
<p>Contudo, ainda assim, o código não é de fácil compreensão, principalmente porque devemos ler o código de dentro para fora. Os pipes surgem como uma alternativa para solucionar esse problema, tornando os códigos mais legíveis e debugáveis. Os pipes, representados pelo operador <code>%&gt;%</code>, são uma característica poderosa e conveniente introduzida pelo pacote <code>magrittr</code> e amplamente adotada em R para simplificar a manipulação de dados. Os pipes permitem encadear sequências de operações em uma maneira legível e intuitiva, tornando o código mais conciso e fácil de entender.</p>
<p><strong>Funcionamento dos Pipes</strong>: O operador <code>%&gt;%</code> permite que você passe o resultado de uma expressão como o primeiro argumento de outra expressão. Isso é particularmente útil ao realizar uma série de transformações em um objeto sem a necessidade de criar variáveis intermediárias. O mesmo código que vimos anteriormente, com a utilização de pipe ficaria:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: magrittr</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0000000  0.5403023  0.5403023 -0.4161468 -0.4161468 -0.6536436 -0.6536436
[8] -0.9899925 -0.9899925</code></pre>
</div>
</div>
<section id="uso-do-pipe" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="uso-do-pipe"><span class="header-section-number">4.1.1</span> 4.1.1 Uso do pipe</h3>
<ul>
<li><code>x %&gt;% f</code> é equivalente à <code>f(x)</code></li>
<li><code>x %&gt;% f(y)</code> é equivalente à <code>f(x, y)</code></li>
<li><code>x %&gt;% f %&gt;% g %&gt;% h</code> é equivalente à <code>h(g(f(x)))</code></li>
</ul>
<p>O <code>%&gt;%</code> significa que o elemento à esquerda sera avaliado pela função à direita.</p>
<p>Podemos também utilizar o <code>.</code> como espaço reservado para o elemento à esquerda, isto é:</p>
<ul>
<li><code>x %&gt;% f(y, .)</code> é equivalente à <code>f(y, x)</code></li>
<li><code>x %&gt;% f(., y)</code> é equivalente à <code>f(x, y)</code></li>
<li><code>x %&gt;% f(y, z = .)</code> é equivalente à <code>f(y, z = x)</code>.</li>
</ul>
<section id="exemplos" class="level4" data-number="4.1.1.1">
<h4 data-number="4.1.1.1" class="anchored" data-anchor-id="exemplos"><span class="header-section-number">4.1.1.1</span> 4.1.1.1 Exemplos</h4>
<p>Note que não conseguimos utilizar o <code>%&gt;%</code> com operadores aritiméticos. Portanto, uma alternativa é utiliarmos as funções <code>add()</code>, <code>subtract()</code>, <code>multiply_by()</code>, <code>raise_to_power()</code>, <code>divide_by()</code> etc. Para a lista completa de funções, utilize <code>?add</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1]  2.197622  3.849113 12.793542  5.352542  5.646439 13.575325  7.304581
 [8] -1.325306  1.565736  2.771690</code></pre>
</div>
</div>
<p>Outra opção é utilizarmos os a operação entre aspas.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1]  2.197622  3.849113 12.793542  5.352542  5.646439 13.575325  7.304581
 [8] -1.325306  1.565736  2.771690</code></pre>
</div>
</div>
</section>
</section>
<section id="benefícios-dos-pipes" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="benefícios-dos-pipes"><span class="header-section-number">4.1.2</span> 4.1.2 Benefícios dos Pipes</h3>
<ul>
<li><p><strong>Legibilidade</strong>: Os pipes permitem ler o código da esquerda para a direita, refletindo a sequência de operações realizadas.</p></li>
<li><p><strong>Redução de Variáveis Intermediárias</strong>: Com pipes, não precisamos criar variáveis intermediárias para armazenar resultados parciais.</p></li>
<li><p><strong>Encadeamento Simples</strong>: O encadeamento de operações se torna mais intuitivo e fácil de seguir o código e procedimentos.</p></li>
<li><p><strong>Depuração</strong>: Ao usar pipes, podemos isolar cada etapa para depuração, facilitando a identificação de erros.</p></li>
</ul>
</section>
<section id="pipe-de-atribuição" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="pipe-de-atribuição"><span class="header-section-number">4.1.3</span> 4.1.3 Pipe de atribuição</h3>
<p>Muitas vezes queremos realizar opereções e atribuir os resultados ao mesmo <code>data.frame</code> de entrada, por exemplo, podemos querer criar uma nova variável em <code>meu_data_frame</code>, porem, não temos interesse em duplicar o banco de dados. Podemos fazer uma atribuição explicita ou implicita. Para a explicita, simplismente atribuímos utilizando <code>=</code> ou <code>&lt;-</code>, como vimos até agora durante o curso. Porém, podemos fazer uma atribuição implicita utilizando o operador <code>%&lt;&gt;%</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: dplyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8
Columns: 5
$ nome               &lt;chr&gt; "Alice", "Bob", "Carol", "Ana", "João", "Carlos", "…
$ idade              &lt;dbl&gt; 25, 30, 28, 20, 27, 50, 60, 45
$ salario            &lt;dbl&gt; 5000, 6000, 5500, 8000, 2000, 3500, 10000, 3800
$ meio_de_transporte &lt;chr&gt; "onibus", "bicicleta", "onibus", "carro", "carro", …
$ idade_25           &lt;lgl&gt; FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8
Columns: 6
$ nome               &lt;chr&gt; "Alice", "Bob", "Carol", "Ana", "João", "Carlos", "…
$ idade              &lt;dbl&gt; 25, 30, 28, 20, 27, 50, 60, 45
$ salario            &lt;dbl&gt; 5000, 6000, 5500, 8000, 2000, 3500, 10000, 3800
$ meio_de_transporte &lt;chr&gt; "onibus", "bicicleta", "onibus", "carro", "carro", …
$ idade_25           &lt;lgl&gt; FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE
$ idade_50           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FAL…</code></pre>
</div>
</div>
</section>
</section>
<section id="manipulação-de-dados" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="manipulação-de-dados"><span class="header-section-number">4.2</span> 4.2 Manipulação de Dados</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: data.table</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: tidyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    extract</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 864,561
Columns: 24
$ data                           &lt;chr&gt; "01/01/2010", "01/01/2010", "01/01/2010…
$ horario                        &lt;chr&gt; "04:21:00", "02:13:00", "03:35:00", "07…
$ n_da_ocorrencia                &lt;chr&gt; "18", "20", "000024/2010", "000038/2010…
$ tipo_de_ocorrencia             &lt;chr&gt; "sem vítima", "sem vítima", "sem vítima…
$ km                             &lt;chr&gt; "167", "269,5", "77", "52", "33", "24",…
$ trecho                         &lt;chr&gt; "BR-393/RJ", "BR-116/PR", "BR-290/RS", …
$ sentido                        &lt;chr&gt; "Norte", "Sul", "Norte", "Norte", "Nort…
$ lugar_acidente                 &lt;chr&gt; "Rodovia do Aço", "Autopista Regis Bitt…
$ tipo_de_acidente               &lt;chr&gt; "Derrapagem", "Colisão Traseira", "COLI…
$ automovel                      &lt;int&gt; 1, 2, 2, 0, 0, 1, 1, 1, 2, 1, NA, 1, 1,…
$ bicicleta                      &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ caminhao                       &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ moto                           &lt;int&gt; NA, NA, 0, 1, 1, 0, NA, NA, NA, NA, 1, …
$ onibus                         &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ outros                         &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ tracao_animal                  &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ transporte_de_cargas_especiais &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ trator_maquinas                &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ utilitarios                    &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ ilesos                         &lt;int&gt; 1, 3, 2, 1, 1, 1, 3, 4, 4, 1, 0, 1, 1, …
$ levemente_feridos              &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, 5, NA, 2, NA…
$ moderadamente_feridos          &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …
$ gravemente_feridos             &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …
$ mortos                         &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …</code></pre>
</div>
</div>
<section id="seleção-de-variáveis" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="seleção-de-variáveis"><span class="header-section-number">4.2.1</span> 4.2.1 Seleção de Variáveis</h3>
<p>No <code>tidyverse</code>, a função <code>select()</code> do pacote <code>dplyr</code> é amplamente utilizada para selecionar as colunas relevantes de um conjunto de dados. Além de selecionar colunas pelo nome, a função <code>select()</code> oferece diversas opções avançadas para facilitar a seleção e manipulação de colunas. Vamos explorar algumas dessas opções:</p>
<section id="seleção-por-nome-de-coluna" class="level4" data-number="4.2.1.1">
<h4 data-number="4.2.1.1" class="anchored" data-anchor-id="seleção-por-nome-de-coluna"><span class="header-section-number">4.2.1.1</span> 4.2.1.1 Seleção por Nome de Coluna</h4>
<p>A forma mais simples de usar o <code>select()</code> é especificar os nomes das colunas que você deseja manter no resultado, por exemplo, podemos estar interessados em selecionarmos a <code>data</code> e o <code>tipo_de_acidente</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         data tipo_de_acidente
1: 01/01/2010       Derrapagem
2: 01/01/2010 Colisão Traseira
3: 01/01/2010  COLISÃO LATERAL
4: 01/01/2010    QUEDA DE MOTO
5: 01/01/2010    QUEDA DE MOTO
6: 01/01/2010   SAÍDA DE PISTA</code></pre>
</div>
</div>
<ol type="1">
<li>Seleção por Nome de Coluna que inicie com alguma palavra - <code>starts_with()</code>: Essa função permite selecionar colunas cujos nomes começam com um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que iniciem com “tipo”.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   tipo_de_ocorrencia tipo_de_acidente
1:         sem vítima       Derrapagem
2:         sem vítima Colisão Traseira
3:         sem vítima  COLISÃO LATERAL
4:         sem vítima    QUEDA DE MOTO
5:         sem vítima    QUEDA DE MOTO
6:         sem vítima   SAÍDA DE PISTA</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Seleção por Nome de Coluna que termine com alguma palavra - <code>ends_with()</code>: Essa função permite selecionar colunas cujos nomes terminam com um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que terminem com “feridos”.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   levemente_feridos moderadamente_feridos gravemente_feridos
1:                 0                     0                  0
2:                NA                    NA                 NA
3:                 0                     0                  0
4:                 0                     0                  0
5:                 0                     0                  0
6:                 0                     0                  0</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Seleção por Nome de Coluna que contenha alguma palavra - <code>contains()</code>: Essa função permite selecionar colunas cujos nomes contenham um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que contenham “mente”.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   levemente_feridos moderadamente_feridos gravemente_feridos
1:                 0                     0                  0
2:                NA                    NA                 NA
3:                 0                     0                  0
4:                 0                     0                  0
5:                 0                     0                  0
6:                 0                     0                  0</code></pre>
</div>
</div>
</section>
<section id="seleção-de-variáveis-por-tipos-específicos-de-dados" class="level4" data-number="4.2.1.2">
<h4 data-number="4.2.1.2" class="anchored" data-anchor-id="seleção-de-variáveis-por-tipos-específicos-de-dados"><span class="header-section-number">4.2.1.2</span> 4.2.1.2 Seleção de variáveis por Tipos específicos de dados</h4>
<p>Muitas vezes, estamos interessados em selecionar apenas variáveis de um tipo, para tratarmos os dados da maneira mais adequada.</p>
<ol type="1">
<li>Selecionar apenas variáveis numéricas: <code>is.numeric()</code></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 864,561
Columns: 15
$ automovel                      &lt;int&gt; 1, 2, 2, 0, 0, 1, 1, 1, 2, 1, NA, 1, 1,…
$ bicicleta                      &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ caminhao                       &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ moto                           &lt;int&gt; NA, NA, 0, 1, 1, 0, NA, NA, NA, NA, 1, …
$ onibus                         &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ outros                         &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ tracao_animal                  &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ transporte_de_cargas_especiais &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ trator_maquinas                &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ utilitarios                    &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA,…
$ ilesos                         &lt;int&gt; 1, 3, 2, 1, 1, 1, 3, 4, 4, 1, 0, 1, 1, …
$ levemente_feridos              &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, 5, NA, 2, NA…
$ moderadamente_feridos          &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …
$ gravemente_feridos             &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …
$ mortos                         &lt;int&gt; 0, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, …</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Selecionar apenas variáveis characters: <code>is.character()</code></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 864,561
Columns: 9
$ data               &lt;chr&gt; "01/01/2010", "01/01/2010", "01/01/2010", "01/01/20…
$ horario            &lt;chr&gt; "04:21:00", "02:13:00", "03:35:00", "07:31:00", "04…
$ n_da_ocorrencia    &lt;chr&gt; "18", "20", "000024/2010", "000038/2010", "000027/2…
$ tipo_de_ocorrencia &lt;chr&gt; "sem vítima", "sem vítima", "sem vítima", "sem víti…
$ km                 &lt;chr&gt; "167", "269,5", "77", "52", "33", "24", "52", "40",…
$ trecho             &lt;chr&gt; "BR-393/RJ", "BR-116/PR", "BR-290/RS", "BR-116/RS",…
$ sentido            &lt;chr&gt; "Norte", "Sul", "Norte", "Norte", "Norte", "Sul", "…
$ lugar_acidente     &lt;chr&gt; "Rodovia do Aço", "Autopista Regis Bittencourt", "C…
$ tipo_de_acidente   &lt;chr&gt; "Derrapagem", "Colisão Traseira", "COLISÃO LATERAL"…</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Selecionar apenas variáveis lógicas: <code>is.logical()</code></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 0
Columns: 0</code></pre>
</div>
</div>
</section>
<section id="seleção-por-critérios" class="level4" data-number="4.2.1.3">
<h4 data-number="4.2.1.3" class="anchored" data-anchor-id="seleção-por-critérios"><span class="header-section-number">4.2.1.3</span> 4.2.1.3 Seleção por critérios</h4>
<ul>
<li><code>all_of()</code>, <code>any_of()</code>: Permitem usar variáveis definidas externamente como argumentos da função. Note que quando utilizamos <code>all_of()</code> todas as variáveis devem existir, já <code>any_of()</code> permite que nem todas as variáveis existam no banco de dados.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 864,561
Columns: 3
$ automovel &lt;int&gt; 1, 2, 2, 0, 0, 1, 1, 1, 2, 1, NA, 1, 1, 2, 2, 1, 1, NA, 1, 2…
$ bicicleta &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, N…
$ onibus    &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, N…</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 864,561
Columns: 3
$ automovel &lt;int&gt; 1, 2, 2, 0, 0, 1, 1, 1, 2, 1, NA, 1, 1, 2, 2, 1, 1, NA, 1, 2…
$ bicicleta &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, N…
$ onibus    &lt;int&gt; NA, NA, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, N…</code></pre>
</div>
</div>
</section>
</section>
<section id="seleção-de-observações" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="seleção-de-observações"><span class="header-section-number">4.2.2</span> 4.2.2 Seleção de Observações</h3>
<p>No pacote <code>dplyr</code> do tidyverse, a função <code>filter()</code> é amplamente utilizada para filtrar linhas de um conjunto de dados com base em condições específicas. Ela oferece diversas opções para criar filtros complexos que atendam às suas necessidades de análise. Vamos explorar diferentes tipos de filtros e como utilizá-los de maneira eficaz.</p>
<section id="filtros-simples" class="level4" data-number="4.2.2.1">
<h4 data-number="4.2.2.1" class="anchored" data-anchor-id="filtros-simples"><span class="header-section-number">4.2.2.1</span> 4.2.2.1 Filtros Simples</h4>
<p>Filtros simples envolvem comparações entre valores de uma coluna e um valor constante. Alguns operadores de comparação comuns incluem:</p>
<ul>
<li><p><code>==</code>: Igual a</p></li>
<li><p><code>!=</code>: Diferente de</p></li>
<li><p><code>&lt;</code>: Menor que</p></li>
<li><p><code>&gt;</code>: Maior que</p></li>
<li><p><code>&lt;=</code>: Menor ou igual a</p></li>
<li><p><code>&gt;=</code>: Maior ou igual a</p></li>
</ul>
<p>Podemos estar interessados em filtrar as observações com pelo menos três carros envolvidos no acidente:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             data  horario n_da_ocorrencia         tipo_de_ocorrencia      km
    1: 01/01/2010 13:14:00             150                 sem vítima     560
    2: 01/01/2011 23:21:00             542                 sem vítima   137,5
    3: 01/01/2011 12:21:00             212                 sem vítima    68,8
    4: 01/01/2011 13:55:00             135                 sem vítima     269
    5: 01/01/2011 14:57:00             309                 sem vítima     193
   ---                                                                       
34384: 31/12/2021 07:00:03             115                 Sem vítima 626,434
34385: 31/12/2021 21:43:00             388                 Sem vítima 131,806
34386: 31/12/2021 17:36:28             247                 Sem vítima 269,670
34387: 31/12/2022 19:53:19             571 ac02 - Acidente com Vítima 445,000
34388: 31/12/2022 10:18:00             206        Acidente com vítima      44
          trecho     sentido              lugar_acidente
    1: BR-116/PR         Sul Autopista Regis Bittencourt
    2: BR-101/SC       Norte       Autopista Litoral Sul
    3: BR-116/SP   Pista Sul                   Novadutra
    4: BR-116/PR       Norte Autopista Regis Bittencourt
    5: BR-101/SC       Norte       Autopista Litoral Sul
   ---                                                  
34384: BR-376/SC Decrescente       Autopista Litoral Sul
34385: BR-101/SC Decrescente       Autopista Litoral Sul
34386: BR-116/SP   Crescente Autopista Regis Bittencourt
34387: BR-262/MG       Oeste                    Concebra
34388: BR-101/SP Pista Norte                       RIOSP
                    tipo_de_acidente automovel bicicleta caminhao moto onibus
    1:              Colisão Traseira         3        NA       NA   NA     NA
    2:              Colisão Traseira         3        NA       NA   NA     NA
    3: Choque em barreira New Jersey         3         0        0    0      0
    4:                 Engavetamento         4        NA       NA   NA     NA
    5:              Colisão Traseira         3        NA       NA   NA     NA
   ---                                                                       
34384:                 Engavetamento         3         0        0    0      0
34385:                 Engavetamento         3         0        0    0      0
34386:                 Engavetamento         3         0        0    0      0
34387:               Colisão Lateral         3         0        0    0      0
34388:                 Engavetamento         3         0        0    0      0
       outros tracao_animal transporte_de_cargas_especiais trator_maquinas
    1:     NA            NA                             NA              NA
    2:     NA            NA                             NA              NA
    3:      0             0                             NA               0
    4:     NA            NA                             NA              NA
    5:     NA            NA                             NA              NA
   ---                                                                    
34384:      0             0                              0               0
34385:      0             0                              0               0
34386:      0             0                              0               0
34387:      0             0                              0               0
34388:      0             0                             NA               0
       utilitarios ilesos levemente_feridos moderadamente_feridos
    1:          NA     14                NA                    NA
    2:          NA      3                NA                    NA
    3:           0     11                 0                     0
    4:          NA      7                NA                    NA
    5:          NA      3                NA                    NA
   ---                                                           
34384:           0      3                 0                     0
34385:           0      3                 0                     0
34386:           1      4                 0                     0
34387:           0      2                 0                     0
34388:           0     10                 1                     0
       gravemente_feridos mortos
    1:                 NA     NA
    2:                 NA     NA
    3:                  0      0
    4:                 NA     NA
    5:                 NA     NA
   ---                          
34384:                  0      0
34385:                  0      0
34386:                  0      0
34387:                  0      0
34388:                  0      0</code></pre>
</div>
</div>
</section>
<section id="filtros-combinados" class="level4" data-number="4.2.2.2">
<h4 data-number="4.2.2.2" class="anchored" data-anchor-id="filtros-combinados"><span class="header-section-number">4.2.2.2</span> 4.2.2.2 Filtros Combinados</h4>
<p>Você pode combinar filtros usando os operadores lógicos <code>&amp;</code> (AND) e <code>|</code> (OR) para criar condições mais complexas.</p>
<p>Podemos estar interessados em filtrar as observações com pelo menos três carros e dois caminhões envolvidos no acidente:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           data  horario n_da_ocorrencia tipo_de_ocorrencia                 km
  1: 01/02/2018 07:45:00             119         sem vítima             41,941
  2: 01/03/2012 09:04:00             163         com vítima 111,19999694824219
  3: 01/03/2019 00:07:00               2         sem vítima              667,5
  4: 01/04/2011 08:32:00             223         sem vítima              222,7
  5: 01/06/2014 16:47:00             238         com vítima            676,662
 ---                                                                          
173: 29/11/2017 16:38:00             592         com vítima  96,30000305175781
174: 30/10/2012 13:15:00             437         com vítima              133,2
175: 31/03/2013 19:30:00             468         com vítima              540,5
176: 31/03/2014 15:56:00             228         sem vítima                656
177: 31/10/2011 06:28:00             121         com vítima                208
        trecho     sentido        lugar_acidente tipo_de_acidente automovel
  1: BR-101/SC       Norte Autopista Litoral Sul    Engavetamento         3
  2: BR-116/PR         Sul Autopista Litoral Sul Colisão Traseira         3
  3: BR-376/PR         Sul Autopista Litoral Sul    Engavetamento         8
  4: BR-116/RJ Pista Norte             Novadutra    Engavetamento         3
  5: BR-376/PR         Sul Autopista Litoral Sul    Engavetamento         4
 ---                                                                       
173: BR-116/SP Pista Norte             Novadutra    Engavetamento         7
174: BR-116/SP Pista Norte             Novadutra    Engavetamento         3
175: BR-381/MG       Norte Autopista Fernão Dias    Engavetamento         5
176: BR-376/PR       Norte Autopista Litoral Sul    Engavetamento         3
177: BR-116/RJ Pista Norte             Novadutra    Engavetamento         3
     bicicleta caminhao moto onibus outros tracao_animal
  1:        NA        3   NA     NA     NA            NA
  2:        NA        3    1     NA     NA            NA
  3:        NA        4   NA     NA     NA            NA
  4:         0        3    0      0      0             0
  5:        NA        4   NA     NA     NA            NA
 ---                                                    
173:        NA        3   NA     NA     NA            NA
174:         0        3    0      0      0             0
175:        NA        3   NA     NA     NA            NA
176:        NA        4   NA     NA     NA            NA
177:         0        3    0      0      1             0
     transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
  1:                             NA              NA           1      7
  2:                             NA              NA          NA      6
  3:                             NA              NA          NA     29
  4:                             NA               0           0      8
  5:                             NA              NA          NA      3
 ---                                                                  
173:                             NA              NA          NA     19
174:                             NA               0           0      8
175:                             NA              NA          NA      7
176:                             NA              NA           2      9
177:                             NA               0           0      6
     levemente_feridos moderadamente_feridos gravemente_feridos mortos
  1:                NA                    NA                 NA     NA
  2:                 1                    NA                 NA     NA
  3:                NA                    NA                 NA     NA
  4:                 0                     0                  0      0
  5:                NA                     2                  3      5
 ---                                                                  
173:                 1                    NA                 NA     NA
174:                 1                     0                  0      0
175:                 1                    NA                 NA     NA
176:                NA                    NA                 NA     NA
177:                 1                     0                  0      0</code></pre>
</div>
</div>
<p>Podemos omitir o operador lógico <code>&amp;</code>, então a função ficaria:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           data  horario n_da_ocorrencia tipo_de_ocorrencia                 km
  1: 01/02/2018 07:45:00             119         sem vítima             41,941
  2: 01/03/2012 09:04:00             163         com vítima 111,19999694824219
  3: 01/03/2019 00:07:00               2         sem vítima              667,5
  4: 01/04/2011 08:32:00             223         sem vítima              222,7
  5: 01/06/2014 16:47:00             238         com vítima            676,662
 ---                                                                          
173: 29/11/2017 16:38:00             592         com vítima  96,30000305175781
174: 30/10/2012 13:15:00             437         com vítima              133,2
175: 31/03/2013 19:30:00             468         com vítima              540,5
176: 31/03/2014 15:56:00             228         sem vítima                656
177: 31/10/2011 06:28:00             121         com vítima                208
        trecho     sentido        lugar_acidente tipo_de_acidente automovel
  1: BR-101/SC       Norte Autopista Litoral Sul    Engavetamento         3
  2: BR-116/PR         Sul Autopista Litoral Sul Colisão Traseira         3
  3: BR-376/PR         Sul Autopista Litoral Sul    Engavetamento         8
  4: BR-116/RJ Pista Norte             Novadutra    Engavetamento         3
  5: BR-376/PR         Sul Autopista Litoral Sul    Engavetamento         4
 ---                                                                       
173: BR-116/SP Pista Norte             Novadutra    Engavetamento         7
174: BR-116/SP Pista Norte             Novadutra    Engavetamento         3
175: BR-381/MG       Norte Autopista Fernão Dias    Engavetamento         5
176: BR-376/PR       Norte Autopista Litoral Sul    Engavetamento         3
177: BR-116/RJ Pista Norte             Novadutra    Engavetamento         3
     bicicleta caminhao moto onibus outros tracao_animal
  1:        NA        3   NA     NA     NA            NA
  2:        NA        3    1     NA     NA            NA
  3:        NA        4   NA     NA     NA            NA
  4:         0        3    0      0      0             0
  5:        NA        4   NA     NA     NA            NA
 ---                                                    
173:        NA        3   NA     NA     NA            NA
174:         0        3    0      0      0             0
175:        NA        3   NA     NA     NA            NA
176:        NA        4   NA     NA     NA            NA
177:         0        3    0      0      1             0
     transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
  1:                             NA              NA           1      7
  2:                             NA              NA          NA      6
  3:                             NA              NA          NA     29
  4:                             NA               0           0      8
  5:                             NA              NA          NA      3
 ---                                                                  
173:                             NA              NA          NA     19
174:                             NA               0           0      8
175:                             NA              NA          NA      7
176:                             NA              NA           2      9
177:                             NA               0           0      6
     levemente_feridos moderadamente_feridos gravemente_feridos mortos
  1:                NA                    NA                 NA     NA
  2:                 1                    NA                 NA     NA
  3:                NA                    NA                 NA     NA
  4:                 0                     0                  0      0
  5:                NA                     2                  3      5
 ---                                                                  
173:                 1                    NA                 NA     NA
174:                 1                     0                  0      0
175:                 1                    NA                 NA     NA
176:                NA                    NA                 NA     NA
177:                 1                     0                  0      0</code></pre>
</div>
</div>
<p>Podemos estar interessados em filtrar as observações com pelo menos três carros OU dois caminhões envolvidos no acidente:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             data  horario n_da_ocorrencia         tipo_de_ocorrencia      km
    1: 01/01/2010 13:14:00             150                 sem vítima     560
    2: 01/01/2011 23:21:00             542                 sem vítima   137,5
    3: 01/01/2011 12:21:00             212                 sem vítima    68,8
    4: 01/01/2011 13:55:00             135                 sem vítima     269
    5: 01/01/2011 14:57:00             309                 sem vítima     193
   ---                                                                       
39204: 31/12/2021 21:43:00             388                 Sem vítima 131,806
39205: 31/12/2021 17:36:28             247                 Sem vítima 269,670
39206: 31/12/2022 19:53:19             571 ac02 - Acidente com Vítima 445,000
39207: 31/12/2022 16:29:00             343                 Sem vítima 643,000
39208: 31/12/2022 10:18:00             206        Acidente com vítima      44
          trecho     sentido              lugar_acidente
    1: BR-116/PR         Sul Autopista Regis Bittencourt
    2: BR-101/SC       Norte       Autopista Litoral Sul
    3: BR-116/SP   Pista Sul                   Novadutra
    4: BR-116/PR       Norte Autopista Regis Bittencourt
    5: BR-101/SC       Norte       Autopista Litoral Sul
   ---                                                  
39204: BR-101/SC Decrescente       Autopista Litoral Sul
39205: BR-116/SP   Crescente Autopista Regis Bittencourt
39206: BR-262/MG       Oeste                    Concebra
39207: BR-116/BA Decrescente                   Via Bahia
39208: BR-101/SP Pista Norte                       RIOSP
                       tipo_de_acidente automovel bicicleta caminhao moto
    1:                 Colisão Traseira         3        NA       NA   NA
    2:                 Colisão Traseira         3        NA       NA   NA
    3:    Choque em barreira New Jersey         3         0        0    0
    4:                    Engavetamento         4        NA       NA   NA
    5:                 Colisão Traseira         3        NA       NA   NA
   ---                                                                   
39204:                    Engavetamento         3         0        0    0
39205:                    Engavetamento         3         0        0    0
39206:                  Colisão Lateral         3         0        0    0
39207: Colisão lateral no mesmo sentido         0         0        3    0
39208:                    Engavetamento         3         0        0    0
       onibus outros tracao_animal transporte_de_cargas_especiais
    1:     NA     NA            NA                             NA
    2:     NA     NA            NA                             NA
    3:      0      0             0                             NA
    4:     NA     NA            NA                             NA
    5:     NA     NA            NA                             NA
   ---                                                           
39204:      0      0             0                              0
39205:      0      0             0                              0
39206:      0      0             0                              0
39207:      0      0             0                              0
39208:      0      0             0                             NA
       trator_maquinas utilitarios ilesos levemente_feridos
    1:              NA          NA     14                NA
    2:              NA          NA      3                NA
    3:               0           0     11                 0
    4:              NA          NA      7                NA
    5:              NA          NA      3                NA
   ---                                                     
39204:               0           0      3                 0
39205:               0           1      4                 0
39206:               0           0      2                 0
39207:               0           0      0                 0
39208:               0           0     10                 1
       moderadamente_feridos gravemente_feridos mortos
    1:                    NA                 NA     NA
    2:                    NA                 NA     NA
    3:                     0                  0      0
    4:                    NA                 NA     NA
    5:                    NA                 NA     NA
   ---                                                
39204:                     0                  0      0
39205:                     0                  0      0
39206:                     0                  0      0
39207:                     0                  0      0
39208:                     0                  0      0</code></pre>
</div>
</div>
</section>
<section id="filtrando-valores-dentro-de-um-intervalo" class="level4" data-number="4.2.2.3">
<h4 data-number="4.2.2.3" class="anchored" data-anchor-id="filtrando-valores-dentro-de-um-intervalo"><span class="header-section-number">4.2.2.3</span> 4.2.2.3 Filtrando valores dentro de um intervalo</h4>
<p>Para filtramos valores dentro de um intervalo definido podemos utilizar as funções <code>between()</code> e <code>%in%</code>.</p>
<p>A função <code>between()</code> é útil para filtrar valores dentro de um intervalo numérico.</p>
<p>Podemos estar interessados em filtrar as observações com valores entre 4 e 8 motos envolvidas no acidente:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          data  horario n_da_ocorrencia                    tipo_de_ocorrencia
 1: 02/02/2012 09:07:00              35                            sem vítima
 2: 02/08/2022 14:34:00             333          Acidente com Danos Materiais
 3: 04/02/2021 06:24:00             111                  Acidente sem Vítimas
 4: 05/08/2021 07:12:00             118                  Acidente com Vítimas
 5: 07/08/2021 04:53:00              35                  Acidente com Vítimas
 6: 09/07/2021 06:08:00              70                  Acidente com Vítimas
 7: 11/04/2019 23:50:00             526                            com vítima
 8: 11/07/2017 16:31:00             307                            com vítima
 9: 13/11/2016 17:15:00             146                            sem vítima
10: 14/01/2021 06:55:00             143                  Acidente com Vítimas
11: 16/11/2010 21:22:00             404                            com vítima
12: 17/03/2016 06:52:00              64                   Acidente com vítima
13: 18/03/2016 17:02:00             259                   Acidente sem Vítima
14: 18/07/2021 09:06:00              88                  Acidente sem Vítimas
15: 19/03/2016 05:23:00              70 Acidente sem Vítima - TRECHO CONTORNO
16: 19/10/2020 18:40:00             240                        Acidente Fatal
17: 20/03/2016 18:20:00             249                   Acidente com vítima
18: 20/03/2021 22:17:00             245                  Acidente com Vítimas
19: 20/03/2021 13:57:00             140                        Acidente Fatal
20: 20/05/2016 07:50:00             110                            com vítima
21: 20/10/2021 06:30:00             114                  Acidente com Vítimas
22: 21/03/2016 08:54:00             103                   Acidente com vítima
23: 22/01/2023 19:40:00            3192      AC01 - Acidente com VITIMA FATAL
24: 22/03/2016 23:01:00             347                   Acidente sem Vítima
25: 22/11/2015 10:04:00              61                            com vítima
26: 23/01/2023 14:50:00              69                            Com vítima
27: 25/03/2013 07:31:00             158                            com vítima
28: 25/09/2021 06:50:00              66                  Acidente com Vítimas
29: 26/08/2011 22:27:00             817                            com vítima
30: 27/10/2021 12:33:00             208                  Acidente com Vítimas
31: 28/03/2020 12:30:00             249                            com vítima
32: 29/03/2021 23:48:00             289                  Acidente com Vítimas
          data  horario n_da_ocorrencia                    tipo_de_ocorrencia
                  km    trecho     sentido              lugar_acidente
 1:             59,7 BR-153/SP       Norte             Transbrasiliana
 2:          506,000 BR-153/GO         Sul                    Concebra
 3:            510,3 BR-040/MG         Sul                      VIA040
 4:            96,99 BR-040/GO         Sul                      VIA040
 5:           552,15 BR-040/MG         Sul                      VIA040
 6:            514,4 BR-040/MG         Sul                      VIA040
 7:          212,269 BR-101/SC         Sul       Autopista Litoral Sul
 8:            269,5 BR-116/PR         Sul Autopista Regis Bittencourt
 9:              0,2 BR-050/MG       Norte                      ECO050
10:           542,25 BR-040/MG         Sul                      VIA040
11: 90,0999984741211 BR-381/SP       Norte       Autopista Fernão Dias
12:              401 BR-101/ES         Sul                      ECO101
13:              205 BR-101/ES       Norte                      ECO101
14:              4,1 BR-040/GO       Norte                      VIA040
15:              285 BR-101/ES         Sul                      ECO101
16:           610,55 BR-040/MG         Sul                      VIA040
17:              139 BR-101/ES         Sul                      ECO101
18:             23,1 BR-040/GO       Norte                      VIA040
19:             34,6 BR-040/MG         Sul                      VIA040
20:          207,488 BR-101/SC       Norte       Autopista Litoral Sul
21:            517,5 BR-040/MG         Sul                      VIA040
22:              363 BR-101/ES         Sul                      ECO101
23:              822 BR-040/MG          JF                      Concer
24:               10 BR-101/ES       Norte                      ECO101
25:            277,7 BR-101/RJ         Sul        Autopista Fluminense
26:           80,200 BR-392/RS   Crescente                      Ecosul
27:            180,2 BR-116/RJ Pista Norte                   Novadutra
28:              5,5 BR-040/DF       Norte                      VIA040
29:            153,4 BR-116/SP Pista Norte                   Novadutra
30:           531,12 BR-040/MG         Sul                      VIA040
31:           24,926 BR-101/SC         Sul       Autopista Litoral Sul
32:              8,9 BR-040/MG         Sul                      VIA040
                  km    trecho     sentido              lugar_acidente
                              tipo_de_acidente automovel bicicleta caminhao
 1: Choque contra objeto na faixa de rolamento        NA        NA        1
 2:                           Colisão Traseira         0         0        0
 3:                              Engavetamento         0         0        0
 4:                           Colisão traseira         0         0        0
 5:                           Colisão traseira         0         0        0
 6:                              Engavetamento         4         0        0
 7:                              Engavetamento         1        NA       NA
 8:                        Colisão Transversal         1         0        0
 9:     Choque - Veiculo parado no acostamento         1        NA       NA
10:                           Colisão traseira         0         0        0
11:                         Outros - Sequência        NA        NA       NA
12:                            Colisão Lateral         1        NA        0
13:                           Colisão Traseira         2        NA        0
14:                            Colisão lateral         0         0        0
15:                             Saída de Pista         2        NA        0
16:                        Colisão transversal         0         0        1
17:                           Colisão Traseira         1        NA        0
18:                              Engavetamento         1         0        0
19:                            Colisão frontal         0         0        1
20:                              Engavetamento        NA        NA       NA
21:                            Colisão lateral         2         0        0
22:                            Colisão Lateral         0        NA        1
23:                     Atropelamento - Animal        NA        NA       NA
24:                          Veículo em Chamas         0        NA        0
25:                              Engavetamento         1        NA       NA
26:                             Saída de pista         0         0        0
27:                  Abalroamento longitudinal         1         0        0
28:                         Tombamento de Moto         0         0        0
29:                              Queda de moto         0         0        0
30:                            Colisão lateral         0         0        0
31:                              Engavetamento         1        NA       NA
32:                           Colisão traseira         2         0        0
                              tipo_de_acidente automovel bicicleta caminhao
    moto onibus outros tracao_animal transporte_de_cargas_especiais
 1:    4     NA     NA            NA                             NA
 2:    4      0      0             0                              0
 3:    5      0      1             0                              0
 4:    4      0      0             0                              0
 5:    4      0      1             0                              0
 6:    4      0      0             0                              0
 7:    4     NA     NA            NA                             NA
 8:    4      0      0             0                              0
 9:    4     NA     NA            NA                             NA
10:    4      0      0             0                              0
11:    4     NA     NA            NA                             NA
12:    5      0      0             0                             NA
13:    4      0      0             0                             NA
14:    5      0      0             0                              0
15:    4      0      0             0                             NA
16:    6      0      0             0                              0
17:    4      0      0             0                             NA
18:    4      0      0             0                              0
19:    4      2      0             0                              0
20:    4     NA      1            NA                             NA
21:    4      0      0             0                              0
22:    4      0      0             0                             NA
23:    4     NA     NA            NA                             NA
24:    4      0      0             0                             NA
25:    5     NA     NA            NA                             NA
26:    5      0      0             0                              0
27:    4      0      0             0                             NA
28:    4      0      1             0                              0
29:    4      0      0             0                             NA
30:    4      0      0             0                              0
31:    4     NA     NA            NA                             NA
32:    4      0      0             0                              0
    moto onibus outros tracao_animal transporte_de_cargas_especiais
    trator_maquinas utilitarios ilesos levemente_feridos moderadamente_feridos
 1:              NA          NA      5                NA                    NA
 2:               0           0      4                 0                     0
 3:               0           0      3                 0                     0
 4:               0           0      1                 0                     1
 5:               0           0      0                 0                     0
 6:               0           0      0                 1                     0
 7:              NA          NA      1                 2                    NA
 8:               0           0      1                 4                     0
 9:              NA          NA      6                NA                    NA
10:               0           0      2                 1                     0
11:              NA          NA      4                 1                    NA
12:              NA          NA      2                 0                     0
13:              NA          NA      5                 0                     0
14:               0           0      2                 0                     0
15:              NA          NA      4                 0                     0
16:               0           0      1                 0                     0
17:              NA          NA      2                 2                     0
18:               0           0      2                 0                     0
19:               0           0      1                 0                     0
20:              NA          NA      3                 2                    NA
21:               0           0      0                 1                     0
22:              NA          NA      2                 1                     0
23:              NA          NA      1                 2                    NA
24:              NA          NA      1                 0                     0
25:              NA          NA      4                 1                     2
26:               0           0      3                 1                     0
27:               0           0      2                 4                     0
28:               0           0      3                 0                     1
29:               0           0      2                 2                     0
30:               0           0      0                 1                     0
31:              NA          NA      3                 2                    NA
32:               0           0      1                 1                     0
    trator_maquinas utilitarios ilesos levemente_feridos moderadamente_feridos
    gravemente_feridos mortos
 1:                 NA     NA
 2:                  0      0
 3:                  0      0
 4:                  0      0
 5:                  0      0
 6:                  0      0
 7:                  1      1
 8:                  0      0
 9:                 NA     NA
10:                  0      0
11:                 NA     NA
12:                  1      0
13:                  0      0
14:                  0      0
15:                  0      0
16:                  0      1
17:                  0      0
18:                  0      0
19:                  0      1
20:                 NA     NA
21:                  0      0
22:                  0      0
23:                  1      1
24:                  0      0
25:                 NA     NA
26:                  1      0
27:                  0      0
28:                  0      0
29:                  0      0
30:                  0      0
31:                 NA     NA
32:                  0      0
    gravemente_feridos mortos</code></pre>
</div>
</div>
<p>A função <code>%in%</code> é usada para filtrar valores que correspondem a um conjunto de valores.</p>
<p>Podemos estar interessados em filtrar as observações com ocorrência em alguma das seguintes operadoras: “Autopista Regis Bittencourt”, “Autopista Litoral Sul”, “Via Sul”.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              data  horario n_da_ocorrencia tipo_de_ocorrencia      km
     1: 01/01/2010 02:13:00              20         sem vítima   269,5
     2: 01/01/2010 11:20:00             125         sem vítima      52
     3: 01/01/2010 18:07:00             214         sem vítima      40
     4: 01/01/2010 15:52:00             354         sem vítima     132
     5: 01/01/2010 16:30:00             377         com vítima      35
    ---                                                               
203032: 31/12/2022 20:44:02             343         Com vítima 105,500
203033: 31/12/2022 22:20:07             372         Sem vítima 158,100
203034: 31/12/2022 22:16:59             369         Com vítima 131,163
203035: 31/12/2022 23:23:36             386         Sem vítima 146,425
203036: 31/12/2022 12:12:09             188         Com vítima 223,520
           trecho     sentido              lugar_acidente tipo_de_acidente
     1: BR-116/PR         Sul Autopista Regis Bittencourt Colisão Traseira
     2: BR-116/PR       Norte Autopista Regis Bittencourt   Saida de Pista
     3: BR-116/PR         Sul Autopista Regis Bittencourt   Saida de Pista
     4: BR-101/SC         Sul       Autopista Litoral Sul   Saida de Pista
     5: BR-101/SC         Sul       Autopista Litoral Sul    Queda de Moto
    ---                                                                   
203032: BR-116/SC   Crescente       Autopista Litoral Sul Colisão traseira
203033: BR-101/SC   Crescente       Autopista Litoral Sul Colisão traseira
203034: BR-101/SC   Crescente       Autopista Litoral Sul    Queda de moto
203035: BR-101/SC   Crescente       Autopista Litoral Sul           Choque
203036: BR-101/SC Decrescente       Autopista Litoral Sul    Queda de moto
        automovel bicicleta caminhao moto onibus outros tracao_animal
     1:         2        NA       NA   NA     NA     NA            NA
     2:         1        NA       NA   NA     NA     NA            NA
     3:         1        NA       NA   NA     NA     NA            NA
     4:         1        NA       NA   NA     NA     NA            NA
     5:        NA        NA       NA    1     NA     NA            NA
    ---                                                              
203032:         1         0        0    1      0      0             0
203033:         2         0        0    0      0      0             0
203034:         0         0        0    1      0      0             0
203035:         1         0        0    0      0      0             0
203036:         0         0        0    1      0      0             0
        transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
     1:                             NA              NA          NA      3
     2:                             NA              NA          NA      3
     3:                             NA              NA          NA      4
     4:                             NA              NA          NA      1
     5:                             NA              NA          NA      0
    ---                                                                  
203032:                              0               0           0      1
203033:                              0               0           0      2
203034:                              0               0           0      0
203035:                              0               0           0      0
203036:                              0               0           0      0
        levemente_feridos moderadamente_feridos gravemente_feridos mortos
     1:                NA                    NA                 NA     NA
     2:                NA                    NA                 NA     NA
     3:                NA                    NA                 NA     NA
     4:                NA                    NA                 NA     NA
     5:                 2                    NA                 NA     NA
    ---                                                                  
203032:                 1                     0                  0      0
203033:                 0                     0                  0      0
203034:                 1                     0                  0      0
203035:                 0                     0                  0      0
203036:                 2                     0                  0      0</code></pre>
</div>
</div>
<p>Podemos estar interessados nas autopistas que não são operadas pelas mesmas operadoras. Para isso precisamos definir um operador de <em>not in</em>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              data  horario n_da_ocorrencia           tipo_de_ocorrencia
     1: 01/01/2010 04:21:00              18                   sem vítima
     2: 01/01/2010 03:35:00     000024/2010                   sem vítima
     3: 01/01/2010 07:31:00     000038/2010                   sem vítima
     4: 01/01/2010 04:57:00     000027/2010                   sem vítima
     5: 01/01/2010 08:02:00     000042/2010                   sem vítima
    ---                                                                 
661521: 31/12/2022 02:10:00              17 Acidente com Danos Materiais
661522: 31/12/2022 00:08:00               4 Acidente com Danos Materiais
661523: 31/12/2022 03:28:00              21                   Com vítima
661524: 31/12/2022 05:05:55              14                   Sem vítima
661525: 31/12/2022 13:49:33             339 Acidente com Danos Materiais
             km    trecho     sentido         lugar_acidente tipo_de_acidente
     1:     167 BR-393/RJ       Norte         Rodovia do Aço       Derrapagem
     2:      77 BR-290/RS       Norte                Concepa  COLISÃO LATERAL
     3:      52 BR-116/RS       Norte                Concepa    QUEDA DE MOTO
     4:      33 BR-290/RS       Norte                Concepa    QUEDA DE MOTO
     5:      24 BR-290/RS         Sul                Concepa   SAÍDA DE PISTA
    ---                                                                      
661521: 636,000 BR-262/MG       Leste               Concebra   Saida de Pista
661522: 865,000 BR-262/MG       Oeste               Concebra   Saida de Pista
661523: 180,000  BR-50/MG Decrescente                 ECO050      Capotamento
661524: 115,100 BR-116/PR Decrescente Autopista Planalto Sul Colisão traseira
661525: 379,000 BR-262/MG       Leste               Concebra   Saida de Pista
        automovel bicicleta caminhao moto onibus outros tracao_animal
     1:         1        NA       NA   NA     NA     NA            NA
     2:         2         0        0    0      0      0             0
     3:         0         0        0    1      0      0             0
     4:         0         0        0    1      0      0             0
     5:         1         0        0    0      0      0             0
    ---                                                              
661521:         1         0        0    0      0      0             0
661522:         1         0        0    0      0      0             0
661523:         1         0        0    0      0      0             0
661524:         2         0        0    0      0      0             0
661525:         0         0        1    0      0      0             0
        transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
     1:                             NA              NA          NA      1
     2:                              0               0           0      2
     3:                              0               0           0      1
     4:                              0               0           0      1
     5:                              0               0           0      1
    ---                                                                  
661521:                              0               0           0      3
661522:                              0               0           0      1
661523:                              0               0           0      3
661524:                              0               0           0      2
661525:                              0               0           0      1
        levemente_feridos moderadamente_feridos gravemente_feridos mortos
     1:                 0                     0                  0      0
     2:                 0                     0                  0      0
     3:                 0                     0                  0      0
     4:                 0                     0                  0      0
     5:                 0                     0                  0      0
    ---                                                                  
661521:                 0                     0                  0      0
661522:                 0                     0                  0      0
661523:                 1                     0                  0      0
661524:                 0                     0                  0      0
661525:                 0                     0                  0      0</code></pre>
</div>
</div>
<p>Alternativamente,</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              data  horario n_da_ocorrencia           tipo_de_ocorrencia
     1: 01/01/2010 04:21:00              18                   sem vítima
     2: 01/01/2010 03:35:00     000024/2010                   sem vítima
     3: 01/01/2010 07:31:00     000038/2010                   sem vítima
     4: 01/01/2010 04:57:00     000027/2010                   sem vítima
     5: 01/01/2010 08:02:00     000042/2010                   sem vítima
    ---                                                                 
661521: 31/12/2022 02:10:00              17 Acidente com Danos Materiais
661522: 31/12/2022 00:08:00               4 Acidente com Danos Materiais
661523: 31/12/2022 03:28:00              21                   Com vítima
661524: 31/12/2022 05:05:55              14                   Sem vítima
661525: 31/12/2022 13:49:33             339 Acidente com Danos Materiais
             km    trecho     sentido         lugar_acidente tipo_de_acidente
     1:     167 BR-393/RJ       Norte         Rodovia do Aço       Derrapagem
     2:      77 BR-290/RS       Norte                Concepa  COLISÃO LATERAL
     3:      52 BR-116/RS       Norte                Concepa    QUEDA DE MOTO
     4:      33 BR-290/RS       Norte                Concepa    QUEDA DE MOTO
     5:      24 BR-290/RS         Sul                Concepa   SAÍDA DE PISTA
    ---                                                                      
661521: 636,000 BR-262/MG       Leste               Concebra   Saida de Pista
661522: 865,000 BR-262/MG       Oeste               Concebra   Saida de Pista
661523: 180,000  BR-50/MG Decrescente                 ECO050      Capotamento
661524: 115,100 BR-116/PR Decrescente Autopista Planalto Sul Colisão traseira
661525: 379,000 BR-262/MG       Leste               Concebra   Saida de Pista
        automovel bicicleta caminhao moto onibus outros tracao_animal
     1:         1        NA       NA   NA     NA     NA            NA
     2:         2         0        0    0      0      0             0
     3:         0         0        0    1      0      0             0
     4:         0         0        0    1      0      0             0
     5:         1         0        0    0      0      0             0
    ---                                                              
661521:         1         0        0    0      0      0             0
661522:         1         0        0    0      0      0             0
661523:         1         0        0    0      0      0             0
661524:         2         0        0    0      0      0             0
661525:         0         0        1    0      0      0             0
        transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
     1:                             NA              NA          NA      1
     2:                              0               0           0      2
     3:                              0               0           0      1
     4:                              0               0           0      1
     5:                              0               0           0      1
    ---                                                                  
661521:                              0               0           0      3
661522:                              0               0           0      1
661523:                              0               0           0      3
661524:                              0               0           0      2
661525:                              0               0           0      1
        levemente_feridos moderadamente_feridos gravemente_feridos mortos
     1:                 0                     0                  0      0
     2:                 0                     0                  0      0
     3:                 0                     0                  0      0
     4:                 0                     0                  0      0
     5:                 0                     0                  0      0
    ---                                                                  
661521:                 0                     0                  0      0
661522:                 0                     0                  0      0
661523:                 1                     0                  0      0
661524:                 0                     0                  0      0
661525:                 0                     0                  0      0</code></pre>
</div>
</div>
<p>Outras vezes, podemos utilizar o operador <code>%like%</code> que busca padrões. Por exemplo, podemos estar interessados em buscar todos acidentes que ocorreram com vítimas, e no campo <code>tipo_de_ocorrencia</code> podemos simplesmente buscar por:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              data  horario n_da_ocorrencia               tipo_de_ocorrencia
     1: 01/01/2010 15:53:00              48                       com vítima
     2: 01/01/2010 16:30:00             377                       com vítima
     3: 01/01/2010 01:06:00               2                       com vítima
     4: 01/01/2010 11:25:00             102                       com vítima
     5: 01/01/2010 12:41:00             142                       com vítima
    ---                                                                     
219209: 31/12/2022 10:28:00             211              Acidente com vítima
219210: 31/12/2022 07:53:44              26 ac03 - Acidente com vítima ilesa
219211: 31/12/2022 10:18:00             206              Acidente com vítima
219212: 31/12/2022 01:53:24              10 ac03 - Acidente com vítima ilesa
219213: 31/12/2022 07:53:44              26 ac03 - Acidente com vítima ilesa
             km    trecho     sentido              lugar_acidente
     1:   119,5 BR-116/PR         Sul      Autopista Planalto Sul
     2:      35 BR-101/SC         Sul       Autopista Litoral Sul
     3:     114 BR-040/RJ         Sul                      Concer
     4:      64 BR-381/SP         Sul       Autopista Fernão Dias
     5:     273 BR-116/PR       Norte Autopista Regis Bittencourt
    ---                                                          
219209:     144 BR-116/SP   Pista Sul                       RIOSP
219210: 118,572 BR-116/RJ         Sul                 Ecoriominas
219211:      44 BR-101/SP Pista Norte                       RIOSP
219212:    39,9 BR-116/RJ         Sul                 Ecoriominas
219213: 118,572 BR-116/RJ         Sul                 Ecoriominas
            tipo_de_acidente automovel bicicleta caminhao moto onibus outros
     1:  Colisão Transversal         2        NA       NA   NA     NA     NA
     2:        Queda de Moto        NA        NA       NA    1     NA     NA
     3: Choque - Objeto Fixo         1        NA       NA   NA     NA     NA
     4:          Capotamento         1        NA       NA   NA     NA     NA
     5:      Colisão Lateral        NA        NA       NA    1      1     NA
    ---                                                                     
219209:        Queda de moto         0         0        0    1      0      0
219210:       Saida de Pista         1        NA       NA   NA     NA     NA
219211:        Engavetamento         3         0        0    0      0      0
219212:          Capotamento         1        NA       NA   NA     NA     NA
219213:       Saida de Pista         1        NA       NA   NA     NA     NA
        tracao_animal transporte_de_cargas_especiais trator_maquinas
     1:            NA                             NA              NA
     2:            NA                             NA              NA
     3:            NA                             NA              NA
     4:            NA                             NA              NA
     5:            NA                             NA              NA
    ---                                                             
219209:             0                             NA               0
219210:            NA                             NA              NA
219211:             0                             NA               0
219212:            NA                             NA              NA
219213:            NA                             NA              NA
        utilitarios ilesos levemente_feridos moderadamente_feridos
     1:          NA      4                 5                    NA
     2:          NA      0                 2                    NA
     3:          NA      0                 2                    NA
     4:          NA      0                 1                    NA
     5:          NA      2                NA                     1
    ---                                                           
219209:           0      0                 1                     0
219210:          NA      1                NA                    NA
219211:           0     10                 1                     0
219212:          NA      1                NA                    NA
219213:          NA      1                NA                    NA
        gravemente_feridos mortos
     1:                 NA     NA
     2:                 NA     NA
     3:                 NA     NA
     4:                 NA     NA
     5:                 NA     NA
    ---                          
219209:                  0      0
219210:                 NA     NA
219211:                  0      0
219212:                 NA     NA
219213:                 NA     NA</code></pre>
</div>
</div>
<p>Algumas vezes temos apenas vários padrões de texto que gostaríamos de buscar. Para isso, a função <code>grepl()</code> permite filtrar com base em padrões de texto.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            data  horario n_da_ocorrencia               tipo_de_ocorrencia
   1: 01/01/2021 04:46:54              23 ac03 - Acidente com vítima ilesa
   2: 01/01/2021 14:00:09              83 ac03 - Acidente com vítima ilesa
   3: 01/01/2023 12:34:00              58 ac03 - Acidente com vítima ilesa
   4: 01/01/2023 16:39:20              90 ac03 - Acidente com vítima ilesa
   5: 01/01/2023 17:19:19              95 ac03 - Acidente com vítima ilesa
  ---                                                                     
2001: 31/12/2022 01:53:24              10 ac03 - Acidente com vítima ilesa
2002: 31/12/2022 04:50:18              17 ac03 - Acidente com vítima ilesa
2003: 31/12/2022 07:53:44              26 ac03 - Acidente com vítima ilesa
2004: 31/12/2022 01:53:24              10 ac03 - Acidente com vítima ilesa
2005: 31/12/2022 07:53:44              26 ac03 - Acidente com vítima ilesa
           km    trecho sentido lugar_acidente                 tipo_de_acidente
   1:   163,2 BR-050/GO   Norte         ECO050          Atropelamento de Animal
   2:    37,8 BR-050/MG     Sul         ECO050        Choque - Defensa metálica
   3:  17,781 BR-116/RJ     Sul    Ecoriominas                  Choque - Arvore
   4:      42 BR-116/RJ     Sul    Ecoriominas Colisão lateral no mesmo sentido
   5:     109 BR-116/RJ   Norte    Ecoriominas Colisão lateral no mesmo sentido
  ---                                                                          
2001:    39,9 BR-116/RJ     Sul    Ecoriominas                      Capotamento
2002:    54,3 BR-493/RJ   Norte    Ecoriominas                   Choque - Poste
2003: 118,572 BR-116/RJ     Sul    Ecoriominas                   Saida de Pista
2004:    39,9 BR-116/RJ     Sul    Ecoriominas                      Capotamento
2005: 118,572 BR-116/RJ     Sul    Ecoriominas                   Saida de Pista
      automovel bicicleta caminhao moto onibus outros tracao_animal
   1:         1        NA       NA   NA     NA     NA            NA
   2:         1        NA       NA   NA     NA     NA            NA
   3:        NA        NA        1   NA     NA     NA            NA
   4:         2        NA       NA   NA     NA     NA            NA
   5:         1        NA       NA   NA     NA      1            NA
  ---                                                              
2001:         1        NA       NA   NA     NA     NA            NA
2002:        NA        NA        1   NA     NA     NA            NA
2003:         1        NA       NA   NA     NA     NA            NA
2004:         1        NA       NA   NA     NA     NA            NA
2005:         1        NA       NA   NA     NA     NA            NA
      transporte_de_cargas_especiais trator_maquinas utilitarios ilesos
   1:                             NA              NA          NA      1
   2:                             NA              NA          NA      2
   3:                             NA              NA          NA      1
   4:                             NA              NA          NA      4
   5:                             NA              NA          NA      2
  ---                                                                  
2001:                             NA              NA          NA      1
2002:                             NA              NA          NA      1
2003:                             NA              NA          NA      1
2004:                             NA              NA          NA      1
2005:                             NA              NA          NA      1
      levemente_feridos moderadamente_feridos gravemente_feridos mortos
   1:                NA                    NA                 NA     NA
   2:                NA                    NA                 NA     NA
   3:                NA                    NA                 NA     NA
   4:                NA                    NA                 NA     NA
   5:                NA                    NA                 NA     NA
  ---                                                                  
2001:                NA                    NA                 NA     NA
2002:                NA                    NA                 NA     NA
2003:                NA                    NA                 NA     NA
2004:                NA                    NA                 NA     NA
2005:                NA                    NA                 NA     NA</code></pre>
</div>
</div>
</section>
</section>
<section id="resumo-de-informações" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="resumo-de-informações"><span class="header-section-number">4.2.3</span> 4.2.3 Resumo de informações</h3>
<p>No tidyverse, as funções <code>summarise()</code> e <code>group_by()</code> são amplamente utilizadas para resumir informações e realizar cálculos agregados em conjuntos de dados. Elas desempenham um papel crucial na análise exploratória e na obtenção de insights significativos a partir dos dados. Vamos explorar como essas funções funcionam e como usá-las para resumir informações de maneira eficaz.</p>
<section id="função-summarise" class="level4" data-number="4.2.3.1">
<h4 data-number="4.2.3.1" class="anchored" data-anchor-id="função-summarise"><span class="header-section-number">4.2.3.1</span> 4.2.3.1 Função <code>summarise()</code></h4>
<p>A função <code>summarise()</code> é utilizada para calcular estatísticas resumidas para uma coluna ou um conjunto de colunas. Ela permite calcular médias, somas, desvios padrão, mínimos, máximos e outras estatísticas relevantes.</p>
<p>Estamos interessados em uma tabela descritiva para a variável <code>levemente_feridos</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       n f_r f_per     media Q1 Q2 Q3      var       sd min max
1 864561   1   100 0.6814294  0  0  1 1.009796 1.004886   0  51</code></pre>
</div>
</div>
</section>
<section id="agrupamento-de-dados" class="level4" data-number="4.2.3.2">
<h4 data-number="4.2.3.2" class="anchored" data-anchor-id="agrupamento-de-dados"><span class="header-section-number">4.2.3.2</span> 4.2.3.2 Agrupamento de dados</h4>
<p>A função <code>group_by()</code> é usada para agrupar o conjunto de dados por uma ou mais colunas. Isso cria um contexto em que a função <code>summarise()</code> pode calcular estatísticas específicas para cada grupo.</p>
<p>Estamos interessados em uma tabela descritiva para a variável <code>levemente_feridos</code> por <code>tipo_de_ocorrencia</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       n f_r f_per     media Q1 Q2 Q3      var       sd min max
1 864561   1   100 0.6814294  0  0  1 1.009796 1.004886   0  51</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="exercício" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="exercício"><span class="header-section-number">4.3</span> 4.3 Exercício</h2>
<ol type="1">
<li>Utilizando o banco de dados <code>starwars</code> faça o que se pede:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<ol type="a">
<li>Qual é o número total de espécies únicas presentes? Qual a frequência de indivíduos por espécie?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 2
   species   frequency
   &lt;chr&gt;         &lt;int&gt;
 1 Aleena            1
 2 Besalisk          1
 3 Cerean            1
 4 Chagrian          1
 5 Clawdite          1
 6 Droid             6
 7 Dug               1
 8 Ewok              1
 9 Geonosian         1
10 Gungan            3
# ℹ 28 more rows</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Calcule a altura média de personagens masculinos e femininos.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  gender    altura_media
  &lt;chr&gt;            &lt;dbl&gt;
1 feminine          166.
2 masculine         181.</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Qual é a média de idade dos personagens de cada espécie para personagens masculinos?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 2
   species   media_idade
   &lt;chr&gt;           &lt;dbl&gt;
 1 Aleena          NaN  
 2 Besalisk        NaN  
 3 Cerean           92  
 4 Chagrian        NaN  
 5 Droid            53.3
 6 Dug             NaN  
 7 Ewok              8  
 8 Geonosian       NaN  
 9 Gungan           52  
10 Human            55.2
# ℹ 23 more rows</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Para cada espécie presente na base de dados, identifique o personagem mais velho e sua idade correspondente.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   species        personagem            idade
   &lt;chr&gt;          &lt;chr&gt;                 &lt;dbl&gt;
 1 Cerean         Ki-Adi-Mundi             92
 2 Droid          C-3PO                   112
 3 Ewok           Wicket Systri Warrick     8
 4 Gungan         Jar Jar Binks            52
 5 Human          Dooku                   102
 6 Hutt           Jabba Desilijic Tiure   600
 7 Kel Dor        Plo Koon                 22
 8 Mirialan       Luminara Unduli          58
 9 Mon Calamari   Ackbar                   41
10 Rodian         Greedo                   44
11 Trandoshan     Bossk                    53
12 Twi'lek        Ayla Secura              48
13 Wookiee        Chewbacca               200
14 Yoda's species Yoda                    896
15 Zabrak         Darth Maul               54
16 &lt;NA&gt;           Quarsh Panaka            62</code></pre>
</div>
</div>
</section>
<section id="manipulação-de-data-no-r" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="manipulação-de-data-no-r"><span class="header-section-number">4.4</span> 4.4 Manipulação de Data no R</h2>
<p>A transformação de strings em datas e a manipulação de datas são tarefas comuns em análise de dados. No R, existem várias funções e pacotes disponíveis para facilitar essas operações. Vamos explorar como realizar essas tarefas usando as funcionalidades básicas do R.</p>
<section id="transformando-strings-em-datas" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="transformando-strings-em-datas"><span class="header-section-number">4.4.1</span> 4.4.1 Transformando Strings em Datas</h3>
<p>Para transformar strings em datas, podemos utilizar a função <code>as.Date()</code>. Por exemplo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21"</code></pre>
</div>
</div>
<p>Também podemos especificar o formato da string de data usando o argumento <code>format</code>. Por exemplo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21"</code></pre>
</div>
</div>
</section>
<section id="manipulação-de-datas" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="manipulação-de-datas"><span class="header-section-number">4.4.2</span> 4.4.2 Manipulação de Datas</h3>
<p>Após transformar strings em datas, podemos realizar várias operações de manipulação de datas. Algumas das operações mais comuns incluem:</p>
<ul>
<li>Adição e subtração de dias, semanas, meses ou anos:</li>
</ul>
<ul>
<li>Comparação de datas:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<ul>
<li>Formatação de datas para strings:</li>
</ul>
<ul>
<li>Extração de componentes de data (ano, mês, dia):</li>
</ul>
<ul>
<li>Cálculo de diferenças entre datas:</li>
</ul>
</section>
<section id="lubridate-facilitando-a-manipulação-de-datas-no-r" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="lubridate-facilitando-a-manipulação-de-datas-no-r"><span class="header-section-number">4.4.3</span> 4.4.3 Lubridate: Facilitando a Manipulação de Datas no R</h3>
<p>Lidar com datas no R pode ser uma tarefa desafiadora, especialmente quando se precisa realizar operações complexas ou extrair informações específicas das datas. O pacote <code>lubridate</code> foi desenvolvido para simplificar a manipulação de datas, tornando as tarefas relacionadas a datas mais fáceis e intuitivas. Vamos explorar algumas das principais funcionalidades do <code>lubridate</code> em mais detalhes, com exemplos práticos:</p>
<section id="instalação-e-carregamento-do-lubridate" class="level4" data-number="4.4.3.1">
<h4 data-number="4.4.3.1" class="anchored" data-anchor-id="instalação-e-carregamento-do-lubridate"><span class="header-section-number">4.4.3.1</span> 4.4.3.1 Instalação e Carregamento do Lubridate</h4>
<p>Antes de usar o <code>lubridate</code>, é necessário instalá-lo e carregá-lo no R. Para isso, utilize o comando <code>install.packages("lubridate")</code> para a instalação e <code>library(lubridate)</code> para o carregamento do pacote. Essas etapas devem ser executadas apenas uma vez.</p>
</section>
<section id="criando-datas" class="level4" data-number="4.4.3.2">
<h4 data-number="4.4.3.2" class="anchored" data-anchor-id="criando-datas"><span class="header-section-number">4.4.3.2</span> 4.4.3.2 Criando Datas</h4>
<p>O <code>lubridate</code> torna a criação de datas simples e flexível. Podemos criar datas usando diferentes funções, dependendo do formato dos seus dados. Além da já mencionada <code>ymd()</code> para datas no formato “ano-mês-dia,” também podemos utilizar:</p>
<ul>
<li><p><code>mdy()</code> para datas no formato “mês-dia-ano.”</p></li>
<li><p><code>dmy()</code> para datas no formato “dia-mês-ano.”</p></li>
</ul>
<p>Essas funções ajudam a evitar confusões em relação ao formato das datas, tornando o processo de entrada de dados mais seguro. Veja um exemplo:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: lubridate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:data.table':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21"</code></pre>
</div>
</div>
</section>
<section id="operações-com-datas" class="level4" data-number="4.4.3.3">
<h4 data-number="4.4.3.3" class="anchored" data-anchor-id="operações-com-datas"><span class="header-section-number">4.4.3.3</span> 4.4.3.3 Operações com Datas</h4>
<p>Operações com datas, como adição e subtração de dias, semanas, meses ou anos, são realizadas de forma mais clara e intuitiva no <code>lubridate</code>. O pacote fornece funções específicas para isso, como <code>days()</code>, <code>weeks()</code>, <code>months()</code>, e <code>years()</code>. Isso permite que executemos operações como:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-28"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-06-21"</code></pre>
</div>
</div>
<p>Essa sintaxe simplificada torna as operações com datas mais legíveis e menos propensas a erros.</p>
</section>
<section id="extraindo-informações-de-datas" class="level4" data-number="4.4.3.4">
<h4 data-number="4.4.3.4" class="anchored" data-anchor-id="extraindo-informações-de-datas"><span class="header-section-number">4.4.3.4</span> 4.4.3.4 Extraindo Informações de Datas</h4>
<p>O <code>lubridate</code> permite extrair facilmente informações de datas. Com funções como <code>year()</code>, <code>month()</code>, e <code>day()</code>, você pode obter o ano, mês ou dia de uma data específica. Além disso, é possível extrair informações mais detalhadas, como hora, minuto, e segundo, caso necessário. Isso é particularmente útil ao lidar com séries temporais ou análises de eventos temporais específicos. Veja exemplos:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2023</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45</code></pre>
</div>
</div>
</section>
<section id="funções-de-resumo-de-datas" class="level4" data-number="4.4.3.5">
<h4 data-number="4.4.3.5" class="anchored" data-anchor-id="funções-de-resumo-de-datas"><span class="header-section-number">4.4.3.5</span> 4.4.3.5 Funções de Resumo de Datas</h4>
<p>O <code>lubridate</code> oferece funções que auxiliam na análise e resumo de datas. Podemos calcular a diferença entre duas datas com facilidade, obtendo o resultado em dias, semanas, meses ou anos. Isso é útil em cenários em que é preciso medir a duração entre eventos ou calcular intervalos de tempo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -6</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3628800</code></pre>
</div>
</div>
</section>
<section id="lidar-com-fusos-horários" class="level4" data-number="4.4.3.6">
<h4 data-number="4.4.3.6" class="anchored" data-anchor-id="lidar-com-fusos-horários"><span class="header-section-number">4.4.3.6</span> 4.4.3.6 Lidar com Fusos Horários</h4>
<p>Para situações que envolvem fusos horários, o <code>lubridate</code> facilita a manipulação, permitindo a converção de datas entre fusos e calcule diferenças de tempo em fusos diferentes. Isso é especialmente valioso em análises que abrangem regiões geográficas distintas ou quando é necessário considerar fusos horários em análises de eventos globais.</p>
<ul>
<li>Converter uma Data para um Fuso Horário Específico: Imagine que temos uma data em um fuso horário específico e desejamos convertê-la para outro fuso horário. O <code>lubridate</code> facilita essa tarefa usando a função <code>with_tz()</code>. Veja um exemplo:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21 12:00:00 EDT"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-21 17:00:00 BST"</code></pre>
</div>
</div>
<p>Neste exemplo, convertemos uma data de Nova Iorque para Londres.</p>
<ul>
<li><strong>Calcular a Diferença de Tempo entre Datas em Fusos Horários Diferentes</strong>:</li>
</ul>
<p>Calcular a diferença de tempo entre duas datas em fusos horários diferentes pode ser útil para determinar a sincronização de eventos em locais geograficamente distintos. O <code>lubridate</code> permite isso com facilidade:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<ul>
<li><strong>Trabalhar com Fusos Horários em Data Frames</strong>: Em muitos casos, você pode ter um conjunto de dados com datas em diferentes fusos horários. O <code>lubridate</code> permite a manipulação desses dados em um Data Frame de forma eficiente. Suponha que temos um Data Frame chamado <code>dados</code> com datas em diferentes fusos horários:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      nome                data            data_utc
1 Evento 1 2023-08-21 12:00:00 2023-08-21 16:00:00
2 Evento 2 2023-08-21 12:00:00 2023-08-21 16:00:00</code></pre>
</div>
</div>
<p>Neste exemplo, convertemos todas as datas no Data Frame para o fuso horário UTC, criando uma nova coluna chamada <code>data_utc</code>.</p>
<p>Lidar com fusos horários em análises de dados é fundamental para garantir que as informações temporais sejam precisas e consistentes, especialmente em cenários globais ou quando eventos ocorrem em locais diferentes ao redor do mundo. O pacote <code>lubridate</code> no R simplifica significativamente essa tarefa, tornando a manipulação de datas com fusos horários uma tarefa mais clara e eficiente.</p>
</section>
</section>
</section>
<section id="exercícios" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">4.5</span> 4.5 Exercícios</h2>
<ol type="1">
<li>Utilizando o banco de dados <code>car_crash</code>:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         data  horario n_da_ocorrencia tipo_de_ocorrencia    km    trecho
1: 01/01/2010 04:21:00              18         sem vítima   167 BR-393/RJ
2: 01/01/2010 02:13:00              20         sem vítima 269,5 BR-116/PR
3: 01/01/2010 03:35:00     000024/2010         sem vítima    77 BR-290/RS
4: 01/01/2010 07:31:00     000038/2010         sem vítima    52 BR-116/RS
5: 01/01/2010 04:57:00     000027/2010         sem vítima    33 BR-290/RS
6: 01/01/2010 08:02:00     000042/2010         sem vítima    24 BR-290/RS
   sentido              lugar_acidente tipo_de_acidente automovel bicicleta
1:   Norte              Rodovia do Aço       Derrapagem         1        NA
2:     Sul Autopista Regis Bittencourt Colisão Traseira         2        NA
3:   Norte                     Concepa  COLISÃO LATERAL         2         0
4:   Norte                     Concepa    QUEDA DE MOTO         0         0
5:   Norte                     Concepa    QUEDA DE MOTO         0         0
6:     Sul                     Concepa   SAÍDA DE PISTA         1         0
   caminhao moto onibus outros tracao_animal transporte_de_cargas_especiais
1:       NA   NA     NA     NA            NA                             NA
2:       NA   NA     NA     NA            NA                             NA
3:        0    0      0      0             0                              0
4:        0    1      0      0             0                              0
5:        0    1      0      0             0                              0
6:        0    0      0      0             0                              0
   trator_maquinas utilitarios ilesos levemente_feridos moderadamente_feridos
1:              NA          NA      1                 0                     0
2:              NA          NA      3                NA                    NA
3:               0           0      2                 0                     0
4:               0           0      1                 0                     0
5:               0           0      1                 0                     0
6:               0           0      1                 0                     0
   gravemente_feridos mortos
1:                  0      0
2:                 NA     NA
3:                  0      0
4:                  0      0
5:                  0      0
6:                  0      0</code></pre>
</div>
</div>
<ol type="a">
<li>formate a coluna data em uma <code>data</code> (dd-mm-yyyy)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            data data_formatada
   1: 01/01/2010     2010-01-01
   2: 01/01/2011     2011-01-01
   3: 01/01/2012     2012-01-01
   4: 01/01/2013     2013-01-01
   5: 01/01/2014     2014-01-01
  ---                          
4947: 31/12/2018     2018-12-31
4948: 31/12/2019     2019-12-31
4949: 31/12/2020     2020-12-31
4950: 31/12/2021     2021-12-31
4951: 31/12/2022     2022-12-31</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>formate a coluna horario para o <code>horário</code> do acidente (hh:mm:ss)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        horario horario_acidente
    1: 04:21:00         04:21:00
    2: 02:13:00         02:13:00
    3: 03:35:00         03:35:00
    4: 07:31:00         07:31:00
    5: 04:57:00         04:57:00
   ---                          
44265: 23:23:36         23:23:36
44266: 21:41:52         21:41:52
44267: 19:26:09         19:26:09
44268: 05:05:55         05:05:55
44269: 12:12:09         12:12:09</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Qual o mês com maior quantidade de acidentes?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
     mes     n
   &lt;dbl&gt; &lt;int&gt;
 1    12 85308
 2     1 82507
 3    10 74716
 4     6 72276
 5    11 71677
 6     3 70696
 7     2 68783
 8     5 68626
 9     9 68586
10     7 68392
11     8 66596
12     4 66398</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Qual ano ocorreram mais acidentes?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
     ano     n
   &lt;dbl&gt; &lt;int&gt;
 1  2015 74458
 2  2017 70107
 3  2016 70104
 4  2014 67816
 5  2019 64853
 6  2018 63970
 7  2020 62632
 8  2021 62498
 9  2012 61090
10  2013 60953
11  2011 60455
12  2022 56838
13  2010 54837
14  2023 33950</code></pre>
</div>
</div>
<ol start="5" type="a">
<li>Qual horário acontecem menos acidentes?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,440 × 2
   hora      n
   &lt;chr&gt; &lt;int&gt;
 1 02:39   219
 2 01:56   220
 3 02:58   221
 4 03:04   221
 5 02:37   222
 6 02:43   227
 7 02:01   229
 8 02:32   229
 9 03:21   229
10 03:13   230
# ℹ 1,430 more rows</code></pre>
</div>
</div>
<ol start="6" type="a">
<li>Qual a média, desvio padrão, mediana, Q1 e Q3 para a quantidade de indivíduos classificados como levemente feridos por mês/ano?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 163 × 9
   `mes/ano`     n media    Q1 mediana    Q3   min   max    sd
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1 2010/01    1880 0.809     0       1     1     0    41 1.42 
 2 2010/02    1676 0.816     0       1     1     0    30 1.29 
 3 2010/03    1844 0.741     0       1     1     0    26 1.12 
 4 2010/04    1842 0.840     0       1     1     0     7 1.00 
 5 2010/05    2044 0.776     0       1     1     0    19 1.04 
 6 2010/06    1777 0.757     0       1     1     0    12 0.992
 7 2010/07    1929 0.802     0       1     1     0    21 1.25 
 8 2010/08    1776 0.819     0       1     1     0    51 1.52 
 9 2010/09    2119 0.748     0       1     1     0     9 0.977
10 2010/10    2030 0.807     0       1     1     0    39 1.29 
# ℹ 153 more rows</code></pre>
</div>
</div>
<ol start="7" type="a">
<li>Quantos acidentes com vítimas fatais aconteceram, por mês/ano, em mediana entre as 6:00am e 11:59am.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 2
   `mes/ano`     n
   &lt;chr&gt;     &lt;int&gt;
 1 2010/01     308
 2 2010/02     325
 3 2010/03     333
 4 2010/04     380
 5 2010/05     443
 6 2010/06     381
 7 2010/07     406
 8 2010/08     348
 9 2010/09     426
10 2010/10     417
# ℹ 149 more rows</code></pre>
</div>
</div>
</section>
<section id="junção-de-dados" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="junção-de-dados"><span class="header-section-number">4.6</span> 4.6 Junção de dados</h2>
<p>É raro que uma análise de dados envolva apenas uma única fonte de dados. Normalmente, você possui vários <code>data.frames</code> e precisa uni-los para realizar as análises que lhe interessam.</p>
<section id="dados" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="dados"><span class="header-section-number">4.6.1</span> 4.6.1 Dados</h3>
<p>Para a aula de hoje, utilizaremos o pacote <code>nycflights13</code>, o qual contém dados relacionados a voos na cidade de Nova York.</p>
</section>
<section id="chaves-primárias-e-chaves-estrangeiras" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="chaves-primárias-e-chaves-estrangeiras"><span class="header-section-number">4.6.2</span> 4.6.2 Chaves Primárias e Chaves Estrangeiras</h3>
<p>Para compreender os principais tipos de junções de banco de dados, é fundamental entender como duas tabelas podem ser conectadas por meio de um par de chaves, dentro de cada tabela. Vamos estudar brevemente sobre os dois tipos principais de chaves, para isso, vamos utilizar os conjuntos de dados do pacote <code>nycflights13</code>. Esse pacote apresenta cinco tabelas com informações distintas acerca de vôos em New York.</p>
<section id="chaves-primárias-e-estrangeiras" class="level4" data-number="4.6.2.1">
<h4 data-number="4.6.2.1" class="anchored" data-anchor-id="chaves-primárias-e-estrangeiras"><span class="header-section-number">4.6.2.1</span> 4.6.2.1 Chaves primárias e estrangeiras</h4>
<p>Toda junção envolve um par de chaves: <em>uma chave primária e uma chave estrangeira</em>. <strong>Uma chave primária é uma variável ou conjunto de variáveis que identifica cada observação de forma única</strong>. Quando mais de uma variável é necessária, a chave é chamada de chave composta. Por exemplo, no <code>nycfights13</code>:</p>
<ul>
<li>A tabela <code>airlines</code> registra dois dados sobre cada companhia aérea: seu código de operadora e seu nome completo. Você pode identificar uma companhia aérea pelo seu código de operadora de duas letras, tornando o código de operadora (<code>carrier</code>) a chave primária (<em>primary key</em>).</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: nycflights13</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   carrier name                       
   &lt;chr&gt;   &lt;chr&gt;                      
 1 9E      Endeavor Air Inc.          
 2 AA      American Airlines Inc.     
 3 AS      Alaska Airlines Inc.       
 4 B6      JetBlue Airways            
 5 DL      Delta Air Lines Inc.       
 6 EV      ExpressJet Airlines Inc.   
 7 F9      Frontier Airlines Inc.     
 8 FL      AirTran Airways Corporation
 9 HA      Hawaiian Airlines Inc.     
10 MQ      Envoy Air                  
11 OO      SkyWest Airlines Inc.      
12 UA      United Air Lines Inc.      
13 US      US Airways Inc.            
14 VX      Virgin America             
15 WN      Southwest Airlines Co.     
16 YV      Mesa Airlines Inc.         </code></pre>
</div>
</div>
<ul>
<li>A tabela <code>airports</code>, por sua vez, registra dados sobre cada aeroporto. Podemos identificar cada aeroporto pelo seu código de aeroporto de três letras, tornando o código <code>FAA</code> a chave primária.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,458 × 8
   faa   name                             lat    lon   alt    tz dst   tzone    
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
 1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…
 2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…
 3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…
 4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…
 5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…
 6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…
 7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…
 8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…
 9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…
10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…
# ℹ 1,448 more rows</code></pre>
</div>
</div>
<ul>
<li>A tabela <code>planes</code> registra dados sobre cada aeronave. Podemos identificar uma aeronave pelo seu número de cauda (<code>tailnum</code>), tornando o número de cauda a chave primária.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,322 × 9
   tailnum  year type              manufacturer model engines seats speed engine
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
 1 N10156   2004 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 2 N102UW   1998 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 3 N103US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 4 N104UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 5 N10575   2002 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 6 N105UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 7 N107US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 8 N108UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 9 N109UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
10 N110UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
# ℹ 3,312 more rows</code></pre>
</div>
</div>
<ul>
<li>A tabela <code>weather</code> registra dados sobre o clima nos aeroportos de origem. Você pode identificar cada observação pela <strong>combinação</strong> de localização e horário, tornando a origem (<code>origin</code>) e o horário (<code>time_hour</code>) a <strong>chave primária composta</strong>.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26,115 × 15
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
# ℹ 26,105 more rows
# ℹ 5 more variables: wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,
#   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p><strong>Uma chave estrangeira é uma variável (ou conjunto de variáveis) que corresponde a uma chave primária em outra tabela</strong>. Por exemplo:</p>
<ul>
<li><code>flights$tailnum</code> é uma chave estrangeira que corresponde à chave primária <code>planes$tailnum</code>.</li>
<li><code>flights$carrier</code> é uma chave estrangeira que corresponde à chave primária <code>airlines$carrier</code>.</li>
</ul>
<p>Podemos ver como cada banco de dados está relacionado com os demais na Figura abaixo. <img src="./imagens/ncyflights13.png" class="img-fluid" alt="Descrição da Imagem"></p>
<ul>
<li><p>A Tabela “flights” está vinculada à tabela “planes” por meio de uma variável única, “tailnum”.</p></li>
<li><p>A Tabela “flights” está vinculada à tabela “airlines” por meio de uma variável única, “carrier”.</p></li>
<li><p>A Tabela “flights” está vinculada à tabela “airports” de duas maneiras: por meio das variáveis “origin” e “dest”.</p></li>
<li><p>A Tabela “flights” está vinculada à tabela “weather” por meio das variáveis “origin” (localização), “year”, “month”, “day” e “hour”.</p></li>
</ul>
<p>Note que as chaves primárias e estrangeiras têm quase sempre os mesmos nomes, o que, como veremos em breve, tornará sua vida de junção muito mais fácil. Também vale a pena observar a relação oposta: quase todos os nomes de variáveis usados em várias tabelas têm o mesmo significado em cada lugar. Há apenas uma exceção: o ano (<code>year</code>) significa o ano de partida nos voos (<code>flights</code>) e o ano de fabricação nas aeronaves (<code>planes</code>).</p>
</section>
<section id="verificação-de-chaves-primárias" class="level4" data-number="4.6.2.2">
<h4 data-number="4.6.2.2" class="anchored" data-anchor-id="verificação-de-chaves-primárias"><span class="header-section-number">4.6.2.2</span> 4.6.2.2 Verificação de Chaves Primárias</h4>
<p>Agora que identificamos as chaves primárias em cada tabela, é uma boa prática verificar se elas realmente identificam de forma única cada observação. Uma maneira de fazer isso é contar as chaves primárias e procurar entradas em que <code>n()</code> seja maior que um.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 2
# ℹ 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# ℹ 3 variables: time_hour &lt;dttm&gt;, origin &lt;chr&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<p>Além de termos chave primária única, é importante que não haja valores faltantes, se um valor estiver ausente, ele não poderá identificar uma observação.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 9
# ℹ 9 variables: tailnum &lt;chr&gt;, year &lt;int&gt;, type &lt;chr&gt;, manufacturer &lt;chr&gt;,
#   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 15
# ℹ 15 variables: origin &lt;chr&gt;, year &lt;int&gt;, month &lt;int&gt;, day &lt;int&gt;, hour &lt;int&gt;,
#   temp &lt;dbl&gt;, dewp &lt;dbl&gt;, humid &lt;dbl&gt;, wind_dir &lt;dbl&gt;, wind_speed &lt;dbl&gt;,
#   wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="combinando-dados" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="combinando-dados"><span class="header-section-number">4.6.3</span> 4.6.3 Combinando dados</h3>
<p>Bom, agora que compreendemos a importância de chaves vamos agora introdur dois tipos importantes de junções:</p>
<ul>
<li>Junções mutacionais, que adicionam novas variáveis a um conjunto de dados a partir de observações correspondentes em outro banco de dados. São elas:
<ul>
<li><code>inner_join</code>;</li>
<li><code>full_join</code>;</li>
<li><code>left_join</code>;</li>
<li><code>right_join</code>.</li>
</ul></li>
<li>Junções de filtragem, que filtram observações de um quadro de dados com base em se elas correspondem ou não a uma observação em outro banco de dados.
<ul>
<li><code>semi_join()</code>;</li>
<li><code>anti_join()</code>.</li>
</ul></li>
</ul>
</section>
<section id="junções-mutacionais" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="junções-mutacionais"><span class="header-section-number">4.6.4</span> 4.6.4 Junções Mutacionais</h3>
<p>Uma junção mutacional (<em>mutating join</em>) permite combinar <strong>variáveis de dois conjuntos de dados</strong>: primeiro, ele corresponde às observações através de suas chaves e, em seguida, copia as variáveis de um conjunto de dados para o outro. Assim como a função <code>mutate()</code>, as funções de <code>join</code> adicionam variáveis <em>à direita</em>, portanto, se o seu conjunto de dados tiver muitas variáveis, as novas variáveis não serão imediatamente visíveis. Para facilitar a compreensão dos exemplos a seguir, criaremos um conjunto de dados mais suscinto com apenas seis variáveis, e apenas com vôos com distância superior à 1000km:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51,695 × 6
    year time_hour           origin dest  tailnum carrier
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  
 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA     
 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA     
 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA     
 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA     
 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US     
 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US     
 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA     
 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA     
 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6     
10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL     
# ℹ 51,685 more rows</code></pre>
</div>
</div>
<section id="left-join" class="level4" data-number="4.6.4.1">
<h4 data-number="4.6.4.1" class="anchored" data-anchor-id="left-join"><span class="header-section-number">4.6.4.1</span> 4.6.4.1 Left Join</h4>
<p>O <code>left join</code> retorna todas as linhas do primeiro conjunto de dados (tabela à esquerda) e as linhas correspondentes do segundo conjunto de dados (tabela à direita), se houver correspondência. Se não houver correspondência na tabela à direita, os valores serão preenchidos com <code>NA</code> (valores ausentes).</p>
<p><img src="./imagens/leftjoin.svg" class="img-fluid" alt="Descrição da Imagem"> Suponha que gostariamos de adicionar o nome completo da companhia aerea no nosso banco de dados. Para isso, precisamos combinar as informações de <code>flights2</code> com <code>airlines</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(carrier)`</code></pre>
</div>
</div>
<p>Note que, por definição, a função buscou a chave primária como <code>carrier</code>. Nesse caso, como temos apenas uma chave, é viável fazermos isso. Contudo, é uma boa prática definirmos qual a chave que gostaríamos de combinar os bancos de dados.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51,695 × 7
    year time_hour           origin dest  tailnum carrier name                 
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                
 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.
 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.
 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.
 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.
 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      
 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      
 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.
 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.
 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      
10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. 
# ℹ 51,685 more rows</code></pre>
</div>
</div>
</section>
<section id="right-join" class="level4" data-number="4.6.4.2">
<h4 data-number="4.6.4.2" class="anchored" data-anchor-id="right-join"><span class="header-section-number">4.6.4.2</span> 4.6.4.2 Right Join</h4>
<p>O <code>right_join</code> retorna apenas as linhas do primeiro conjunto de dados (tabela à esquerda) se houver correspondência com o segundo conjunto de dados (tabela à direita). Se não houver correspondência na tabela à esquerda, os valores serão preenchidos com <code>NA</code> (valores ausentes).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/righttjoin.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
<p>Suponha que, temos interesse em buscar informações acerca dos dos vôos realizados pelos aviões em <code>flights2</code>. Para isso, basta unirmos as tabelas <code>planes</code> com <code>flights2</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50,720 × 14
   year.x time_hour           origin dest  tailnum carrier year.y type          
    &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         
 1   2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA        1998 Fixed wing mu…
 2   2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA          NA Fixed wing mu…
 3   2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA        2008 Fixed wing mu…
 4   2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US        1999 Fixed wing mu…
 5   2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US        2009 Fixed wing mu…
 6   2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA        2004 Fixed wing mu…
 7   2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA        1999 Fixed wing mu…
 8   2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6        2003 Fixed wing mu…
 9   2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL        1997 Fixed wing mu…
10   2013 2013-01-01 07:00:00 JFK    LAX   N627VA  VX        2006 Fixed wing mu…
# ℹ 50,710 more rows
# ℹ 6 more variables: manufacturer &lt;chr&gt;, model &lt;chr&gt;, engines &lt;int&gt;,
#   seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="inner-join" class="level4" data-number="4.6.4.3">
<h4 data-number="4.6.4.3" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">4.6.4.3</span> 4.6.4.3 Inner Join</h4>
<p>O <code>inner join</code> retorna apenas as linhas que têm correspondências em ambos os conjuntos de dados. Ou seja, ele preserva apenas as observações com chaves correspondentes em ambas as tabelas.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/innerjoin.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
<p>Suponha que, temos interesse em buscar informações acerca dos aeroportos de origem realizados pelos aviões em <code>flights2</code>. Porém, apenas temos interesse em informações que aparecem em ambos bancos. Para isso, basta unirmos as tabelas <code>flights2</code> com <code>airports</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51,695 × 13
    year time_hour           origin dest  tailnum carrier name         lat   lon
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      John F Ke…  40.6 -73.8
 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      Newark Li…  40.7 -74.2
 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      Newark Li…  40.7 -74.2
 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      John F Ke…  40.6 -73.8
 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      Newark Li…  40.7 -74.2
 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      John F Ke…  40.6 -73.8
 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      Newark Li…  40.7 -74.2
 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      Newark Li…  40.7 -74.2
 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      John F Ke…  40.6 -73.8
10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      John F Ke…  40.6 -73.8
# ℹ 51,685 more rows
# ℹ 4 more variables: alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="full-join" class="level4" data-number="4.6.4.4">
<h4 data-number="4.6.4.4" class="anchored" data-anchor-id="full-join"><span class="header-section-number">4.6.4.4</span> 4.6.4.4 Full Join</h4>
<p>O <code>full_join</code> retorna todas as linhas de ambos os conjuntos de dados (tabelas à esquerda e à direita). Ele preenche com <code>NA</code> aqueles valores que não têm correspondência em uma das tabelas.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/fulljoin.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
<p>Suponha que, temos interesse em buscar informações acerca dos aeroportos de destino realizados pelos aviões em <code>flights2</code>. Porém, apenas temos interesse em todas informações que aparecem em ambos bancos. Para isso, basta unirmos as tabelas <code>flights2</code> com <code>airports</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53,137 × 13
    year time_hour           origin dest  tailnum carrier name         lat   lon
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      Los Angel…  33.9 -118.
 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      San Franc…  37.6 -122.
 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      Mc Carran…  36.1 -115.
 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      San Franc…  37.6 -122.
 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      Phoenix S…  33.4 -112.
 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      Phoenix S…  33.4 -112.
 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      Los Angel…  33.9 -118.
 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      John Wayn…  33.7 -118.
 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      Mc Carran…  36.1 -115.
10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      San Franc…  37.6 -122.
# ℹ 53,127 more rows
# ℹ 4 more variables: alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="junções-de-filtragem" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="junções-de-filtragem"><span class="header-section-number">4.6.5</span> 4.6.5 Junções de Filtragem</h3>
<p>Como o próprio nome sugere, a ação principal de uma junção de filtragem é filtrar as linhas. Existem dois tipos: semi-junções e anti-junções. Semi-junções mantêm todas as linhas em <code>x</code> que têm uma correspondência em <code>y</code>. Por exemplo, poderíamos usar uma semi-junção para filtrar o conjunto de dados de aeroportos (<code>airports</code>) para mostrar apenas os aeroportos de origem:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 8
  faa   name                  lat   lon   alt    tz dst   tzone           
  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;           
1 EWR   Newark Liberty Intl  40.7 -74.2    18    -5 A     America/New_York
2 JFK   John F Kennedy Intl  40.6 -73.8    13    -5 A     America/New_York</code></pre>
</div>
</div>
<p>Anti-junções são o oposto: elas retornam todas as linhas em <code>x</code> que não têm correspondência em <code>y</code>. São úteis para encontrar valores ausentes que são implícitos nos dados. Valores implicitamente ausentes não aparecem como NAs, mas sim existem apenas como uma ausência. Por exemplo, podemos encontrar linhas ausentes em aeroportos procurando voos que não tenham um aeroporto de destino correspondente:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 1
  dest 
  &lt;chr&gt;
1 BQN  
2 SJU  
3 STT  
4 PSE  </code></pre>
</div>
</div>
</section>
</section>
<section id="exercícios-1" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="exercícios-1"><span class="header-section-number">4.7</span> 4.7 Exercícios</h2>
<ol type="1">
<li>Para vôos com atraso superior a 24 horas em <code>flights</code>, verifique as condições climáticas em <code>weather</code>. Há algum padrão? Quais os meses do ano em que você encontra os maiores atrasos?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., weather, by = c("year", "month", "day")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 1 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  month total_atrasos
  &lt;int&gt;         &lt;int&gt;
1     7        684804
2    12        676632
3     6        642168
4     4        605641
5     8        538609
6     3        506040</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Encontre os 20 destinos mais comuns e identifique seu aeroporto. Qual a temperatura média (mensal) em Celcius desses lugares? E a precipitação média, em cm?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(origin, time_hour)`
`summarise()` has grouped output by 'dest'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 4
# Groups:   dest [20]
   dest  name                               media_temp media_precip
   &lt;chr&gt; &lt;chr&gt;                                   &lt;dbl&gt;        &lt;dbl&gt;
 1 ABQ   Albuquerque International Sunport        16.0      0.0136 
 2 ACK   Nantucket Mem                            23.5      0.0116 
 3 ALB   Albany Intl                              10.1      0.00629
 4 ANC   Ted Stevens Anchorage Intl               28.7      0      
 5 ATL   Hartsfield Jackson Atlanta Intl          14.0      0.0123 
 6 AUS   Austin Bergstrom Intl                    13.9      0.0138 
 7 AVL   Asheville Regional Airport               18.9      0.0154 
 8 BDL   Bradley Intl                             12.8      0.0125 
 9 BGR   Bangor Intl                              16.4      0.00563
10 BHM   Birmingham Intl                          15.3      0.0208 
11 BNA   Nashville Intl                           14.8      0.0119 
12 BOS   General Edward Lawrence Logan Intl       14.0      0.0124 
13 BTV   Burlington Intl                          14.0      0.0123 
14 BUF   Buffalo Niagara Intl                     13.2      0.00970
15 BUR   Bob Hope                                 13.4      0.00688
16 BWI   Baltimore Washington Intl                11.2      0.00990
17 BZN   Gallatin Field                           14.3      0      
18 CAE   Columbia Metropolitan                    13.8      0.0100 
19 CAK   Akron Canton Regional Airport            15.2      0.0132 
20 CHO   Charlottesville-Albemarle                11.2      0.00684</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Inclua uma coluna com a cia aérea na tabela <code>planes</code>. Quantas companhias áreas voaram cada avião naquele ano?</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tailnum', 'carrier'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336776</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336776</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,339 × 12
   tailnum  year type      manufacturer model engines seats speed engine carrier
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 N10156   2004 Fixed wi… EMBRAER      EMB-…       2    55    NA Turbo… EV     
 2 N102UW   1998 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 3 N103US   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 4 N104UW   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 5 N10575   2002 Fixed wi… EMBRAER      EMB-…       2    55    NA Turbo… EV     
 6 N105UW   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 7 N107US   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 8 N108UW   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
 9 N109UW   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
10 N110UW   1999 Fixed wi… AIRBUS INDU… A320…       2   182    NA Turbo… US     
# ℹ 3,329 more rows
# ℹ 2 more variables: name &lt;chr&gt;, total_voos &lt;int&gt;</code></pre>
</div>
</div>
<p>Inclua a latitude e longitude de cada origem destino na tabela <code>flights</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
   origin dest  origin_lat origin_lon dest_lat dest_lon
   &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 EWR    IAH         40.7      -74.2     30.0    -95.3
 2 LGA    IAH         40.8      -73.9     30.0    -95.3
 3 JFK    MIA         40.6      -73.8     25.8    -80.3
 4 JFK    BQN         40.6      -73.8     NA       NA  
 5 LGA    ATL         40.8      -73.9     33.6    -84.4
 6 EWR    ORD         40.7      -74.2     42.0    -87.9
 7 EWR    FLL         40.7      -74.2     26.1    -80.2
 8 LGA    IAD         40.8      -73.9     38.9    -77.5
 9 JFK    MCO         40.6      -73.8     28.4    -81.3
10 LGA    ORD         40.8      -73.9     42.0    -87.9
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section>
<section id="organização-de-dados" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="organização-de-dados"><span class="header-section-number">4.8</span> 4.8 Organização de dados</h2>
<p>Compreender a organização de dados é fundamental para análises estatísticas eficazes. Quando trabalhamos com dados em R, é importante seguir as regras que tornam um conjunto de dados <em>tidy</em> (organizado), o que facilita o processamento e a interpretação dos dados. Existem três regras inter-relacionadas que tornam um conjunto de dados <em>tidy</em>:</p>
<ol type="1">
<li><strong>Cada variável é uma coluna; cada coluna é uma variável</strong>: Isso significa que cada característica ou medida que você está analisando deve ser representada por uma coluna separada no conjunto de dados.</li>
</ol>
<ul>
<li>Por exemplo, se você estiver trabalhando com dados de pacientes, as variáveis como idade, gênero, altura e peso devem ser colunas separadas.</li>
</ul>
<ol start="2" type="1">
<li><strong>Cada observação é uma linha; cada linha é uma observação</strong>: Cada linha do conjunto de dados deve representar uma única observação, caso ou instância. Isso garante que os dados estejam organizados de maneira que seja fácil identificar e comparar diferentes casos.</li>
</ol>
<ul>
<li>Por exemplo, cada linha pode representar um paciente individual em um conjunto de dados médicos.</li>
</ul>
<ol start="3" type="1">
<li><strong>Cada valor é uma célula; cada célula é um único valor</strong>: Cada célula no conjunto de dados deve conter um único valor. Isso significa que não deve haver combinações de valores em uma única célula. Cada célula deve conter uma informação única e específica relacionada à variável e à observação correspondente.</li>
</ol>
<p>Ao seguir essas três regras, você cria um conjunto de dados tidy que é fácil de manipular, visualizar e analisar. Essa organização facilita a utilização de funções como <code>pivot_longer</code> e <code>pivot_wider</code> para remodelar os dados quando necessário a fim de adaptá-los às necessidades de sua análise estatística em R</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/tidy_data.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
<section id="pivotagem" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="pivotagem"><span class="header-section-number">4.8.1</span> 4.8.1 Pivotagem</h3>
<p>Pivotar, como o próprio nome sugere, é um processo de transformação de um conjunto de dados, no qual as colunas e linhas são reorganizadas de tal forma que os valores que originalmente estavam dispostos em linhas agora são apresentados como colunas, e vice-versa. Esse procedimento é fundamental para preparar e organizar dados para análises estatísticas e visualizações mais eficazes.</p>
<section id="formato-wide-largo-e-formato-long-longo" class="level4" data-number="4.8.1.1">
<h4 data-number="4.8.1.1" class="anchored" data-anchor-id="formato-wide-largo-e-formato-long-longo"><span class="header-section-number">4.8.1.1</span> 4.8.1.1 Formato Wide (Largo) e Formato Long (Longo)</h4>
<p>Em ciência de dados, é comum falarmos em dois formatos principais: o formato <em>wide</em> (largo) e o formato <em>long</em> (longo). Essas representações são especialmente úteis para diferentes tipos de análises e visualizações.</p>
<ol type="1">
<li><strong>Formato Wide (Largo)</strong>: Nesse formato, os dados são organizados de forma que cada variável é representada por uma coluna separada e cada observação (ou instância) ocupa uma única linha. Isso significa que as informações são distribuídas em várias colunas, tornando-o mais adequado para conjuntos de dados com poucas variáveis, onde as informações são bem condensadas.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/tidy_data.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li><strong>Formato Long (Longo)</strong>: Já no formato long (ou longo), os dados são organizados de maneira que as variáveis estão empilhadas em uma única coluna, enquanto uma coluna adicional é usada para indicar o nome da variável. Cada observação é representada por uma linha separada. Esse formato é ideal quando se trabalha com conjuntos de dados mais complexos, nos quais as informações estão espalhadas em várias categorias ou momentos de tempo, por exemplo.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./imagens/long_data.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Descrição da Imagem</figcaption>
</figure>
</div>
</section>
</section>
<section id="exercício-1" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="exercício-1"><span class="header-section-number">4.8.2</span> 4.8.2 Exercício</h3>
<p>Com os dois conjuntos de dados abaixo, defina qual a versão <em>organizada</em> dos dados.</p>
<ol type="1">
<li><strong>Conjunto 1:</strong></li>
</ol>
<ul>
<li><strong>Wide</strong>:</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Nome</th>
<th>Idade</th>
<th>Peso (kg)</th>
<th>Gênero</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>34</td>
<td>52.16</td>
<td>Feminino</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>35</td>
<td>72.57</td>
<td>Masculino</td>
</tr>
<tr class="odd">
<td>Christine</td>
<td>38</td>
<td>56.70</td>
<td>Feminino</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Long</strong>:</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Nome</th>
<th>Variável</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>Idade</td>
<td>34</td>
</tr>
<tr class="even">
<td>Alice</td>
<td>Peso (kg)</td>
<td>52.16</td>
</tr>
<tr class="odd">
<td>Alice</td>
<td>Gênero</td>
<td>Feminino</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Idade</td>
<td>35</td>
</tr>
<tr class="odd">
<td>Bob</td>
<td>Peso (kg)</td>
<td>72.57</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Gênero</td>
<td>Masculino</td>
</tr>
<tr class="odd">
<td>Christine</td>
<td>Idade</td>
<td>38</td>
</tr>
<tr class="even">
<td>Christine</td>
<td>Peso (kg)</td>
<td>56.70</td>
</tr>
<tr class="odd">
<td>Christine</td>
<td>Gênero</td>
<td>Feminino</td>
</tr>
</tbody>
</table>
<ol type="1">
<li><strong>Conjunto 2:</strong></li>
</ol>
<ul>
<li><strong>Wide</strong>:</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Tamanho da Pedra</th>
<th>Tratamento A - Recuperados</th>
<th>Tratamento A - Falhas</th>
<th>Tratamento B - Recuperados</th>
<th>Tratamento B - Falhas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pequeno</td>
<td>81</td>
<td>6</td>
<td>234</td>
<td>36</td>
</tr>
<tr class="even">
<td>Grande</td>
<td>192</td>
<td>71</td>
<td>55</td>
<td>25</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Long</strong>:</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Tamanho da Pedra</th>
<th>Tratamento</th>
<th>Recuperado</th>
<th>Falha</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pequena</td>
<td>A</td>
<td>81</td>
<td>6</td>
</tr>
<tr class="even">
<td>Pequena</td>
<td>B</td>
<td>234</td>
<td>36</td>
</tr>
<tr class="odd">
<td>Grande</td>
<td>A</td>
<td>192</td>
<td>71</td>
</tr>
<tr class="even">
<td>Grande</td>
<td>B</td>
<td>55</td>
<td>25</td>
</tr>
</tbody>
</table>
</section>
<section id="pivotando-dados-em-r" class="level3" data-number="4.8.3">
<h3 data-number="4.8.3" class="anchored" data-anchor-id="pivotando-dados-em-r"><span class="header-section-number">4.8.3</span> 4.8.2 Pivotando dados em R</h3>
<p>Para aprendermos sobre os tipos de <em>pivot</em> em R, vamos utilizar o banco de dados <code>table1</code>. Esse banco de dados possui dados de casos reportados de Tuberculose e o tamanho da população em dois anos para três países. Esses dados são provenientes dos dados <code>who</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<section id="pivot_wider" class="level4" data-number="4.8.3.1">
<h4 data-number="4.8.3.1" class="anchored" data-anchor-id="pivot_wider"><span class="header-section-number">4.8.3.1</span> 4.8.2.1 <code>pivot_wider</code></h4>
<p>A função <code>pivot_wider</code> é usada para transformar um conjunto de dados de um formato longo para um formato largo. Isso é útil quando temos informações em uma única coluna que desejamos espalhar em várias colunas.</p>
<ul>
<li><strong>Sintaxe:</strong></li>
</ul>
<p><code>pivot_wider(data, names_from, values_from)</code> - <code>data</code>: O conjunto de dados que você deseja transformar. - <code>names_from</code>: A coluna que contém os nomes das variáveis que você deseja espalhar. - <code>values_from</code>: A coluna que contém os valores correspondentes a essas variáveis.</p>
<p><strong>Exemplo</strong>: Transformando em dados de <code>table1</code> em wide.</p>
<ul>
<li>Suponha que queremos o número de casos por ano.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
</section>
<section id="pivot_longer" class="level4" data-number="4.8.3.2">
<h4 data-number="4.8.3.2" class="anchored" data-anchor-id="pivot_longer"><span class="header-section-number">4.8.3.2</span> 4.8.2.2 <code>pivot_longer</code></h4>
<p>A função pivot_longer é utilizada para transformar um conjunto de dados de um formato largo (wide) para um formato longo (long). Isso é útil quando temos variáveis espalhadas em várias colunas e desejamos organizar esses dados em uma única coluna, tornando-os mais adequados para análises e visualizações. Geralmente, usamos <code>pivot_longer</code> quando temos variáveis empilhadas em diferentes colunas e queremos reunir essas informações em uma única coluna.</p>
<ul>
<li><strong>Sintaxe:</strong> <code>pivot_longer(data, cols, names_to, values_to)</code>
<ul>
<li><code>data</code>: O conjunto de dados que você deseja transformar.</li>
<li><code>cols</code>: As colunas que você deseja empilhar no formato longo.</li>
<li><code>names_to</code>: O nome da nova coluna que irá conter os nomes das variáveis empilhadas.</li>
<li><code>values_to</code>: O nome da nova coluna que irá conter os valores das variáveis empilhadas.</li>
</ul></li>
</ul>
<p><strong>Exemplo</strong>: Transformando em dados de <code>table1</code> em long.</p>
<ul>
<li>Suponha que queremos os casos e o tamanho da população como uma variável.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year variavel      tamanho
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</section>
<section id="separando-observações" class="level4" data-number="4.8.3.3">
<h4 data-number="4.8.3.3" class="anchored" data-anchor-id="separando-observações"><span class="header-section-number">4.8.3.3</span> 4.8.2.3 Separando observações</h4>
<p>A função separate() divide uma única coluna em várias colunas, dividindo-a sempre que um caractere separador aparece. Vamos considerar o exemplo da <code>table3</code>:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p>Note que a coluna <code>rate</code> é na verdade uma coluna onde temos os casos e a população separadas por “/”. Podemos separar essa coluna em duas utilizando a função separate.</p>
<p>Caso tenhamos interesse em uni-las novamente, podemos utilizar a função <code>unite</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</section>
</section>
<section id="exemplo" class="level3" data-number="4.8.4">
<h3 data-number="4.8.4" class="anchored" data-anchor-id="exemplo"><span class="header-section-number">4.8.4</span> 4.8.3 Exemplo</h3>
<p>Vamos utilizar os dados de notificações de casos provenientes do site do <a href="https://www.who.int/teams/global-tuberculosis-programme/data">WHO</a>.</p>
<p>Este conjunto de dados exemplifica uma situação comum na vida real, onde os dados estão desorganizados e não estão em um formato adequado para análises. Ele apresenta colunas redundantes, códigos de variáveis incomuns e uma abundância de valores ausentes. Em suma, está em uma condição “bagunçada” e precisaremos de várias etapas para limpá-lo e organizá-lo de forma apropriada. Assim como o pacote <code>dplyr</code>, o <code>tidyr</code> foi projetado para que cada função tenha uma função específica e bem definida. Isso significa que, em cenários da vida real, você geralmente precisará encadear várias dessas funções em uma sequência lógica para obter os dados em um estado utilizável.</p>
<p>O ponto de partida mais eficaz geralmente é reunir as colunas que não são consideradas variáveis. Vamos examinar o que temos:</p>
<ol type="1">
<li><p><strong>Country (país), iso2 e iso3</strong>: Essas três colunas parecem redundantes e especificam o país de formas diferentes. Variável redundante.</p></li>
<li><p><strong>Year (ano)</strong>: É claramente uma variável que representa o ano em que os dados foram registrados.</p></li>
<li><p><strong>Outras Colunas Não Identificadas</strong>: As colunas restantes, como “new_sp_m014”, “new_ep_m014” e “new_ep_f014”, não sabemos o que representam ainda. De acordo com a estrutura dos nomes das colunas, elas provavelmente contêm valores, não são variáveis.</p></li>
</ol>
<p>Portanto, nossa primeira tarefa é agrupar todas as colunas, desde “new_sp_m014” até “newrel_f65”, porque ainda não compreendemos completamente o que essas colunas representam. Chamaremos essa variável genérica de “chave”. Além disso, sabemos que as células dessas colunas representam a contagem de casos, então criaremos uma variável chamada “casos” para armazenar esses valores.</p>
<p>É importante observar que há muitos valores ausentes nos dados atuais. Para facilitar a análise inicial, usaremos a função “values_drop_na” para nos concentrarmos apenas nos valores que estão presentes, deixando os valores ausentes de lado temporariamente.</p>
<p>Dessa forma, estaremos prontos para começar o processo de organização e limpeza desses dados desorganizados.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 97,867 × 6
   country     iso2  iso3   year chave        casos
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;        &lt;int&gt;
 1 Afghanistan AF    AFG    1997 new_sp_m014      0
 2 Afghanistan AF    AFG    1997 new_sp_m1524    10
 3 Afghanistan AF    AFG    1997 new_sp_m2534     6
 4 Afghanistan AF    AFG    1997 new_sp_m3544     3
 5 Afghanistan AF    AFG    1997 new_sp_m4554     5
 6 Afghanistan AF    AFG    1997 new_sp_m5564     2
 7 Afghanistan AF    AFG    1997 new_sp_m65       0
 8 Afghanistan AF    AFG    1997 new_sp_f014      5
 9 Afghanistan AF    AFG    1997 new_sp_f1524    38
10 Afghanistan AF    AFG    1997 new_sp_f2534    36
# ℹ 97,857 more rows</code></pre>
</div>
</div>
<p>Para tentarmos entender a estrutura de chave, vamos contar ela.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 56 × 2
   chave            n
   &lt;chr&gt;        &lt;int&gt;
 1 new_ep_f014   1029
 2 new_ep_f1524  1018
 3 new_ep_f2534  1018
 4 new_ep_f3544  1018
 5 new_ep_f4554  1014
 6 new_ep_f5564  1014
 7 new_ep_f65    1011
 8 new_ep_m014   1035
 9 new_ep_m1524  1023
10 new_ep_m2534  1017
# ℹ 46 more rows</code></pre>
</div>
</div>
<p>Se olharmos o dicionário de variáveis, presente junto aos dados, estamos interessados nos casos, ou seja, nas variáveis descritas por <code>new</code>. Vamos então, filtrar nossos dados para manter apenas essas variáveis.</p>
<p>Além disso, o dicionário das variáveis nos informa o seguinte:</p>
<ul>
<li><p>As três primeiras letras de cada coluna indicam se a coluna contém casos novos (new) ou antigos (old) de tuberculose.</p></li>
<li><p>As letras seguintes descrevem o tipo de tuberculose:</p>
<ul>
<li><p>“rel” indica casos de recaída.</p></li>
<li><p>“ep” indica casos de tuberculose extrapulmonar.</p></li>
<li><p>“sn” indica casos de tuberculose pulmonar que não puderam ser diagnosticados por esfregaço pulmonar (<em>smear negative</em>).</p></li>
<li><p>“sp” indica casos de tuberculose pulmonar que puderam ser diagnosticados por esfregaço pulmonar (<em>smear positive</em>).</p></li>
</ul></li>
<li><p>A sexta letra indica o sexo dos pacientes com tuberculose, sendo “m” para masculino e “f” para feminino.</p></li>
<li><p>Os números restantes representam os grupos etários. O conjunto de dados agrupa os casos em sete faixas etárias:</p>
<ul>
<li><p>“014” = 0 a 14 anos</p></li>
<li><p>“1524” = 15 a 24 anos</p></li>
<li><p>“2534” = 25 a 34 anos</p></li>
<li><p>“3544” = 35 a 44 anos</p></li>
<li><p>“4554” = 45 a 54 anos</p></li>
<li><p>“5564” = 55 a 64 anos</p></li>
<li><p>“65” = 65 anos ou mais</p></li>
</ul></li>
</ul>
<p>Para tornar o formato dos nomes das colunas mais consistente, é necessário fazer um pequeno ajuste: infelizmente, os nomes estão ligeiramente inconsistentes, pois em vez de “new_rel”, temos “newrel”. Para isso, vamos utilizar a função <code>str_replace()</code>, a ideia básica é simples: substituir os caracteres “newrel” por “new_rel”. Isso tornará todos os nomes das variáveis consistentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 97,867 × 6
   country     iso2  iso3   year chave        casos
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;        &lt;int&gt;
 1 Afghanistan AF    AFG    1997 new_sp_m014      0
 2 Afghanistan AF    AFG    1997 new_sp_m1524    10
 3 Afghanistan AF    AFG    1997 new_sp_m2534     6
 4 Afghanistan AF    AFG    1997 new_sp_m3544     3
 5 Afghanistan AF    AFG    1997 new_sp_m4554     5
 6 Afghanistan AF    AFG    1997 new_sp_m5564     2
 7 Afghanistan AF    AFG    1997 new_sp_m65       0
 8 Afghanistan AF    AFG    1997 new_sp_f014      5
 9 Afghanistan AF    AFG    1997 new_sp_f1524    38
10 Afghanistan AF    AFG    1997 new_sp_f2534    36
# ℹ 97,857 more rows</code></pre>
</div>
</div>
<p>Podemos separar os valores em cada código usando duas etapas da função <code>separate()</code>. A primeira etapa dividirá os códigos em cada sublinhado (underscore).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 97,867 × 8
   country     iso2  iso3   year new   type  sexage casos
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt;
 1 Afghanistan AF    AFG    1997 new   sp    m014       0
 2 Afghanistan AF    AFG    1997 new   sp    m1524     10
 3 Afghanistan AF    AFG    1997 new   sp    m2534      6
 4 Afghanistan AF    AFG    1997 new   sp    m3544      3
 5 Afghanistan AF    AFG    1997 new   sp    m4554      5
 6 Afghanistan AF    AFG    1997 new   sp    m5564      2
 7 Afghanistan AF    AFG    1997 new   sp    m65        0
 8 Afghanistan AF    AFG    1997 new   sp    f014       5
 9 Afghanistan AF    AFG    1997 new   sp    f1524     38
10 Afghanistan AF    AFG    1997 new   sp    f2534     36
# ℹ 97,857 more rows</code></pre>
</div>
</div>
<p>Nesse caso, podemos eliminar a nova coluna, já que ela é constante em todo o conjunto de dados. Além disso, como mencionado anteriormente, as colunas “iso2” e “iso3” são redundantes e podem ser removidas. A eliminação de colunas não essenciais ajuda a simplificar o conjunto de dados e a economizar espaço de armazenamento.</p>
<p>Agora podemos separar o sexo e a idade.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 97,867 × 6
   country      year type  sexo  idade casos
   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
 1 Afghanistan  1997 sp    m     014       0
 2 Afghanistan  1997 sp    m     1524     10
 3 Afghanistan  1997 sp    m     2534      6
 4 Afghanistan  1997 sp    m     3544      3
 5 Afghanistan  1997 sp    m     4554      5
 6 Afghanistan  1997 sp    m     5564      2
 7 Afghanistan  1997 sp    m     65        0
 8 Afghanistan  1997 sp    f     014       5
 9 Afghanistan  1997 sp    f     1524     38
10 Afghanistan  1997 sp    f     2534     36
# ℹ 97,857 more rows</code></pre>
</div>
</div>
</section>
<section id="exercícios-2" class="level3" data-number="4.8.5">
<h3 data-number="4.8.5" class="anchored" data-anchor-id="exercícios-2"><span class="header-section-number">4.8.5</span> 4.8.4 Exercícios</h3>
<ol type="1">
<li>Utilizando os dados de TB5, crie uma tabela em formato wide, com a quantidade de casos por país por ano. Cada ano deve ser chamado “Ano_.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,338 × 46
   country     type  sexo  idade Ano_1997 Ano_1998 Ano_1999 Ano_2000 Ano_2001
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
 1 Afghanistan sp    m     014          0       30        8       52      129
 2 Afghanistan sp    m     1524        10      129       55      228      379
 3 Afghanistan sp    m     2534         6      128       55      183      349
 4 Afghanistan sp    m     3544         3       90       47      149      274
 5 Afghanistan sp    m     4554         5       89       34      129      204
 6 Afghanistan sp    m     5564         2       64       21       94      139
 7 Afghanistan sp    m     65           0       41        8       80      103
 8 Afghanistan sp    f     014          5       45       25       93      146
 9 Afghanistan sp    f     1524        38      350      139      414      799
10 Afghanistan sp    f     2534        36      419      160      565      888
# ℹ 11,328 more rows
# ℹ 37 more variables: Ano_2002 &lt;int&gt;, Ano_2003 &lt;int&gt;, Ano_2004 &lt;int&gt;,
#   Ano_2005 &lt;int&gt;, Ano_2006 &lt;int&gt;, Ano_2007 &lt;int&gt;, Ano_2008 &lt;int&gt;,
#   Ano_2009 &lt;int&gt;, Ano_2010 &lt;int&gt;, Ano_2011 &lt;int&gt;, Ano_2012 &lt;int&gt;,
#   Ano_2013 &lt;int&gt;, Ano_2014 &lt;int&gt;, Ano_2015 &lt;int&gt;, Ano_2016 &lt;int&gt;,
#   Ano_2017 &lt;int&gt;, Ano_2018 &lt;int&gt;, Ano_2019 &lt;int&gt;, Ano_2020 &lt;int&gt;,
#   Ano_2021 &lt;int&gt;, Ano_1995 &lt;int&gt;, Ano_1996 &lt;int&gt;, Ano_1980 &lt;int&gt;, …</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Utilizando os dados de TB5, crie uma tabela em formato wide, com a quantidade de casos por país, ano, idade e sexo.</li>
</ol>
<ul>
<li>Dica: Utilize o argumento <code>values_fn</code> da função.</li>
</ul>
<ol start="3" type="1">
<li>Volte o banco criado em 1 e 2 para o formato <code>long</code>.</li>
</ol>
</section>
</section>
<section id="strings" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="strings"><span class="header-section-number">4.9</span> 4.9 Strings</h2>
<p>No <a href="https://gysi.quarto.pub/ce302/chapters/02_basicR.html">Capítulo 2</a> vimos como criar a fazer manipulações simples em <em>strings</em>. Agora vamos aprofundar nossos conhecimentos em manipulação de <em>strings</em>. Para trabalharmos com strings em R, podemos utilizar diversos pacotes, como o <code>base</code>, <code>stringr</code> e <code>stringi</code> . Nas aulas introdutórias focamos apenas nas funções do <code>base</code>, agora vamos focar nas funções do stringr. As funções do pacote <code>stringr</code> são, na sua maioria, wrappers das funções implementadas no <code>stringi</code> .</p>
<p>Strings são objetos (ou variáveis) do tipo texto, e são delimitadas por aspas (duplas ou simples).</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: tidyverse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats 1.0.0     ✔ readr   2.1.4
✔ ggplot2 3.4.3     ✔ stringr 1.5.0
✔ purrr   1.0.1     ✔ tibble  3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ data.table::between() masks dplyr::between()
✖ tidyr::extract()      masks magrittr::extract()
✖ dplyr::filter()       masks stats::filter()
✖ data.table::first()   masks dplyr::first()
✖ lubridate::hour()     masks data.table::hour()
✖ lubridate::isoweek()  masks data.table::isoweek()
✖ dplyr::lag()          masks stats::lag()
✖ data.table::last()    masks dplyr::last()
✖ lubridate::mday()     masks data.table::mday()
✖ lubridate::minute()   masks data.table::minute()
✖ lubridate::month()    masks data.table::month()
✖ lubridate::quarter()  masks data.table::quarter()
✖ lubridate::second()   masks data.table::second()
✖ purrr::set_names()    masks magrittr::set_names()
✖ purrr::transpose()    masks data.table::transpose()
✖ lubridate::wday()     masks data.table::wday()
✖ lubridate::week()     masks data.table::week()
✖ lubridate::yday()     masks data.table::yday()
✖ lubridate::year()     masks data.table::year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Caso eu tenha interesse em criar uma string que contenha aspas, podemos cria-la da seguinte maneira:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ela disse: 'Eu adoro lasanha.'"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Ela disse: 'Eu adoro lasanha.'</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ela disse: \"Eu adoro lasanha.\""</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Ela disse: "Eu adoro lasanha."</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ela disse: \"Eu adoro lasanha.\""</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Ela disse: "Eu adoro lasanha."</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ela disse: 'Eu adoro lasanha.'"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Ela disse: 'Eu adoro lasanha.'</code></pre>
</div>
</div>
<section id="caracteres-especiais" class="level3" data-number="4.9.1">
<h3 data-number="4.9.1" class="anchored" data-anchor-id="caracteres-especiais"><span class="header-section-number">4.9.1</span> 4.9.1 Caracteres especiais</h3>
<p>Quando estamos trabalhando com textos, frequentemente temos caracteres especiais. Caracteres especiais são caracteres que não são alfanuméricos e muitas vezes têm funções específicas ou significados especiais em linguagens de programação e processamento de texto. Aqui estão alguns exemplos comuns de caracteres especiais:</p>
<ul>
<li><strong>Espaço em Branco</strong>: O espaço em branco, muitas vezes representado como ” ” ou “” em linguagens de programação, é um caractere especial que denota um espaço vazio entre palavras ou caracteres em uma string.
<ul>
<li>Em R, podemos usar espaços em branco em strings de texto da maneira usual. Por exemplo:</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Isso é um exemplo de texto com espaços em branco.</code></pre>
</div>
</div>
<ul>
<li><strong>Nova Linha ()</strong>: O caractere “” é usado para representar uma quebra de linha em uma string. Quando incluído em uma string, ele faz com que o texto subsequente seja exibido em uma nova linha.
<ul>
<li>Para criar uma nova linha em uma string, podemos usar “”. Isso é útil para criar múltiplas linhas de texto.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Primeira linha
    │ Segunda linha
    │ Terceira linha</code></pre>
</div>
</div>
<ul>
<li><strong>Tabulação (</strong>: O caractere “ representa uma tabulação horizontal. É frequentemente usado para criar recuos ou alinhar o texto em colunas.
<ul>
<li>Para adicionar tabulações em uma string, você pode usar “.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Primeira coluna{\t}Segunda coluna{\t}Terceira coluna</code></pre>
</div>
</div>
<ul>
<li><strong>Caracteres de Escape ()</strong>: O caractere “” é usado como um caractere de escape em muitas linguagens de programação. Isso significa que ele “escapa” o significado especial de outros caracteres, permitindo que você os inclua em uma string. Por exemplo, “” é usado para representar uma única barra invertida em vez de um caractere de escape.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Isso é uma única barra invertida: \</code></pre>
</div>
</div>
<ul>
<li><strong>Caracteres Unicode</strong>: Em linguagens de programação modernas, podemos usar caracteres Unicode em strings para representar uma ampla variedade de caracteres especiais de diferentes idiomas e símbolos.
<ul>
<li>Podemos utilizar códigos Unicode para incluir caracteres especiais em uma string em R. Por exemplo, o símbolo do grau (°) pode ser representado pelo código Unicode “0B0”.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ A temperatura é de 25°C.</code></pre>
</div>
</div>
<ul>
<li>O símbolo “” (nova linha), pode ser representados usando seus códigos Unicode.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ Primeira linha
    │ Segunda linha</code></pre>
</div>
</div>
<ul>
<li>Caracteres matemáticos, como o símbolo de somatório (<span class="math inline">\(\sum\)</span>), podem ser representados com seus códigos Unicode.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ O símolo do somatório é: ∑</code></pre>
</div>
</div>
<ul>
<li>Emojis também podem ser representados por Unicode.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ OMG! Também posso usar emoji! 😱</code></pre>
</div>
</div>
</section>
<section id="concatenando-strings" class="level3" data-number="4.9.2">
<h3 data-number="4.9.2" class="anchored" data-anchor-id="concatenando-strings"><span class="header-section-number">4.9.2</span> 4.9.2 Concatenando strings</h3>
<p>Muitas vezes temos interesse em combinar strings, como faziamos antes com a função <code>paste()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome                    ola
1   Ana    Santos  Boa noite Ana Santos!
2 Maria     Silva Boa noite Maria Silva!
3  João     Souza  Boa noite João Souza!
4  &lt;NA&gt;      &lt;NA&gt;                   &lt;NA&gt;</code></pre>
</div>
</div>
<p>Alternativamente, quando temos diversas variáveis que queremos combinar, podemos utilizar a função <code>str_glue</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome               mensagem
1   Ana    Santos  Boa noite Ana Santos!
2 Maria     Silva Boa noite Maria Silva!
3  João     Souza  Boa noite João Souza!
4  &lt;NA&gt;      &lt;NA&gt;       Boa noite NA NA!</code></pre>
</div>
</div>
<p>Outra opção para a qual utilizamavamos o <code>paste</code>, era para unir todos os elementos de uma string, utilizando o argumento <code>collapse</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ana, Maria, João, NA"</code></pre>
</div>
</div>
<p>Uma alternativa é utilizarmos a função <code>str_flatten</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AnaMariaJoão"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ana, Maria e João"</code></pre>
</div>
</div>
</section>
<section id="separando-strings" class="level3" data-number="4.9.3">
<h3 data-number="4.9.3" class="anchored" data-anchor-id="separando-strings"><span class="header-section-number">4.9.3</span> 4.9.3 Separando Strings</h3>
<p>Muitas vezes precisamos separar uma string em duas (ou mais). Na aula passada vimos a função <code>separate</code>. Hoje vamos ver a <code>str_split</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]    [,2]    
[1,] "Ana"   "Santos"
[2,] "Maria" "Silva" 
[3,] "João"  "Souza" 
[4,] NA      ""      </code></pre>
</div>
</div>
</section>
<section id="formatação-básica" class="level3" data-number="4.9.4">
<h3 data-number="4.9.4" class="anchored" data-anchor-id="formatação-básica"><span class="header-section-number">4.9.4</span> 4.9.4 Formatação básica</h3>
<p>Muitas vezes queremos passar um texto para caixa alta, caixa baixa, título ou até mesmo formato de sentença. Para isso podemos utilizar as funções: <code>str_to_upper()</code>, <code>str_to_lower()</code>, <code>str_to_title()</code> e <code>str_to_sentence()</code> respectivamente.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "caixa baixa"       "caixa alta"        "texto de sentença"
[4] "texto em título"  </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Caixa baixa"       "Caixa alta"        "Texto de sentença"
[4] "Texto em título"  </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Caixa Baixa"       "Caixa Alta"        "Texto De Sentença"
[4] "Texto Em Título"  </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CAIXA BAIXA"       "CAIXA ALTA"        "TEXTO DE SENTENÇA"
[4] "TEXTO EM TÍTULO"  </code></pre>
</div>
</div>
<p>Algumas vezes recebemos um texto desformatado, no sentido de conter diversos espaços no meio do texto. E temos interesse em limpar os excessos de espaço. Para isso podemos utilizar as seguintes funções: <code>str_trim()</code> e <code>str_squish()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Olá, esse texto tem    diversos        espaços completamente desnecessários. "</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "  Olá, esse texto tem    diversos        espaços completamente desnecessários."</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Olá, esse texto tem    diversos        espaços completamente desnecessários."</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Olá, esse texto tem diversos espaços completamente desnecessários."</code></pre>
</div>
</div>
</section>
<section id="comprimento-de-string" class="level3" data-number="4.9.5">
<h3 data-number="4.9.5" class="anchored" data-anchor-id="comprimento-de-string"><span class="header-section-number">4.9.5</span> 4.9.5 Comprimento de string</h3>
<p>Muitas vezes temos interesse em encontrar textos incorretos em um banco de dados, uma maneira de identificar essas observações é simplesmente por contar a quantidade de caracteres de uma string. Para isso podemos utilizar a função <code>str_length()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome Nome_Sobrenome comprimento_nome
1   Ana    Santos     Ana Santos                3
2 Maria     Silva    Maria Silva                5
3  João     Souza     João Souza                4
4  &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;               NA</code></pre>
</div>
</div>
<p>Alternativamente podemos estar interessados em contar a quantidade de caracteres especificos. Para isso, utilizamos a função <code>str_count()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome Nome_Sobrenome qtd_a
1   Ana    Santos     Ana Santos     1
2 Maria     Silva    Maria Silva     2
3  João     Souza     João Souza     0
4  &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;    NA</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome Nome_Sobrenome qtd_vogais qtd_consoantes
1   Ana    Santos     Ana Santos          1              2
2 Maria     Silva    Maria Silva          3              2
3  João     Souza     João Souza          2              2
4  &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;         NA             NA</code></pre>
</div>
</div>
</section>
<section id="substituição-de-strings" class="level3" data-number="4.9.6">
<h3 data-number="4.9.6" class="anchored" data-anchor-id="substituição-de-strings"><span class="header-section-number">4.9.6</span> 4.9.6 Substituição de strings</h3>
<p>Algumas vezes podemos estar interessados em substituir alguma string por outra. Para isso podemos utilizar a função <code>str_replace()</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   nome sobrenome Nome_Sobrenome
1   Ana    Santos     Ana Santos
2 Maria     Silva    Maria Silva
3  Joao     Souza     João Souza
4  &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;</code></pre>
</div>
</div>
<p>Outras vezes queremos simplesmente remover algum caracter. Para isso utilizamos a função <code>str_remove()</code> para remover a primeira instância do caracter ou <code>str_remove_all()</code> para remover todas as instâncias.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  nome sobrenome Nome_Sobrenome
1   An    Santos     Ana Santos
2 Mria     Silva    Maria Silva
3  Jão     Souza     João Souza
4 &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  nome sobrenome Nome_Sobrenome
1   An    Santos     Ana Santos
2   Mr     Silva    Maria Silva
3    J     Souza     João Souza
4 &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;</code></pre>
</div>
</div>
</section>
<section id="expressões-regulares" class="level3" data-number="4.9.7">
<h3 data-number="4.9.7" class="anchored" data-anchor-id="expressões-regulares"><span class="header-section-number">4.9.7</span> 4.9.7 Expressões Regulares</h3>
<p>Expressões regulares, muitas vezes abreviadas como “RegEx” são padrões de texto que descrevem conjuntos de <em>strings</em>. Elas são amplamente utilizadas para realizar operações de busca, correspondência e manipulação de <em>strings</em> em linguagens de programação e ferramentas de processamento de texto, incluindo R. Alguns símbolos e conceitos-chave em expressões regulares:</p>
<ol type="1">
<li><strong>Literais:</strong> Caracteres literais correspondem a si mesmos. Por exemplo, a regex “abc” corresponderá à sequência “abc” em uma string.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><strong>Meta-caracteres:</strong> São caracteres com significados especiais em regex. Alguns exemplos incluem:</li>
</ol>
<ul>
<li><code>.</code> (ponto): Corresponde a qualquer caractere, exceto uma nova linha.</li>
<li><code>*</code>: Corresponde a zero ou mais ocorrências do caractere ou grupo anterior.</li>
<li><code>+</code>: Corresponde a uma ou mais ocorrências do caractere ou grupo anterior.</li>
<li><code>?</code>: Corresponde a zero ou uma ocorrência do caractere ou grupo anterior.</li>
<li><code>[]</code>: Define uma classe de caracteres. Por exemplo, <code>[aeiou]</code> corresponde a qualquer vogal.</li>
<li><code>|</code> (barra vertical): Funciona como um “OU” lógico. Por exemplo, “a|b” corresponde a “a” ou “b”.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><strong>Âncoras</strong>: São usadas para ancorar padrões em posições específicas da string.</li>
</ol>
<ul>
<li><code>^</code>: Corresponde ao início da string.</li>
<li><code>$</code>: Corresponde ao final da string.</li>
<li><code>\b</code>: Corresponde a uma borda de palavra (início ou fim de uma palavra).</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE  TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><strong>Grupos</strong>: Parênteses <code>()</code> são usados para agrupar caracteres em subexpressões. Isso é útil para aplicar operadores a um conjunto de caracteres.</li>
</ol>
<ul>
<li>Exemplo: <code>(abc)+</code> corresponde a “abc”, “abcabc”, “abcabcabc”, etc.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "nana" "na"   "nana"</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><strong>Quantificadores</strong>: Controlam o número de ocorrências de um caractere ou grupo.</li>
</ol>
<ul>
<li><code>{n}</code>: Corresponde exatamente a n ocorrências.</li>
<li><code>{n,}</code>: Corresponde a pelo menos n ocorrências.</li>
<li><code>{n,m}</code>: Corresponde de n a m ocorrências.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2] 
[1,] "123" "456"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,] "12" "45" "78"</code></pre>
</div>
</div>
</section>
<section id="exercício-2" class="level3" data-number="4.9.8">
<h3 data-number="4.9.8" class="anchored" data-anchor-id="exercício-2"><span class="header-section-number">4.9.8</span> 4.9.8 Exercício</h3>
<p>Utilizando os dados disponíveis em <code>words</code> crie RegEx capaz de encontrar palavras que:</p>
<ol type="1">
<li><p>Comece com “y”.</p></li>
<li><p>Não comece com “y”.</p></li>
<li><p>Termine com “x”.</p></li>
<li><p>Tenham exatamente três letras.</p></li>
<li><p>Tenham sete letras ou mais.</p></li>
<li><p>Contenham um par vogal-consoante.</p></li>
<li><p>Contenham pelo menos dois pares vogal-consoante consecutivos.</p></li>
</ol>
<p>Para cada um dos desafios a seguir, tente resolvê-los usando tanto uma única expressão regular quanto uma combinação de várias chamadas de <code>str_detect()</code>:</p>
<ol type="1">
<li><p>Encontre todas as palavras que começam ou terminam com “x”.</p></li>
<li><p>Encontre todas as palavras que começam com uma vogal e terminam com uma consoante.</p></li>
<li><p>Existem palavras que contêm pelo menos uma de cada vogal diferente?</p></li>
<li><p>Em <code>colors()</code> existem diversos modificadores de cores como <em>light</em> e <em>dark</em>. Crie um banco contendo o nome da cor original e o nome sem o modificador.</p></li>
</ol>
</section>
</section>
<section id="cheatsheets" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="cheatsheets"><span class="header-section-number">4.10</span> 4.10 Cheatsheets</h2>
<ul>
<li><p><a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf">TidyR</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/blob/main/translations/portuguese/data-wrangling_pt.pdf">Manipulando dados</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/blob/main/lubridate.pdf">Lubridate</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/blob/main/strings.pdf">Strings</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/blob/main/regex.pdf">RegEx</a></p></li>
<li><p><a href="https://regexr.com/">Para saber mais sobre RegEx</a></p></li>
<li><p>Jogo de palavra cruzadas em <a href="https://regexcrossword.com/">RegEx</a>.</p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_objetcs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">3 Objetos em R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_funcoes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">5 Funções e Expressões</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb166" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4  Transformação de dados</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Pipes</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="al">![](./imagens/pipes.png)</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>Uma maneira de fazermos os códigos em R mais legíveis é através da utilização dos operadores pipe. Os pipes fazem com a sequência das análises se torne mais aparente, o que torna o código muito menos complexo e mais fácil de ser alterado.</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>Tomemos como exemplo a seguinte análise: Seja <span class="in">`x`</span> um vetor com 9 elementos, queremos obter um vetor ordenado do cosseno desses valores. Para fazer isso em R podemos aninhar diversas funções.</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">cos</span>(<span class="fu">unique</span>(x)), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>O que torna o código pouco legível e difícil de ser interpretado.</span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>Podemos identar o código para faciliar a leitura:</span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(</span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cos</span>(</span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(</span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a>Contudo, ainda assim, o código não é de fácil compreensão, principalmente porque devemos ler o código de dentro para fora. Os pipes surgem como uma alternativa para solucionar esse problema, tornando os códigos mais legíveis e debugáveis. Os pipes, representados pelo operador <span class="in">`%&gt;%`</span>, são uma característica poderosa e conveniente introduzida pelo pacote <span class="in">`magrittr`</span> e amplamente adotada em R para simplificar a manipulação de dados. Os pipes permitem encadear sequências de operações em uma maneira legível e intuitiva, tornando o código mais conciso e fácil de entender.</span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>**Funcionamento dos Pipes**: O operador <span class="in">`%&gt;%`</span> permite que você passe o resultado de uma expressão como o primeiro argumento de outra expressão. Isso é particularmente útil ao realizar uma série de transformações em um objeto sem a necessidade de criar variáveis intermediárias. O mesmo código que vimos anteriormente, com a utilização de pipe ficaria:</span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr)</span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> </span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cos</span>() <span class="sc">%&gt;%</span></span>
<span id="cb166-44"><a href="#cb166-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-45"><a href="#cb166-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-46"><a href="#cb166-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-47"><a href="#cb166-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.1 Uso do pipe</span></span>
<span id="cb166-48"><a href="#cb166-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-49"><a href="#cb166-49" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f`</span> é equivalente à <span class="in">`f(x)`</span></span>
<span id="cb166-50"><a href="#cb166-50" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f(y)`</span> é equivalente à <span class="in">`f(x, y)`</span></span>
<span id="cb166-51"><a href="#cb166-51" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f %&gt;% g %&gt;% h`</span> é equivalente à <span class="in">`h(g(f(x)))`</span></span>
<span id="cb166-52"><a href="#cb166-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-53"><a href="#cb166-53" aria-hidden="true" tabindex="-1"></a>O <span class="in">`%&gt;%`</span> significa que o elemento à esquerda sera avaliado pela função à direita.</span>
<span id="cb166-54"><a href="#cb166-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-55"><a href="#cb166-55" aria-hidden="true" tabindex="-1"></a>Podemos também utilizar o <span class="in">`.`</span> como espaço reservado para o elemento à esquerda, isto é:</span>
<span id="cb166-56"><a href="#cb166-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-57"><a href="#cb166-57" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f(y, .)`</span> é equivalente à <span class="in">`f(y, x)`</span></span>
<span id="cb166-58"><a href="#cb166-58" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f(., y)`</span> é equivalente à <span class="in">`f(x, y)`</span></span>
<span id="cb166-59"><a href="#cb166-59" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`x %&gt;% f(y, z = .)`</span> é equivalente à <span class="in">`f(y, z = x)`</span>.</span>
<span id="cb166-60"><a href="#cb166-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-61"><a href="#cb166-61" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.1.1.1 Exemplos</span></span>
<span id="cb166-62"><a href="#cb166-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-63"><a href="#cb166-63" aria-hidden="true" tabindex="-1"></a>Note que não conseguimos utilizar o <span class="in">`%&gt;%`</span> com operadores aritiméticos. Portanto, uma alternativa é utiliarmos as funções <span class="in">`add()`</span>, <span class="in">`subtract()`</span>, <span class="in">`multiply_by()`</span>, <span class="in">`raise_to_power()`</span>, <span class="in">`divide_by()`</span> etc. Para a lista completa de funções, utilize <span class="in">`?add`</span>.</span>
<span id="cb166-64"><a href="#cb166-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-65"><a href="#cb166-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-66"><a href="#cb166-66" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb166-67"><a href="#cb166-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-68"><a href="#cb166-68" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>)    <span class="sc">%&gt;%</span></span>
<span id="cb166-69"><a href="#cb166-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multiply_by</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-70"><a href="#cb166-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add</span>(<span class="dv">5</span>) </span>
<span id="cb166-71"><a href="#cb166-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-72"><a href="#cb166-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-73"><a href="#cb166-73" aria-hidden="true" tabindex="-1"></a>Outra opção é utilizarmos os a operação entre aspas.</span>
<span id="cb166-74"><a href="#cb166-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-75"><a href="#cb166-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-76"><a href="#cb166-76" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb166-77"><a href="#cb166-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-78"><a href="#cb166-78" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-79"><a href="#cb166-79" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">*</span><span class="st">`</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-80"><a href="#cb166-80" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">+</span><span class="st">`</span>(<span class="dv">5</span>)</span>
<span id="cb166-81"><a href="#cb166-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-82"><a href="#cb166-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-83"><a href="#cb166-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.2 Benefícios dos Pipes</span></span>
<span id="cb166-84"><a href="#cb166-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-85"><a href="#cb166-85" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Legibilidade**: Os pipes permitem ler o código da esquerda para a direita, refletindo a sequência de operações realizadas.</span>
<span id="cb166-86"><a href="#cb166-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-87"><a href="#cb166-87" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Redução de Variáveis Intermediárias**: Com pipes, não precisamos criar variáveis intermediárias para armazenar resultados parciais.</span>
<span id="cb166-88"><a href="#cb166-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-89"><a href="#cb166-89" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Encadeamento Simples**: O encadeamento de operações se torna mais intuitivo e fácil de seguir o código e procedimentos.</span>
<span id="cb166-90"><a href="#cb166-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-91"><a href="#cb166-91" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Depuração**: Ao usar pipes, podemos isolar cada etapa para depuração, facilitando a identificação de erros.</span>
<span id="cb166-92"><a href="#cb166-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-93"><a href="#cb166-93" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1.3 Pipe de atribuição</span></span>
<span id="cb166-94"><a href="#cb166-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-95"><a href="#cb166-95" aria-hidden="true" tabindex="-1"></a>Muitas vezes queremos realizar opereções e atribuir os resultados ao mesmo <span class="in">`data.frame`</span> de entrada, por exemplo, podemos querer criar uma nova variável em <span class="in">`meu_data_frame`</span>, porem, não temos interesse em duplicar o banco de dados. Podemos fazer uma atribuição explicita ou implicita. Para a explicita, simplismente atribuímos utilizando <span class="in">`=`</span> ou <span class="in">`&lt;-`</span>, como vimos até agora durante o curso. Porém, podemos fazer uma atribuição implicita utilizando o operador <span class="in">`%&lt;&gt;%`</span>.</span>
<span id="cb166-96"><a href="#cb166-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-97"><a href="#cb166-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-98"><a href="#cb166-98" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dplyr)</span>
<span id="cb166-99"><a href="#cb166-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-100"><a href="#cb166-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-101"><a href="#cb166-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-102"><a href="#cb166-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-103"><a href="#cb166-103" aria-hidden="true" tabindex="-1"></a><span class="do">## Atribuição explicita</span></span>
<span id="cb166-104"><a href="#cb166-104" aria-hidden="true" tabindex="-1"></a>meu_data_frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb166-105"><a href="#cb166-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">nome =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Carol"</span>, <span class="st">"Ana"</span>, <span class="st">"João"</span>, <span class="st">"Carlos"</span>, <span class="st">"Patrícia"</span>, <span class="st">"Leonardo"</span>),</span>
<span id="cb166-106"><a href="#cb166-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">idade =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">28</span>, <span class="dv">20</span>, <span class="dv">27</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">45</span>),</span>
<span id="cb166-107"><a href="#cb166-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">salario =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">6000</span>, <span class="dv">5500</span>, <span class="dv">8000</span>, <span class="dv">2000</span>, <span class="dv">3500</span>, <span class="dv">10000</span>, <span class="dv">3800</span> ), </span>
<span id="cb166-108"><a href="#cb166-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">meio_de_transporte =</span> <span class="fu">c</span>(<span class="st">'onibus'</span>, <span class="st">'bicicleta'</span>, <span class="st">'onibus'</span>, <span class="st">'carro'</span>, <span class="st">'carro'</span>, <span class="st">'onibus'</span>, <span class="st">'onibus'</span>, <span class="st">'bicicleta'</span>))</span>
<span id="cb166-109"><a href="#cb166-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-110"><a href="#cb166-110" aria-hidden="true" tabindex="-1"></a>meu_data_frame <span class="ot">=</span> meu_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb166-111"><a href="#cb166-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idade_25 =</span> idade <span class="sc">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb166-112"><a href="#cb166-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-113"><a href="#cb166-113" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(meu_data_frame)</span>
<span id="cb166-114"><a href="#cb166-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-115"><a href="#cb166-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-116"><a href="#cb166-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-117"><a href="#cb166-117" aria-hidden="true" tabindex="-1"></a><span class="do">## Atribuição implicita</span></span>
<span id="cb166-118"><a href="#cb166-118" aria-hidden="true" tabindex="-1"></a>meu_data_frame <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb166-119"><a href="#cb166-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idade_50 =</span> idade <span class="sc">&gt;</span> <span class="dv">50</span>)</span>
<span id="cb166-120"><a href="#cb166-120" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(meu_data_frame)</span>
<span id="cb166-121"><a href="#cb166-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-122"><a href="#cb166-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-123"><a href="#cb166-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Manipulação de Dados</span></span>
<span id="cb166-124"><a href="#cb166-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-125"><a href="#cb166-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-126"><a href="#cb166-126" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(data.table)</span>
<span id="cb166-127"><a href="#cb166-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-128"><a href="#cb166-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-129"><a href="#cb166-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-130"><a href="#cb166-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-131"><a href="#cb166-131" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dplyr)</span>
<span id="cb166-132"><a href="#cb166-132" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyr)</span>
<span id="cb166-133"><a href="#cb166-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-134"><a href="#cb166-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-135"><a href="#cb166-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-136"><a href="#cb166-136" aria-hidden="true" tabindex="-1"></a>car_crash <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"./datasets/Brazil Total highway crashes 2010 - 2023.csv.gz"</span>)</span>
<span id="cb166-137"><a href="#cb166-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-138"><a href="#cb166-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados extraídos de https://www.kaggle.com/datasets/liamarguedas/brazil-total-highway-crashes-2010-2023</span></span>
<span id="cb166-139"><a href="#cb166-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-140"><a href="#cb166-140" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(car_crash)</span>
<span id="cb166-141"><a href="#cb166-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-142"><a href="#cb166-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-143"><a href="#cb166-143" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.1 Seleção de Variáveis</span></span>
<span id="cb166-144"><a href="#cb166-144" aria-hidden="true" tabindex="-1"></a>No <span class="in">`tidyverse`</span>, a função <span class="in">`select()`</span> do pacote <span class="in">`dplyr`</span> é amplamente utilizada para selecionar as colunas relevantes de um conjunto de dados. Além de selecionar colunas pelo nome, a função <span class="in">`select()`</span> oferece diversas opções avançadas para facilitar a seleção e manipulação de colunas. Vamos explorar algumas dessas opções:</span>
<span id="cb166-145"><a href="#cb166-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-146"><a href="#cb166-146" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.1.1 Seleção por Nome de Coluna</span></span>
<span id="cb166-147"><a href="#cb166-147" aria-hidden="true" tabindex="-1"></a>A forma mais simples de usar o <span class="in">`select()`</span> é especificar os nomes das colunas que você deseja manter no resultado, por exemplo, podemos estar interessados em selecionarmos a <span class="in">`data`</span> e o <span class="in">`tipo_de_acidente`</span>.</span>
<span id="cb166-148"><a href="#cb166-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-149"><a href="#cb166-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-150"><a href="#cb166-150" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-151"><a href="#cb166-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data, tipo_de_acidente) <span class="sc">%&gt;%</span> </span>
<span id="cb166-152"><a href="#cb166-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb166-153"><a href="#cb166-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-154"><a href="#cb166-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-155"><a href="#cb166-155" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Seleção por Nome de Coluna que inicie com alguma palavra - <span class="in">`starts_with()`</span>: Essa função permite selecionar colunas cujos nomes começam com um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que iniciem com “tipo”.</span>
<span id="cb166-156"><a href="#cb166-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-157"><a href="#cb166-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-158"><a href="#cb166-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-159"><a href="#cb166-159" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-160"><a href="#cb166-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"tipo"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-161"><a href="#cb166-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb166-162"><a href="#cb166-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-163"><a href="#cb166-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-164"><a href="#cb166-164" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Seleção por Nome de Coluna que termine com alguma palavra - <span class="in">`ends_with()`</span>: Essa função permite selecionar colunas cujos nomes terminam com um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que terminem com “feridos”.</span>
<span id="cb166-165"><a href="#cb166-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-166"><a href="#cb166-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-167"><a href="#cb166-167" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-168"><a href="#cb166-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"feridos"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-169"><a href="#cb166-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb166-170"><a href="#cb166-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-171"><a href="#cb166-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-172"><a href="#cb166-172" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Seleção por Nome de Coluna que contenha alguma palavra - <span class="in">`contains()`</span>: Essa função permite selecionar colunas cujos nomes contenham um determinado padrão de caracteres. No nosso banco de dados, podemos estar interessados em selecionar todas as variáveis que contenham “mente”.</span>
<span id="cb166-173"><a href="#cb166-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-174"><a href="#cb166-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-175"><a href="#cb166-175" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-176"><a href="#cb166-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"mente"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-177"><a href="#cb166-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb166-178"><a href="#cb166-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-179"><a href="#cb166-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-180"><a href="#cb166-180" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.1.2 Seleção de variáveis por Tipos específicos de dados</span></span>
<span id="cb166-181"><a href="#cb166-181" aria-hidden="true" tabindex="-1"></a>Muitas vezes, estamos interessados em selecionar apenas variáveis de um tipo, para tratarmos os dados da maneira mais adequada.</span>
<span id="cb166-182"><a href="#cb166-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-183"><a href="#cb166-183" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Selecionar apenas variáveis numéricas: <span class="in">`is.numeric()`</span></span>
<span id="cb166-184"><a href="#cb166-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-185"><a href="#cb166-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-186"><a href="#cb166-186" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-187"><a href="#cb166-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-188"><a href="#cb166-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb166-189"><a href="#cb166-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-190"><a href="#cb166-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-191"><a href="#cb166-191" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Selecionar apenas variáveis characters: <span class="in">`is.character()`</span></span>
<span id="cb166-192"><a href="#cb166-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-193"><a href="#cb166-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-194"><a href="#cb166-194" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-195"><a href="#cb166-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-196"><a href="#cb166-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb166-197"><a href="#cb166-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-198"><a href="#cb166-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-199"><a href="#cb166-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-200"><a href="#cb166-200" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Selecionar apenas variáveis lógicas: <span class="in">`is.logical()`</span></span>
<span id="cb166-201"><a href="#cb166-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-202"><a href="#cb166-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-203"><a href="#cb166-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-204"><a href="#cb166-204" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-205"><a href="#cb166-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.logical)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-206"><a href="#cb166-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb166-207"><a href="#cb166-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-208"><a href="#cb166-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-209"><a href="#cb166-209" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.1.3 Seleção por critérios</span></span>
<span id="cb166-210"><a href="#cb166-210" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`all_of()`</span>, <span class="in">`any_of()`</span>: Permitem usar variáveis definidas externamente como argumentos da função. Note que quando utilizamos <span class="in">`all_of()`</span> todas as variáveis devem existir, já <span class="in">`any_of()`</span> permite que nem todas as variáveis existam no banco de dados.</span>
<span id="cb166-211"><a href="#cb166-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-212"><a href="#cb166-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-213"><a href="#cb166-213" aria-hidden="true" tabindex="-1"></a>vars_interesse <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"automovel"</span>, <span class="st">"bicicleta"</span>, <span class="st">"onibus"</span>)</span>
<span id="cb166-214"><a href="#cb166-214" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-215"><a href="#cb166-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(vars_interesse)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-216"><a href="#cb166-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb166-217"><a href="#cb166-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-218"><a href="#cb166-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-219"><a href="#cb166-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-220"><a href="#cb166-220" aria-hidden="true" tabindex="-1"></a>vars_interesse2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"automovel"</span>, <span class="st">"bicicleta"</span>, <span class="st">"onibus"</span>, <span class="st">"trator"</span>)</span>
<span id="cb166-221"><a href="#cb166-221" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-222"><a href="#cb166-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">any_of</span>(vars_interesse2)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-223"><a href="#cb166-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb166-224"><a href="#cb166-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-225"><a href="#cb166-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-226"><a href="#cb166-226" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.2 Seleção de Observações</span></span>
<span id="cb166-227"><a href="#cb166-227" aria-hidden="true" tabindex="-1"></a>No pacote <span class="in">`dplyr`</span> do tidyverse, a função <span class="in">`filter()`</span> é amplamente utilizada para filtrar linhas de um conjunto de dados com base em condições específicas. Ela oferece diversas opções para criar filtros complexos que atendam às suas necessidades de análise. Vamos explorar diferentes tipos de filtros e como utilizá-los de maneira eficaz.</span>
<span id="cb166-228"><a href="#cb166-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-229"><a href="#cb166-229" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.2.1 Filtros Simples</span></span>
<span id="cb166-230"><a href="#cb166-230" aria-hidden="true" tabindex="-1"></a>Filtros simples envolvem comparações entre valores de uma coluna e um valor constante. Alguns operadores de comparação comuns incluem:</span>
<span id="cb166-231"><a href="#cb166-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-232"><a href="#cb166-232" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`==`</span>: Igual a</span>
<span id="cb166-233"><a href="#cb166-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-234"><a href="#cb166-234" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`!=`</span>: Diferente de</span>
<span id="cb166-235"><a href="#cb166-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-236"><a href="#cb166-236" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`&lt;`</span>: Menor que</span>
<span id="cb166-237"><a href="#cb166-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-238"><a href="#cb166-238" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`&gt;`</span>: Maior que</span>
<span id="cb166-239"><a href="#cb166-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-240"><a href="#cb166-240" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`&lt;=`</span>: Menor ou igual a</span>
<span id="cb166-241"><a href="#cb166-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-242"><a href="#cb166-242" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`&gt;=`</span>: Maior ou igual a</span>
<span id="cb166-243"><a href="#cb166-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-244"><a href="#cb166-244" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados em filtrar as observações com pelo menos três carros envolvidos no acidente:</span>
<span id="cb166-245"><a href="#cb166-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-246"><a href="#cb166-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-247"><a href="#cb166-247" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-248"><a href="#cb166-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(automovel <span class="sc">&gt;=</span> <span class="dv">3</span>)</span>
<span id="cb166-249"><a href="#cb166-249" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-250"><a href="#cb166-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-251"><a href="#cb166-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-252"><a href="#cb166-252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.2.2 Filtros Combinados</span></span>
<span id="cb166-253"><a href="#cb166-253" aria-hidden="true" tabindex="-1"></a>Você pode combinar filtros usando os operadores lógicos <span class="in">`&amp;`</span> (AND) e <span class="in">`|`</span> (OR) para criar condições mais complexas.</span>
<span id="cb166-254"><a href="#cb166-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-255"><a href="#cb166-255" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados em filtrar as observações com pelo menos três carros e dois caminhões envolvidos no acidente:</span>
<span id="cb166-256"><a href="#cb166-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-257"><a href="#cb166-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-258"><a href="#cb166-258" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-259"><a href="#cb166-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(automovel <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;</span> caminhao <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb166-260"><a href="#cb166-260" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-261"><a href="#cb166-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-262"><a href="#cb166-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-263"><a href="#cb166-263" aria-hidden="true" tabindex="-1"></a>Podemos omitir o operador lógico <span class="in">`&amp;`</span>, então a função ficaria:</span>
<span id="cb166-264"><a href="#cb166-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-265"><a href="#cb166-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-266"><a href="#cb166-266" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-267"><a href="#cb166-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(automovel <span class="sc">&gt;=</span> <span class="dv">3</span>, caminhao <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb166-268"><a href="#cb166-268" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-269"><a href="#cb166-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-270"><a href="#cb166-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-271"><a href="#cb166-271" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados em filtrar as observações com pelo menos três carros OU dois caminhões envolvidos no acidente:</span>
<span id="cb166-272"><a href="#cb166-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-273"><a href="#cb166-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-274"><a href="#cb166-274" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-275"><a href="#cb166-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(automovel <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">|</span> caminhao <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb166-276"><a href="#cb166-276" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-277"><a href="#cb166-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-278"><a href="#cb166-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-279"><a href="#cb166-279" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.2.3 Filtrando valores dentro de um intervalo</span></span>
<span id="cb166-280"><a href="#cb166-280" aria-hidden="true" tabindex="-1"></a>Para filtramos valores dentro de um intervalo definido podemos utilizar as funções <span class="in">`between()`</span> e <span class="in">`%in%`</span>.</span>
<span id="cb166-281"><a href="#cb166-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-282"><a href="#cb166-282" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`between()`</span> é útil para filtrar valores dentro de um intervalo numérico.</span>
<span id="cb166-283"><a href="#cb166-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-284"><a href="#cb166-284" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados em filtrar as observações com valores entre 4 e 8 motos envolvidas no acidente:</span>
<span id="cb166-285"><a href="#cb166-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-286"><a href="#cb166-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-287"><a href="#cb166-287" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-288"><a href="#cb166-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(moto, <span class="at">lower =</span> <span class="dv">4</span>, <span class="at">upper =</span> <span class="dv">8</span>, <span class="at">incbounds =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb166-289"><a href="#cb166-289" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-290"><a href="#cb166-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-291"><a href="#cb166-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-292"><a href="#cb166-292" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`%in%`</span> é usada para filtrar valores que correspondem a um conjunto de valores.</span>
<span id="cb166-293"><a href="#cb166-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-294"><a href="#cb166-294" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados em filtrar as observações com ocorrência em alguma das seguintes operadoras: “Autopista Regis Bittencourt”, “Autopista Litoral Sul”, “Via Sul”.</span>
<span id="cb166-295"><a href="#cb166-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-296"><a href="#cb166-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-297"><a href="#cb166-297" aria-hidden="true" tabindex="-1"></a>autopistas <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Autopista Regis Bittencourt"</span>, <span class="st">"Autopista Litoral Sul"</span>, <span class="st">"Via Sul"</span>)</span>
<span id="cb166-298"><a href="#cb166-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-299"><a href="#cb166-299" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-300"><a href="#cb166-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lugar_acidente <span class="sc">%in%</span> autopistas) </span>
<span id="cb166-301"><a href="#cb166-301" aria-hidden="true" tabindex="-1"></a>dados_filtrados </span>
<span id="cb166-302"><a href="#cb166-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-303"><a href="#cb166-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-304"><a href="#cb166-304" aria-hidden="true" tabindex="-1"></a>Podemos estar interessados nas autopistas que não são operadas pelas mesmas operadoras. Para isso precisamos definir um operador de *not in*.</span>
<span id="cb166-305"><a href="#cb166-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-306"><a href="#cb166-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-307"><a href="#cb166-307" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%ni%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">Negate</span>(<span class="st">`</span><span class="at">%in%</span><span class="st">`</span>)</span>
<span id="cb166-308"><a href="#cb166-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-309"><a href="#cb166-309" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-310"><a href="#cb166-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lugar_acidente <span class="sc">%ni%</span> autopistas) </span>
<span id="cb166-311"><a href="#cb166-311" aria-hidden="true" tabindex="-1"></a>dados_filtrados</span>
<span id="cb166-312"><a href="#cb166-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-313"><a href="#cb166-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-314"><a href="#cb166-314" aria-hidden="true" tabindex="-1"></a>Alternativamente,</span>
<span id="cb166-315"><a href="#cb166-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-316"><a href="#cb166-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-317"><a href="#cb166-317" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-318"><a href="#cb166-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lugar_acidente <span class="sc">%in%</span> autopistas))</span>
<span id="cb166-319"><a href="#cb166-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-320"><a href="#cb166-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-321"><a href="#cb166-321" aria-hidden="true" tabindex="-1"></a>Outras vezes, podemos utilizar o operador <span class="in">`%like%`</span> que busca padrões. Por exemplo, podemos estar interessados em buscar todos acidentes que ocorreram com vítimas, e no campo <span class="in">`tipo_de_ocorrencia`</span> podemos simplesmente buscar por:</span>
<span id="cb166-322"><a href="#cb166-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-323"><a href="#cb166-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-324"><a href="#cb166-324" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-325"><a href="#cb166-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tipo_de_ocorrencia <span class="sc">%like%</span> <span class="st">"com vítima"</span>)</span>
<span id="cb166-326"><a href="#cb166-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-327"><a href="#cb166-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-328"><a href="#cb166-328" aria-hidden="true" tabindex="-1"></a>Algumas vezes temos apenas vários padrões de texto que gostaríamos de buscar. Para isso, a função <span class="in">`grepl()`</span> permite filtrar com base em padrões de texto.</span>
<span id="cb166-329"><a href="#cb166-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-330"><a href="#cb166-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-331"><a href="#cb166-331" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-332"><a href="#cb166-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ilesa|fatal"</span>, tipo_de_ocorrencia))</span>
<span id="cb166-333"><a href="#cb166-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-334"><a href="#cb166-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-335"><a href="#cb166-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.3 Resumo de informações</span></span>
<span id="cb166-336"><a href="#cb166-336" aria-hidden="true" tabindex="-1"></a>No tidyverse, as funções <span class="in">`summarise()`</span> e <span class="in">`group_by()`</span> são amplamente utilizadas para resumir informações e realizar cálculos agregados em conjuntos de dados. Elas desempenham um papel crucial na análise exploratória e na obtenção de insights significativos a partir dos dados. Vamos explorar como essas funções funcionam e como usá-las para resumir informações de maneira eficaz.</span>
<span id="cb166-337"><a href="#cb166-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-338"><a href="#cb166-338" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.3.1 Função `summarise()`</span></span>
<span id="cb166-339"><a href="#cb166-339" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`summarise()`</span> é utilizada para calcular estatísticas resumidas para uma coluna ou um conjunto de colunas. Ela permite calcular médias, somas, desvios padrão, mínimos, máximos e outras estatísticas relevantes.</span>
<span id="cb166-340"><a href="#cb166-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-341"><a href="#cb166-341" aria-hidden="true" tabindex="-1"></a>Estamos interessados em uma tabela descritiva para a variável <span class="in">`levemente_feridos`</span>.</span>
<span id="cb166-342"><a href="#cb166-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-343"><a href="#cb166-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-344"><a href="#cb166-344" aria-hidden="true" tabindex="-1"></a>tabela <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-345"><a href="#cb166-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb166-346"><a href="#cb166-346" aria-hidden="true" tabindex="-1"></a>              <span class="at">f_r =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(car_crash), </span>
<span id="cb166-347"><a href="#cb166-347" aria-hidden="true" tabindex="-1"></a>              <span class="at">f_per =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(car_crash) <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb166-348"><a href="#cb166-348" aria-hidden="true" tabindex="-1"></a>              <span class="at">media =</span> <span class="fu">mean</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-349"><a href="#cb166-349" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q1 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.25</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-350"><a href="#cb166-350" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q2 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.5</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-351"><a href="#cb166-351" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q3 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.75</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-352"><a href="#cb166-352" aria-hidden="true" tabindex="-1"></a>              <span class="at">var =</span> <span class="fu">var</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-353"><a href="#cb166-353" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd  =</span> <span class="fu">sd</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-354"><a href="#cb166-354" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-355"><a href="#cb166-355" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(levemente_feridos, <span class="at">na.rm =</span> T)) </span>
<span id="cb166-356"><a href="#cb166-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-357"><a href="#cb166-357" aria-hidden="true" tabindex="-1"></a>tabela</span>
<span id="cb166-358"><a href="#cb166-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-359"><a href="#cb166-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-360"><a href="#cb166-360" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.3.2 Agrupamento de dados</span></span>
<span id="cb166-361"><a href="#cb166-361" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`group_by()`</span> é usada para agrupar o conjunto de dados por uma ou mais colunas. Isso cria um contexto em que a função <span class="in">`summarise()`</span> pode calcular estatísticas específicas para cada grupo.</span>
<span id="cb166-362"><a href="#cb166-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-363"><a href="#cb166-363" aria-hidden="true" tabindex="-1"></a>Estamos interessados em uma tabela descritiva para a variável <span class="in">`levemente_feridos`</span> por <span class="in">`tipo_de_ocorrencia`</span>.</span>
<span id="cb166-364"><a href="#cb166-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-365"><a href="#cb166-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-366"><a href="#cb166-366" aria-hidden="true" tabindex="-1"></a>tabela <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-367"><a href="#cb166-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb166-368"><a href="#cb166-368" aria-hidden="true" tabindex="-1"></a>              <span class="at">f_r =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(car_crash), </span>
<span id="cb166-369"><a href="#cb166-369" aria-hidden="true" tabindex="-1"></a>              <span class="at">f_per =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(car_crash) <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb166-370"><a href="#cb166-370" aria-hidden="true" tabindex="-1"></a>              <span class="at">media =</span> <span class="fu">mean</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-371"><a href="#cb166-371" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q1 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.25</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-372"><a href="#cb166-372" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q2 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.5</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-373"><a href="#cb166-373" aria-hidden="true" tabindex="-1"></a>              <span class="at">Q3 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.75</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-374"><a href="#cb166-374" aria-hidden="true" tabindex="-1"></a>              <span class="at">var =</span> <span class="fu">var</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-375"><a href="#cb166-375" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd  =</span> <span class="fu">sd</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-376"><a href="#cb166-376" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-377"><a href="#cb166-377" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(levemente_feridos, <span class="at">na.rm =</span> T)) </span>
<span id="cb166-378"><a href="#cb166-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-379"><a href="#cb166-379" aria-hidden="true" tabindex="-1"></a>tabela</span>
<span id="cb166-380"><a href="#cb166-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-381"><a href="#cb166-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-382"><a href="#cb166-382" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.3 Exercício</span></span>
<span id="cb166-383"><a href="#cb166-383" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Utilizando o banco de dados <span class="in">`starwars`</span> faça o que se pede:</span>
<span id="cb166-384"><a href="#cb166-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-385"><a href="#cb166-385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb166-386"><a href="#cb166-386" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(starwars)</span>
<span id="cb166-387"><a href="#cb166-387" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(starwars)</span>
<span id="cb166-388"><a href="#cb166-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-389"><a href="#cb166-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-390"><a href="#cb166-390" aria-hidden="true" tabindex="-1"></a>a) Qual é o número total de espécies únicas presentes? Qual a frequência de indivíduos por espécie?</span>
<span id="cb166-391"><a href="#cb166-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-392"><a href="#cb166-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcule o número total de espécies únicas presentes</span></span>
<span id="cb166-393"><a href="#cb166-393" aria-hidden="true" tabindex="-1"></a>num_species <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb166-394"><a href="#cb166-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb166-395"><a href="#cb166-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb166-396"><a href="#cb166-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-397"><a href="#cb166-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcule a frequência de indivíduos por espécie</span></span>
<span id="cb166-398"><a href="#cb166-398" aria-hidden="true" tabindex="-1"></a>species_frequency <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb166-399"><a href="#cb166-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb166-400"><a href="#cb166-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">frequency =</span> <span class="fu">n</span>())</span>
<span id="cb166-401"><a href="#cb166-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-402"><a href="#cb166-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Exiba os resultados</span></span>
<span id="cb166-403"><a href="#cb166-403" aria-hidden="true" tabindex="-1"></a>num_species  <span class="co"># Número total de espécies únicas</span></span>
<span id="cb166-404"><a href="#cb166-404" aria-hidden="true" tabindex="-1"></a>species_frequency  <span class="co"># Frequência de indivíduos por espécie</span></span>
<span id="cb166-405"><a href="#cb166-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-406"><a href="#cb166-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-407"><a href="#cb166-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-408"><a href="#cb166-408" aria-hidden="true" tabindex="-1"></a>b) Calcule a altura média de personagens masculinos e femininos.</span>
<span id="cb166-409"><a href="#cb166-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-410"><a href="#cb166-410" aria-hidden="true" tabindex="-1"></a>height_gender <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb166-411"><a href="#cb166-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb166-412"><a href="#cb166-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb166-413"><a href="#cb166-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">altura_media =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> T))</span>
<span id="cb166-414"><a href="#cb166-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-415"><a href="#cb166-415" aria-hidden="true" tabindex="-1"></a>height_gender</span>
<span id="cb166-416"><a href="#cb166-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-417"><a href="#cb166-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-418"><a href="#cb166-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-419"><a href="#cb166-419" aria-hidden="true" tabindex="-1"></a>c) Qual é a média de idade dos personagens de cada espécie para personagens masculinos?</span>
<span id="cb166-420"><a href="#cb166-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-421"><a href="#cb166-421" aria-hidden="true" tabindex="-1"></a>media_idade <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb166-422"><a href="#cb166-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"masculine"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-423"><a href="#cb166-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb166-424"><a href="#cb166-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_idade =</span> <span class="fu">mean</span>(birth_year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb166-425"><a href="#cb166-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-426"><a href="#cb166-426" aria-hidden="true" tabindex="-1"></a>media_idade</span>
<span id="cb166-427"><a href="#cb166-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-428"><a href="#cb166-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-429"><a href="#cb166-429" aria-hidden="true" tabindex="-1"></a>d) Para cada espécie presente na base de dados, identifique o personagem mais velho e sua idade correspondente.</span>
<span id="cb166-430"><a href="#cb166-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-431"><a href="#cb166-431" aria-hidden="true" tabindex="-1"></a>old_character <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb166-432"><a href="#cb166-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb166-433"><a href="#cb166-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(birth_year)) <span class="sc">%&gt;%</span> <span class="co"># sem este filtro, especies com valores ausentes não vão aparecer</span></span>
<span id="cb166-434"><a href="#cb166-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(birth_year <span class="sc">==</span> <span class="fu">max</span>(birth_year)) <span class="sc">%&gt;%</span></span>
<span id="cb166-435"><a href="#cb166-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">personagem =</span> name,</span>
<span id="cb166-436"><a href="#cb166-436" aria-hidden="true" tabindex="-1"></a>            <span class="at">idade =</span> <span class="fu">max</span>(birth_year))</span>
<span id="cb166-437"><a href="#cb166-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-438"><a href="#cb166-438" aria-hidden="true" tabindex="-1"></a>old_character</span>
<span id="cb166-439"><a href="#cb166-439" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-440"><a href="#cb166-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-441"><a href="#cb166-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-442"><a href="#cb166-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.4 Manipulação de Data no R</span></span>
<span id="cb166-443"><a href="#cb166-443" aria-hidden="true" tabindex="-1"></a>A transformação de strings em datas e a manipulação de datas são tarefas comuns em análise de dados. No R, existem várias funções e pacotes disponíveis para facilitar essas operações. Vamos explorar como realizar essas tarefas usando as funcionalidades básicas do R.</span>
<span id="cb166-444"><a href="#cb166-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-445"><a href="#cb166-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4.1 Transformando Strings em Datas</span></span>
<span id="cb166-446"><a href="#cb166-446" aria-hidden="true" tabindex="-1"></a>Para transformar strings em datas, podemos utilizar a função <span class="in">`as.Date()`</span>. Por exemplo:</span>
<span id="cb166-447"><a href="#cb166-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-448"><a href="#cb166-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-449"><a href="#cb166-449" aria-hidden="true" tabindex="-1"></a><span class="co"># String representando uma data</span></span>
<span id="cb166-450"><a href="#cb166-450" aria-hidden="true" tabindex="-1"></a>data_string <span class="ot">&lt;-</span> <span class="st">"2023-08-21"</span></span>
<span id="cb166-451"><a href="#cb166-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-452"><a href="#cb166-452" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformando a string em data</span></span>
<span id="cb166-453"><a href="#cb166-453" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(data_string)</span>
<span id="cb166-454"><a href="#cb166-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-455"><a href="#cb166-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo a data</span></span>
<span id="cb166-456"><a href="#cb166-456" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span>
<span id="cb166-457"><a href="#cb166-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-458"><a href="#cb166-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-459"><a href="#cb166-459" aria-hidden="true" tabindex="-1"></a>Também podemos especificar o formato da string de data usando o argumento <span class="in">`format`</span>. Por exemplo:</span>
<span id="cb166-460"><a href="#cb166-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-461"><a href="#cb166-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-462"><a href="#cb166-462" aria-hidden="true" tabindex="-1"></a>data_string <span class="ot">&lt;-</span> <span class="st">"21/08/2023"</span></span>
<span id="cb166-463"><a href="#cb166-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-464"><a href="#cb166-464" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(data_string, </span>
<span id="cb166-465"><a href="#cb166-465" aria-hidden="true" tabindex="-1"></a>                <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb166-466"><a href="#cb166-466" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span>
<span id="cb166-467"><a href="#cb166-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-468"><a href="#cb166-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-469"><a href="#cb166-469" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4.2 Manipulação de Datas</span></span>
<span id="cb166-470"><a href="#cb166-470" aria-hidden="true" tabindex="-1"></a>Após transformar strings em datas, podemos realizar várias operações de manipulação de datas. Algumas das operações mais comuns incluem:</span>
<span id="cb166-471"><a href="#cb166-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-472"><a href="#cb166-472" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Adição e subtração de dias, semanas, meses ou anos:</span>
<span id="cb166-473"><a href="#cb166-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-474"><a href="#cb166-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-475"><a href="#cb166-475" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-476"><a href="#cb166-476" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data <span class="sc">+</span> <span class="dv">7</span>  <span class="co"># Adicionando 7 dias</span></span>
<span id="cb166-477"><a href="#cb166-477" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> data <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Subtraindo 1 dia</span></span>
<span id="cb166-478"><a href="#cb166-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-479"><a href="#cb166-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-480"><a href="#cb166-480" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Comparação de datas:</span>
<span id="cb166-481"><a href="#cb166-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-482"><a href="#cb166-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-483"><a href="#cb166-483" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-484"><a href="#cb166-484" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-15"</span>)</span>
<span id="cb166-485"><a href="#cb166-485" aria-hidden="true" tabindex="-1"></a>data1 <span class="sc">&gt;</span> data2  <span class="co"># Verifica se data1 é posterior a data2</span></span>
<span id="cb166-486"><a href="#cb166-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-487"><a href="#cb166-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-488"><a href="#cb166-488" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Formatação de datas para strings:</span>
<span id="cb166-489"><a href="#cb166-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-490"><a href="#cb166-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-491"><a href="#cb166-491" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-492"><a href="#cb166-492" aria-hidden="true" tabindex="-1"></a>data_formatada <span class="ot">&lt;-</span> <span class="fu">format</span>(data, <span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb166-493"><a href="#cb166-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-494"><a href="#cb166-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-495"><a href="#cb166-495" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Extração de componentes de data (ano, mês, dia):</span>
<span id="cb166-496"><a href="#cb166-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-497"><a href="#cb166-497" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-498"><a href="#cb166-498" aria-hidden="true" tabindex="-1"></a>ano <span class="ot">&lt;-</span> <span class="fu">format</span>(data, <span class="st">"%Y"</span>)</span>
<span id="cb166-499"><a href="#cb166-499" aria-hidden="true" tabindex="-1"></a>mes <span class="ot">&lt;-</span> <span class="fu">format</span>(data, <span class="st">"%m"</span>)</span>
<span id="cb166-500"><a href="#cb166-500" aria-hidden="true" tabindex="-1"></a>dia <span class="ot">&lt;-</span> <span class="fu">format</span>(data, <span class="st">"%d"</span>)</span>
<span id="cb166-501"><a href="#cb166-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-502"><a href="#cb166-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-503"><a href="#cb166-503" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Cálculo de diferenças entre datas:</span>
<span id="cb166-504"><a href="#cb166-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-505"><a href="#cb166-505" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-506"><a href="#cb166-506" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-08-15"</span>)</span>
<span id="cb166-507"><a href="#cb166-507" aria-hidden="true" tabindex="-1"></a>diferenca <span class="ot">&lt;-</span> <span class="fu">difftime</span>(data1, data2, <span class="at">units =</span> <span class="st">"days"</span>)  <span class="co"># Diferença em dias</span></span>
<span id="cb166-508"><a href="#cb166-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-509"><a href="#cb166-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-510"><a href="#cb166-510" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4.3 Lubridate: Facilitando a Manipulação de Datas no R</span></span>
<span id="cb166-511"><a href="#cb166-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-512"><a href="#cb166-512" aria-hidden="true" tabindex="-1"></a>Lidar com datas no R pode ser uma tarefa desafiadora, especialmente quando se precisa realizar operações complexas ou extrair informações específicas das datas. O pacote <span class="in">`lubridate`</span> foi desenvolvido para simplificar a manipulação de datas, tornando as tarefas relacionadas a datas mais fáceis e intuitivas. Vamos explorar algumas das principais funcionalidades do <span class="in">`lubridate`</span> em mais detalhes, com exemplos práticos:</span>
<span id="cb166-513"><a href="#cb166-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-514"><a href="#cb166-514" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.1 Instalação e Carregamento do Lubridate</span></span>
<span id="cb166-515"><a href="#cb166-515" aria-hidden="true" tabindex="-1"></a>Antes de usar o <span class="in">`lubridate`</span>, é necessário instalá-lo e carregá-lo no R. Para isso, utilize o comando <span class="in">`install.packages("lubridate")`</span> para a instalação e <span class="in">`library(lubridate)`</span> para o carregamento do pacote. Essas etapas devem ser executadas apenas uma vez.</span>
<span id="cb166-516"><a href="#cb166-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-517"><a href="#cb166-517" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.2 Criando Datas</span></span>
<span id="cb166-518"><a href="#cb166-518" aria-hidden="true" tabindex="-1"></a>O <span class="in">`lubridate`</span> torna a criação de datas simples e flexível. Podemos criar datas usando diferentes funções, dependendo do formato dos seus dados. Além da já mencionada <span class="in">`ymd()`</span> para datas no formato “ano-mês-dia,” também podemos utilizar:</span>
<span id="cb166-519"><a href="#cb166-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-520"><a href="#cb166-520" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`mdy()`</span> para datas no formato “mês-dia-ano.”</span>
<span id="cb166-521"><a href="#cb166-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-522"><a href="#cb166-522" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`dmy()`</span> para datas no formato “dia-mês-ano.”</span>
<span id="cb166-523"><a href="#cb166-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-524"><a href="#cb166-524" aria-hidden="true" tabindex="-1"></a>Essas funções ajudam a evitar confusões em relação ao formato das datas, tornando o processo de entrada de dados mais seguro. Veja um exemplo:</span>
<span id="cb166-525"><a href="#cb166-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-526"><a href="#cb166-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-527"><a href="#cb166-527" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(lubridate)</span>
<span id="cb166-528"><a href="#cb166-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-529"><a href="#cb166-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-530"><a href="#cb166-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-531"><a href="#cb166-531" aria-hidden="true" tabindex="-1"></a>data_ymd <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-532"><a href="#cb166-532" aria-hidden="true" tabindex="-1"></a>data_mdy <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">"08-21-2023"</span>)</span>
<span id="cb166-533"><a href="#cb166-533" aria-hidden="true" tabindex="-1"></a>data_dmy <span class="ot">&lt;-</span> <span class="fu">dmy</span>(<span class="st">"21-08-2023"</span>)</span>
<span id="cb166-534"><a href="#cb166-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-535"><a href="#cb166-535" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_ymd)</span>
<span id="cb166-536"><a href="#cb166-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-537"><a href="#cb166-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-538"><a href="#cb166-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-539"><a href="#cb166-539" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_mdy)</span>
<span id="cb166-540"><a href="#cb166-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-541"><a href="#cb166-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-542"><a href="#cb166-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-543"><a href="#cb166-543" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_dmy)</span>
<span id="cb166-544"><a href="#cb166-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-545"><a href="#cb166-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-546"><a href="#cb166-546" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.3 Operações com Datas</span></span>
<span id="cb166-547"><a href="#cb166-547" aria-hidden="true" tabindex="-1"></a>Operações com datas, como adição e subtração de dias, semanas, meses ou anos, são realizadas de forma mais clara e intuitiva no <span class="in">`lubridate`</span>. O pacote fornece funções específicas para isso, como <span class="in">`days()`</span>, <span class="in">`weeks()`</span>, <span class="in">`months()`</span>, e <span class="in">`years()`</span>. Isso permite que executemos operações como:</span>
<span id="cb166-548"><a href="#cb166-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-549"><a href="#cb166-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-550"><a href="#cb166-550" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-551"><a href="#cb166-551" aria-hidden="true" tabindex="-1"></a>data_nova <span class="ot">&lt;-</span> data <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">7</span>)  <span class="co"># Adiciona 7 dias</span></span>
<span id="cb166-552"><a href="#cb166-552" aria-hidden="true" tabindex="-1"></a>data_anterior <span class="ot">&lt;-</span> data <span class="sc">-</span> <span class="fu">months</span>(<span class="dv">2</span>)  <span class="co"># Subtrai 2 meses</span></span>
<span id="cb166-553"><a href="#cb166-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-554"><a href="#cb166-554" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_nova)</span>
<span id="cb166-555"><a href="#cb166-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-556"><a href="#cb166-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-557"><a href="#cb166-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-558"><a href="#cb166-558" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_anterior)</span>
<span id="cb166-559"><a href="#cb166-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-560"><a href="#cb166-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-561"><a href="#cb166-561" aria-hidden="true" tabindex="-1"></a>Essa sintaxe simplificada torna as operações com datas mais legíveis e menos propensas a erros.</span>
<span id="cb166-562"><a href="#cb166-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-563"><a href="#cb166-563" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.4 Extraindo Informações de Datas</span></span>
<span id="cb166-564"><a href="#cb166-564" aria-hidden="true" tabindex="-1"></a>O <span class="in">`lubridate`</span> permite extrair facilmente informações de datas. Com funções como <span class="in">`year()`</span>, <span class="in">`month()`</span>, e <span class="in">`day()`</span>, você pode obter o ano, mês ou dia de uma data específica. Além disso, é possível extrair informações mais detalhadas, como hora, minuto, e segundo, caso necessário. Isso é particularmente útil ao lidar com séries temporais ou análises de eventos temporais específicos. Veja exemplos:</span>
<span id="cb166-565"><a href="#cb166-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-566"><a href="#cb166-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-567"><a href="#cb166-567" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 15:30:45"</span>)</span>
<span id="cb166-568"><a href="#cb166-568" aria-hidden="true" tabindex="-1"></a>ano <span class="ot">&lt;-</span> <span class="fu">year</span>(data)</span>
<span id="cb166-569"><a href="#cb166-569" aria-hidden="true" tabindex="-1"></a>mes <span class="ot">&lt;-</span> <span class="fu">month</span>(data)</span>
<span id="cb166-570"><a href="#cb166-570" aria-hidden="true" tabindex="-1"></a>dia <span class="ot">&lt;-</span> <span class="fu">day</span>(data)</span>
<span id="cb166-571"><a href="#cb166-571" aria-hidden="true" tabindex="-1"></a>hora <span class="ot">&lt;-</span> <span class="fu">hour</span>(data)</span>
<span id="cb166-572"><a href="#cb166-572" aria-hidden="true" tabindex="-1"></a>minuto <span class="ot">&lt;-</span> <span class="fu">minute</span>(data)</span>
<span id="cb166-573"><a href="#cb166-573" aria-hidden="true" tabindex="-1"></a>segundo <span class="ot">&lt;-</span> <span class="fu">second</span>(data)</span>
<span id="cb166-574"><a href="#cb166-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-575"><a href="#cb166-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-576"><a href="#cb166-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-577"><a href="#cb166-577" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ano)</span>
<span id="cb166-578"><a href="#cb166-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-579"><a href="#cb166-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-580"><a href="#cb166-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-581"><a href="#cb166-581" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mes)</span>
<span id="cb166-582"><a href="#cb166-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-583"><a href="#cb166-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-584"><a href="#cb166-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-585"><a href="#cb166-585" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dia)</span>
<span id="cb166-586"><a href="#cb166-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-587"><a href="#cb166-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-588"><a href="#cb166-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-589"><a href="#cb166-589" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hora)</span>
<span id="cb166-590"><a href="#cb166-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-591"><a href="#cb166-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-592"><a href="#cb166-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-593"><a href="#cb166-593" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minuto)</span>
<span id="cb166-594"><a href="#cb166-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-595"><a href="#cb166-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-596"><a href="#cb166-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-597"><a href="#cb166-597" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(segundo)</span>
<span id="cb166-598"><a href="#cb166-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-599"><a href="#cb166-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-600"><a href="#cb166-600" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.5 Funções de Resumo de Datas</span></span>
<span id="cb166-601"><a href="#cb166-601" aria-hidden="true" tabindex="-1"></a>O <span class="in">`lubridate`</span> oferece funções que auxiliam na análise e resumo de datas. Podemos calcular a diferença entre duas datas com facilidade, obtendo o resultado em dias, semanas, meses ou anos. Isso é útil em cenários em que é preciso medir a duração entre eventos ou calcular intervalos de tempo:</span>
<span id="cb166-602"><a href="#cb166-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-603"><a href="#cb166-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-604"><a href="#cb166-604" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-08-21"</span>)</span>
<span id="cb166-605"><a href="#cb166-605" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-08-15"</span>)</span>
<span id="cb166-606"><a href="#cb166-606" aria-hidden="true" tabindex="-1"></a>diferenca_em_dias <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data2 <span class="sc">-</span> data1)</span>
<span id="cb166-607"><a href="#cb166-607" aria-hidden="true" tabindex="-1"></a>diferenca_em_semanas <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">weeks</span>(data2 <span class="sc">-</span> data1))</span>
<span id="cb166-608"><a href="#cb166-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-609"><a href="#cb166-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-610"><a href="#cb166-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-611"><a href="#cb166-611" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diferenca_em_dias)</span>
<span id="cb166-612"><a href="#cb166-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-613"><a href="#cb166-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-614"><a href="#cb166-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-615"><a href="#cb166-615" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diferenca_em_semanas)</span>
<span id="cb166-616"><a href="#cb166-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-617"><a href="#cb166-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-618"><a href="#cb166-618" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.4.3.6 Lidar com Fusos Horários</span></span>
<span id="cb166-619"><a href="#cb166-619" aria-hidden="true" tabindex="-1"></a>Para situações que envolvem fusos horários, o <span class="in">`lubridate`</span> facilita a manipulação, permitindo a converção de datas entre fusos e calcule diferenças de tempo em fusos diferentes. Isso é especialmente valioso em análises que abrangem regiões geográficas distintas ou quando é necessário considerar fusos horários em análises de eventos globais.</span>
<span id="cb166-620"><a href="#cb166-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-621"><a href="#cb166-621" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Converter uma Data para um Fuso Horário Específico:</span>
<span id="cb166-622"><a href="#cb166-622" aria-hidden="true" tabindex="-1"></a>Imagine que temos uma data em um fuso horário específico e desejamos convertê-la para outro fuso horário. O <span class="in">`lubridate`</span> facilita essa tarefa usando a função <span class="in">`with_tz()`</span>. Veja um exemplo:</span>
<span id="cb166-623"><a href="#cb166-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-624"><a href="#cb166-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-625"><a href="#cb166-625" aria-hidden="true" tabindex="-1"></a><span class="co"># Data original no fuso horário de Nova Iorque</span></span>
<span id="cb166-626"><a href="#cb166-626" aria-hidden="true" tabindex="-1"></a>data_ny <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 12:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>)</span>
<span id="cb166-627"><a href="#cb166-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-628"><a href="#cb166-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para o fuso horário de Londres</span></span>
<span id="cb166-629"><a href="#cb166-629" aria-hidden="true" tabindex="-1"></a>data_london <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(data_ny, <span class="at">tz =</span> <span class="st">"Europe/London"</span>)</span>
<span id="cb166-630"><a href="#cb166-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-631"><a href="#cb166-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-632"><a href="#cb166-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-633"><a href="#cb166-633" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_ny)</span>
<span id="cb166-634"><a href="#cb166-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-635"><a href="#cb166-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-636"><a href="#cb166-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-637"><a href="#cb166-637" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_london)</span>
<span id="cb166-638"><a href="#cb166-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-639"><a href="#cb166-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-640"><a href="#cb166-640" aria-hidden="true" tabindex="-1"></a>Neste exemplo, convertemos uma data de Nova Iorque para Londres.</span>
<span id="cb166-641"><a href="#cb166-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-642"><a href="#cb166-642" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Calcular a Diferença de Tempo entre Datas em Fusos Horários Diferentes**:</span>
<span id="cb166-643"><a href="#cb166-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-644"><a href="#cb166-644" aria-hidden="true" tabindex="-1"></a>Calcular a diferença de tempo entre duas datas em fusos horários diferentes pode ser útil para determinar a sincronização de eventos em locais geograficamente distintos. O <span class="in">`lubridate`</span> permite isso com facilidade:</span>
<span id="cb166-645"><a href="#cb166-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-646"><a href="#cb166-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-647"><a href="#cb166-647" aria-hidden="true" tabindex="-1"></a><span class="co"># Duas datas em fusos horários diferentes</span></span>
<span id="cb166-648"><a href="#cb166-648" aria-hidden="true" tabindex="-1"></a>data_ny <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 12:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>)</span>
<span id="cb166-649"><a href="#cb166-649" aria-hidden="true" tabindex="-1"></a>data_london <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 17:00:00"</span>, <span class="at">tz =</span> <span class="st">"Europe/London"</span>)</span>
<span id="cb166-650"><a href="#cb166-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-651"><a href="#cb166-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular a diferença de tempo em horas</span></span>
<span id="cb166-652"><a href="#cb166-652" aria-hidden="true" tabindex="-1"></a>diferenca_horas <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_london <span class="sc">-</span> data_ny)</span>
<span id="cb166-653"><a href="#cb166-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-654"><a href="#cb166-654" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diferenca_horas)</span>
<span id="cb166-655"><a href="#cb166-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-656"><a href="#cb166-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-657"><a href="#cb166-657" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Trabalhar com Fusos Horários em Data Frames**:</span>
<span id="cb166-658"><a href="#cb166-658" aria-hidden="true" tabindex="-1"></a>Em muitos casos, você pode ter um conjunto de dados com datas em diferentes fusos horários. O <span class="in">`lubridate`</span> permite a manipulação desses dados em um Data Frame de forma eficiente. Suponha que temos um Data Frame chamado <span class="in">`dados`</span> com datas em diferentes fusos horários:</span>
<span id="cb166-659"><a href="#cb166-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-660"><a href="#cb166-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-661"><a href="#cb166-661" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb166-662"><a href="#cb166-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">nome =</span> <span class="fu">c</span>(<span class="st">"Evento 1"</span>, <span class="st">"Evento 2"</span>),</span>
<span id="cb166-663"><a href="#cb166-663" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">c</span>(</span>
<span id="cb166-664"><a href="#cb166-664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 12:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>),</span>
<span id="cb166-665"><a href="#cb166-665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ymd_hms</span>(<span class="st">"2023-08-21 17:00:00"</span>, <span class="at">tz =</span> <span class="st">"Europe/London"</span>)</span>
<span id="cb166-666"><a href="#cb166-666" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb166-667"><a href="#cb166-667" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-668"><a href="#cb166-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-669"><a href="#cb166-669" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter todas as datas para um fuso horário comum, por exemplo, UTC</span></span>
<span id="cb166-670"><a href="#cb166-670" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>data_utc <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(dados<span class="sc">$</span>data, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb166-671"><a href="#cb166-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-672"><a href="#cb166-672" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dados)</span>
<span id="cb166-673"><a href="#cb166-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-674"><a href="#cb166-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-675"><a href="#cb166-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-676"><a href="#cb166-676" aria-hidden="true" tabindex="-1"></a>Neste exemplo, convertemos todas as datas no Data Frame para o fuso horário UTC, criando uma nova coluna chamada <span class="in">`data_utc`</span>.</span>
<span id="cb166-677"><a href="#cb166-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-678"><a href="#cb166-678" aria-hidden="true" tabindex="-1"></a>Lidar com fusos horários em análises de dados é fundamental para garantir que as informações temporais sejam precisas e consistentes, especialmente em cenários globais ou quando eventos ocorrem em locais diferentes ao redor do mundo. O pacote <span class="in">`lubridate`</span> no R simplifica significativamente essa tarefa, tornando a manipulação de datas com fusos horários uma tarefa mais clara e eficiente.</span>
<span id="cb166-679"><a href="#cb166-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-680"><a href="#cb166-680" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.5 Exercícios</span></span>
<span id="cb166-681"><a href="#cb166-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-682"><a href="#cb166-682" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Utilizando o banco de dados <span class="in">`car_crash`</span>:</span>
<span id="cb166-683"><a href="#cb166-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-684"><a href="#cb166-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregue as bibliotecas</span></span>
<span id="cb166-685"><a href="#cb166-685" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb166-686"><a href="#cb166-686" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb166-687"><a href="#cb166-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-688"><a href="#cb166-688" aria-hidden="true" tabindex="-1"></a>car_crash <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"./datasets/Brazil Total highway crashes 2010 - 2023.csv.gz"</span>)</span>
<span id="cb166-689"><a href="#cb166-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-690"><a href="#cb166-690" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(car_crash)</span>
<span id="cb166-691"><a href="#cb166-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-692"><a href="#cb166-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-693"><a href="#cb166-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-694"><a href="#cb166-694" aria-hidden="true" tabindex="-1"></a>a) formate a coluna data em uma <span class="in">`data`</span> (dd-mm-yyyy)</span>
<span id="cb166-695"><a href="#cb166-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-696"><a href="#cb166-696" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>data_formatada <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(car_crash<span class="sc">$</span>data,</span>
<span id="cb166-697"><a href="#cb166-697" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb166-698"><a href="#cb166-698" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-699"><a href="#cb166-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data, data_formatada) <span class="sc">%&gt;%</span> </span>
<span id="cb166-700"><a href="#cb166-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(data, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-701"><a href="#cb166-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-702"><a href="#cb166-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-703"><a href="#cb166-703" aria-hidden="true" tabindex="-1"></a>b) formate a coluna horario para o <span class="in">`horário`</span> do acidente (hh:mm:ss)</span>
<span id="cb166-704"><a href="#cb166-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-705"><a href="#cb166-705" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>horario_acidente <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">strptime</span>(car_crash<span class="sc">$</span>horario, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>), <span class="st">"%H:%M:%S"</span>)</span>
<span id="cb166-706"><a href="#cb166-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-707"><a href="#cb166-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-708"><a href="#cb166-708" aria-hidden="true" tabindex="-1"></a>car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-709"><a href="#cb166-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(horario, horario_acidente) <span class="sc">%&gt;%</span> </span>
<span id="cb166-710"><a href="#cb166-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(horario, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-711"><a href="#cb166-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-712"><a href="#cb166-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-713"><a href="#cb166-713" aria-hidden="true" tabindex="-1"></a>c) Qual o mês com maior quantidade de acidentes?</span>
<span id="cb166-714"><a href="#cb166-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-715"><a href="#cb166-715" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>mes <span class="ot">&lt;-</span> <span class="fu">month</span>(car_crash<span class="sc">$</span>data_formatada)</span>
<span id="cb166-716"><a href="#cb166-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-717"><a href="#cb166-717" aria-hidden="true" tabindex="-1"></a>questao_c <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-718"><a href="#cb166-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mes) <span class="sc">%&gt;%</span></span>
<span id="cb166-719"><a href="#cb166-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb166-720"><a href="#cb166-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb166-721"><a href="#cb166-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-722"><a href="#cb166-722" aria-hidden="true" tabindex="-1"></a>questao_c</span>
<span id="cb166-723"><a href="#cb166-723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-724"><a href="#cb166-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-725"><a href="#cb166-725" aria-hidden="true" tabindex="-1"></a>d) Qual ano ocorreram mais acidentes?</span>
<span id="cb166-726"><a href="#cb166-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-727"><a href="#cb166-727" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">year</span>(car_crash<span class="sc">$</span>data_formatada)</span>
<span id="cb166-728"><a href="#cb166-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-729"><a href="#cb166-729" aria-hidden="true" tabindex="-1"></a>questao_d <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-730"><a href="#cb166-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ano) <span class="sc">%&gt;%</span></span>
<span id="cb166-731"><a href="#cb166-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb166-732"><a href="#cb166-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb166-733"><a href="#cb166-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-734"><a href="#cb166-734" aria-hidden="true" tabindex="-1"></a>questao_d</span>
<span id="cb166-735"><a href="#cb166-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-736"><a href="#cb166-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-737"><a href="#cb166-737" aria-hidden="true" tabindex="-1"></a>e) Qual horário acontecem menos acidentes?</span>
<span id="cb166-738"><a href="#cb166-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-739"><a href="#cb166-739" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>hora <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">strptime</span>(car_crash<span class="sc">$</span>horario, <span class="at">format =</span> <span class="st">"%H:%M"</span>), <span class="st">"%H:%M"</span>)</span>
<span id="cb166-740"><a href="#cb166-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-741"><a href="#cb166-741" aria-hidden="true" tabindex="-1"></a>questao_e <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span></span>
<span id="cb166-742"><a href="#cb166-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hora) <span class="sc">%&gt;%</span></span>
<span id="cb166-743"><a href="#cb166-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb166-744"><a href="#cb166-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n)</span>
<span id="cb166-745"><a href="#cb166-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-746"><a href="#cb166-746" aria-hidden="true" tabindex="-1"></a>questao_e</span>
<span id="cb166-747"><a href="#cb166-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-748"><a href="#cb166-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-749"><a href="#cb166-749" aria-hidden="true" tabindex="-1"></a>f) Qual a média, desvio padrão, mediana, Q1 e Q3 para a quantidade de indivíduos classificados como levemente feridos por mês/ano?</span>
<span id="cb166-750"><a href="#cb166-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-751"><a href="#cb166-751" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span>mes <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, <span class="fu">as.integer</span>(car_crash<span class="sc">$</span>mes))</span>
<span id="cb166-752"><a href="#cb166-752" aria-hidden="true" tabindex="-1"></a>car_crash<span class="sc">$</span><span class="st">`</span><span class="at">mes/ano</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">paste</span>(car_crash<span class="sc">$</span>ano, car_crash<span class="sc">$</span>mes, <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb166-753"><a href="#cb166-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-754"><a href="#cb166-754" aria-hidden="true" tabindex="-1"></a>questao_f <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-755"><a href="#cb166-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(levemente_feridos)) <span class="sc">%&gt;%</span></span>
<span id="cb166-756"><a href="#cb166-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">mes/ano</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-757"><a href="#cb166-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb166-758"><a href="#cb166-758" aria-hidden="true" tabindex="-1"></a>            <span class="at">media =</span> <span class="fu">mean</span>(levemente_feridos, <span class="at">na.rm =</span> T), </span>
<span id="cb166-759"><a href="#cb166-759" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.25</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-760"><a href="#cb166-760" aria-hidden="true" tabindex="-1"></a>            <span class="at">mediana =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.5</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T), </span>
<span id="cb166-761"><a href="#cb166-761" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3 =</span> <span class="fu">quantile</span>(levemente_feridos, <span class="fl">0.75</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb166-762"><a href="#cb166-762" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(levemente_feridos),</span>
<span id="cb166-763"><a href="#cb166-763" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(levemente_feridos),</span>
<span id="cb166-764"><a href="#cb166-764" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd  =</span> <span class="fu">sd</span>(levemente_feridos, <span class="at">na.rm =</span> T)) </span>
<span id="cb166-765"><a href="#cb166-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-766"><a href="#cb166-766" aria-hidden="true" tabindex="-1"></a>questao_f</span>
<span id="cb166-767"><a href="#cb166-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-768"><a href="#cb166-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-769"><a href="#cb166-769" aria-hidden="true" tabindex="-1"></a>g) Quantos acidentes com vítimas fatais aconteceram, por mês/ano, em mediana entre as 6:00am e 11:59am.</span>
<span id="cb166-770"><a href="#cb166-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-771"><a href="#cb166-771" aria-hidden="true" tabindex="-1"></a>questao_g <span class="ot">&lt;-</span> car_crash <span class="sc">%&gt;%</span> </span>
<span id="cb166-772"><a href="#cb166-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tipo_de_ocorrencia <span class="sc">%like%</span> <span class="st">"com vítima"</span> <span class="sc">&amp;</span> <span class="fu">between</span>(hora, <span class="st">"06:00"</span>, <span class="st">"11:59"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-773"><a href="#cb166-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">mes/ano</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-774"><a href="#cb166-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span>
<span id="cb166-775"><a href="#cb166-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-776"><a href="#cb166-776" aria-hidden="true" tabindex="-1"></a>questao_g</span>
<span id="cb166-777"><a href="#cb166-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-778"><a href="#cb166-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-779"><a href="#cb166-779" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.6 Junção de dados</span></span>
<span id="cb166-780"><a href="#cb166-780" aria-hidden="true" tabindex="-1"></a>É raro que uma análise de dados envolva apenas uma única fonte de dados. Normalmente, você possui vários <span class="in">`data.frames`</span> e precisa uni-los para realizar as análises que lhe interessam.</span>
<span id="cb166-781"><a href="#cb166-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-782"><a href="#cb166-782" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.1 Dados</span></span>
<span id="cb166-783"><a href="#cb166-783" aria-hidden="true" tabindex="-1"></a>Para a aula de hoje, utilizaremos o pacote <span class="in">`nycflights13`</span>, o qual contém dados relacionados a voos na cidade de Nova York.</span>
<span id="cb166-784"><a href="#cb166-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-785"><a href="#cb166-785" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.2 Chaves Primárias e Chaves Estrangeiras</span></span>
<span id="cb166-786"><a href="#cb166-786" aria-hidden="true" tabindex="-1"></a>Para compreender os principais tipos de junções de banco de dados, é fundamental entender como duas tabelas podem ser conectadas por meio de um par de chaves, dentro de cada tabela. Vamos estudar brevemente sobre os dois tipos principais de chaves, para isso, vamos utilizar os conjuntos de dados do pacote <span class="in">`nycflights13`</span>. Esse pacote apresenta cinco tabelas com informações distintas acerca de vôos em New York.</span>
<span id="cb166-787"><a href="#cb166-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-788"><a href="#cb166-788" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.2.1 Chaves primárias e estrangeiras</span></span>
<span id="cb166-789"><a href="#cb166-789" aria-hidden="true" tabindex="-1"></a>Toda junção envolve um par de chaves: *uma chave primária e uma chave estrangeira*. **Uma chave primária é uma variável ou conjunto de variáveis que identifica cada observação de forma única**. Quando mais de uma variável é necessária, a chave é chamada de chave composta. Por exemplo, no <span class="in">`nycfights13`</span>:</span>
<span id="cb166-790"><a href="#cb166-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-791"><a href="#cb166-791" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A tabela <span class="in">`airlines`</span> registra dois dados sobre cada companhia aérea: seu código de operadora e seu nome completo. Você pode identificar uma companhia aérea pelo seu código de operadora de duas letras, tornando o código de operadora (<span class="in">`carrier`</span>) a chave primária (*primary key*).</span>
<span id="cb166-792"><a href="#cb166-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-793"><a href="#cb166-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-794"><a href="#cb166-794" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(nycflights13)</span>
<span id="cb166-795"><a href="#cb166-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-796"><a href="#cb166-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-797"><a href="#cb166-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-798"><a href="#cb166-798" aria-hidden="true" tabindex="-1"></a>airlines</span>
<span id="cb166-799"><a href="#cb166-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-800"><a href="#cb166-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-801"><a href="#cb166-801" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A tabela <span class="in">`airports`</span>, por sua vez, registra dados sobre cada aeroporto. Podemos identificar cada aeroporto pelo seu código de aeroporto de três letras, tornando o código <span class="in">`FAA`</span> a chave primária.</span>
<span id="cb166-802"><a href="#cb166-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-803"><a href="#cb166-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-804"><a href="#cb166-804" aria-hidden="true" tabindex="-1"></a>airports</span>
<span id="cb166-805"><a href="#cb166-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-806"><a href="#cb166-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-807"><a href="#cb166-807" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A tabela <span class="in">`planes`</span> registra dados sobre cada aeronave. Podemos identificar uma aeronave pelo seu número de cauda (<span class="in">`tailnum`</span>), tornando o número de cauda a chave primária.</span>
<span id="cb166-808"><a href="#cb166-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-809"><a href="#cb166-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-810"><a href="#cb166-810" aria-hidden="true" tabindex="-1"></a>planes</span>
<span id="cb166-811"><a href="#cb166-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-812"><a href="#cb166-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-813"><a href="#cb166-813" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A tabela <span class="in">`weather`</span> registra dados sobre o clima nos aeroportos de origem. Você pode identificar cada observação pela **combinação** de localização e horário, tornando a origem (`origin`) e o horário (`time_hour`) a **chave primária composta**.</span>
<span id="cb166-814"><a href="#cb166-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-815"><a href="#cb166-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-816"><a href="#cb166-816" aria-hidden="true" tabindex="-1"></a>weather</span>
<span id="cb166-817"><a href="#cb166-817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-818"><a href="#cb166-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-819"><a href="#cb166-819" aria-hidden="true" tabindex="-1"></a>**Uma chave estrangeira é uma variável (ou conjunto de variáveis) que corresponde a uma chave primária em outra tabela**. Por exemplo:</span>
<span id="cb166-820"><a href="#cb166-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-821"><a href="#cb166-821" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`flights$tailnum`</span> é uma chave estrangeira que corresponde à chave primária <span class="in">`planes$tailnum`</span>.</span>
<span id="cb166-822"><a href="#cb166-822" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`flights$carrier`</span> é uma chave estrangeira que corresponde à chave primária <span class="in">`airlines$carrier`</span>.</span>
<span id="cb166-823"><a href="#cb166-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-824"><a href="#cb166-824" aria-hidden="true" tabindex="-1"></a>Podemos ver como cada banco de dados está relacionado com os demais na Figura abaixo.</span>
<span id="cb166-825"><a href="#cb166-825" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/ncyflights13.png)</span></span>
<span id="cb166-826"><a href="#cb166-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-827"><a href="#cb166-827" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A Tabela “flights” está vinculada à tabela “planes” por meio de uma variável única, “tailnum”.</span>
<span id="cb166-828"><a href="#cb166-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-829"><a href="#cb166-829" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A Tabela “flights” está vinculada à tabela “airlines” por meio de uma variável única, “carrier”.</span>
<span id="cb166-830"><a href="#cb166-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-831"><a href="#cb166-831" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A Tabela “flights” está vinculada à tabela “airports” de duas maneiras: por meio das variáveis “origin” e “dest”.</span>
<span id="cb166-832"><a href="#cb166-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-833"><a href="#cb166-833" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A Tabela “flights” está vinculada à tabela “weather” por meio das variáveis “origin” (localização), “year”, “month”, “day” e “hour”.</span>
<span id="cb166-834"><a href="#cb166-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-835"><a href="#cb166-835" aria-hidden="true" tabindex="-1"></a>Note que as chaves primárias e estrangeiras têm quase sempre os mesmos nomes, o que, como veremos em breve, tornará sua vida de junção muito mais fácil. Também vale a pena observar a relação oposta: quase todos os nomes de variáveis usados em várias tabelas têm o mesmo significado em cada lugar. Há apenas uma exceção: o ano (<span class="in">`year`</span>) significa o ano de partida nos voos (<span class="in">`flights`</span>) e o ano de fabricação nas aeronaves (<span class="in">`planes`</span>).</span>
<span id="cb166-836"><a href="#cb166-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-837"><a href="#cb166-837" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.2.2 Verificação de Chaves Primárias</span></span>
<span id="cb166-838"><a href="#cb166-838" aria-hidden="true" tabindex="-1"></a>Agora que identificamos as chaves primárias em cada tabela, é uma boa prática verificar se elas realmente identificam de forma única cada observação. Uma maneira de fazer isso é contar as chaves primárias e procurar entradas em que <span class="in">`n()`</span> seja maior que um.</span>
<span id="cb166-839"><a href="#cb166-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-840"><a href="#cb166-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-841"><a href="#cb166-841" aria-hidden="true" tabindex="-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb166-842"><a href="#cb166-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum) <span class="sc">%&gt;%</span></span>
<span id="cb166-843"><a href="#cb166-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb166-844"><a href="#cb166-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-845"><a href="#cb166-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-846"><a href="#cb166-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-847"><a href="#cb166-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-848"><a href="#cb166-848" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">%&gt;%</span></span>
<span id="cb166-849"><a href="#cb166-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(time_hour, origin) <span class="sc">%&gt;%</span></span>
<span id="cb166-850"><a href="#cb166-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb166-851"><a href="#cb166-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-852"><a href="#cb166-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-853"><a href="#cb166-853" aria-hidden="true" tabindex="-1"></a>Além de termos chave primária única, é importante que não haja valores faltantes, se um valor estiver ausente, ele não poderá identificar uma observação.</span>
<span id="cb166-854"><a href="#cb166-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-855"><a href="#cb166-855" aria-hidden="true" tabindex="-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb166-856"><a href="#cb166-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(tailnum))</span>
<span id="cb166-857"><a href="#cb166-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-858"><a href="#cb166-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-859"><a href="#cb166-859" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-860"><a href="#cb166-860" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">%&gt;%</span> </span>
<span id="cb166-861"><a href="#cb166-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(time_hour) <span class="sc">|</span> <span class="fu">is.na</span>(origin))</span>
<span id="cb166-862"><a href="#cb166-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-863"><a href="#cb166-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-864"><a href="#cb166-864" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.3 Combinando dados</span></span>
<span id="cb166-865"><a href="#cb166-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-866"><a href="#cb166-866" aria-hidden="true" tabindex="-1"></a>Bom, agora que compreendemos a importância de chaves vamos agora introdur dois tipos importantes de junções:</span>
<span id="cb166-867"><a href="#cb166-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-868"><a href="#cb166-868" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Junções mutacionais, que adicionam novas variáveis a um conjunto de dados a partir de observações correspondentes em outro banco de dados. São elas:</span>
<span id="cb166-869"><a href="#cb166-869" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`inner_join`</span>;</span>
<span id="cb166-870"><a href="#cb166-870" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`full_join`</span>;</span>
<span id="cb166-871"><a href="#cb166-871" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`left_join`</span>;</span>
<span id="cb166-872"><a href="#cb166-872" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`right_join`</span>.</span>
<span id="cb166-873"><a href="#cb166-873" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Junções de filtragem, que filtram observações de um quadro de dados com base em se elas correspondem ou não a uma observação em outro banco de dados.</span>
<span id="cb166-874"><a href="#cb166-874" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`semi_join()`</span>;</span>
<span id="cb166-875"><a href="#cb166-875" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`anti_join()`</span>.</span>
<span id="cb166-876"><a href="#cb166-876" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-877"><a href="#cb166-877" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.4 Junções Mutacionais</span></span>
<span id="cb166-878"><a href="#cb166-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-879"><a href="#cb166-879" aria-hidden="true" tabindex="-1"></a>Uma junção mutacional (*mutating join*) permite combinar **variáveis de dois conjuntos de dados**: primeiro, ele corresponde às observações através de suas chaves e, em seguida, copia as variáveis de um conjunto de dados para o outro. Assim como a função `mutate()`, as funções de `join` adicionam variáveis *à direita*, portanto, se o seu conjunto de dados tiver muitas variáveis, as novas variáveis não serão imediatamente visíveis. Para facilitar a compreensão dos exemplos a seguir, criaremos um conjunto de dados mais suscinto com apenas seis variáveis, e apenas com vôos com distância superior à 1000km:</span>
<span id="cb166-880"><a href="#cb166-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-881"><a href="#cb166-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-882"><a href="#cb166-882" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb166-883"><a href="#cb166-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(distance <span class="sc">&gt;</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-884"><a href="#cb166-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, time_hour, origin, dest, tailnum, carrier)</span>
<span id="cb166-885"><a href="#cb166-885" aria-hidden="true" tabindex="-1"></a>flights2</span>
<span id="cb166-886"><a href="#cb166-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-887"><a href="#cb166-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-888"><a href="#cb166-888" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.4.1 Left Join</span></span>
<span id="cb166-889"><a href="#cb166-889" aria-hidden="true" tabindex="-1"></a>O <span class="in">`left join`</span> retorna todas as linhas do primeiro conjunto de dados (tabela à esquerda) e as linhas correspondentes do segundo conjunto de dados (tabela à direita), se houver correspondência. Se não houver correspondência na tabela à direita, os valores serão preenchidos com <span class="in">`NA`</span> (valores ausentes).</span>
<span id="cb166-890"><a href="#cb166-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-891"><a href="#cb166-891" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/leftjoin.svg)</span></span>
<span id="cb166-892"><a href="#cb166-892" aria-hidden="true" tabindex="-1"></a>Suponha que gostariamos de adicionar o nome completo da companhia aerea no nosso banco de dados. Para isso, precisamos combinar as informações de <span class="in">`flights2`</span> com <span class="in">`airlines`</span>.</span>
<span id="cb166-893"><a href="#cb166-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-894"><a href="#cb166-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-895"><a href="#cb166-895" aria-hidden="true" tabindex="-1"></a>flights2_airlines <span class="ot">=</span> </span>
<span id="cb166-896"><a href="#cb166-896" aria-hidden="true" tabindex="-1"></a>  flights2  <span class="sc">%&gt;%</span> </span>
<span id="cb166-897"><a href="#cb166-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., airlines)</span>
<span id="cb166-898"><a href="#cb166-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-899"><a href="#cb166-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-900"><a href="#cb166-900" aria-hidden="true" tabindex="-1"></a>Note que, por definição, a função buscou a chave primária como <span class="in">`carrier`</span>. Nesse caso, como temos apenas uma chave, é viável fazermos isso. Contudo, é uma boa prática definirmos qual a chave que gostaríamos de combinar os bancos de dados.</span>
<span id="cb166-901"><a href="#cb166-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-902"><a href="#cb166-902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-903"><a href="#cb166-903" aria-hidden="true" tabindex="-1"></a>flights2_airlines <span class="ot">=</span> </span>
<span id="cb166-904"><a href="#cb166-904" aria-hidden="true" tabindex="-1"></a>  flights2  <span class="sc">%&gt;%</span> </span>
<span id="cb166-905"><a href="#cb166-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., airlines, </span>
<span id="cb166-906"><a href="#cb166-906" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"carrier"</span>)</span>
<span id="cb166-907"><a href="#cb166-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-908"><a href="#cb166-908" aria-hidden="true" tabindex="-1"></a>flights2_airlines</span>
<span id="cb166-909"><a href="#cb166-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-910"><a href="#cb166-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-911"><a href="#cb166-911" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.4.2 Right Join</span></span>
<span id="cb166-912"><a href="#cb166-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-913"><a href="#cb166-913" aria-hidden="true" tabindex="-1"></a>O <span class="in">`right_join`</span> retorna apenas as linhas do primeiro conjunto de dados (tabela à esquerda) se houver correspondência com o segundo conjunto de dados (tabela à direita). Se não houver correspondência na tabela à esquerda, os valores serão preenchidos com <span class="in">`NA`</span> (valores ausentes).</span>
<span id="cb166-914"><a href="#cb166-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-915"><a href="#cb166-915" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/righttjoin.svg)</span></span>
<span id="cb166-916"><a href="#cb166-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-917"><a href="#cb166-917" aria-hidden="true" tabindex="-1"></a>Suponha que, temos interesse em buscar informações acerca dos dos vôos realizados pelos aviões em <span class="in">`flights2`</span>. Para isso, basta unirmos as tabelas <span class="in">`planes`</span> com <span class="in">`flights2`</span>.</span>
<span id="cb166-918"><a href="#cb166-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-919"><a href="#cb166-919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-920"><a href="#cb166-920" aria-hidden="true" tabindex="-1"></a>planes_flights <span class="ot">=</span> flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-921"><a href="#cb166-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>)</span>
<span id="cb166-922"><a href="#cb166-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-923"><a href="#cb166-923" aria-hidden="true" tabindex="-1"></a>planes_flights</span>
<span id="cb166-924"><a href="#cb166-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-925"><a href="#cb166-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-926"><a href="#cb166-926" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.4.3 Inner Join</span></span>
<span id="cb166-927"><a href="#cb166-927" aria-hidden="true" tabindex="-1"></a>O <span class="in">`inner join`</span> retorna apenas as linhas que têm correspondências em ambos os conjuntos de dados. Ou seja, ele preserva apenas as observações com chaves correspondentes em ambas as tabelas.</span>
<span id="cb166-928"><a href="#cb166-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-929"><a href="#cb166-929" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/innerjoin.svg)</span></span>
<span id="cb166-930"><a href="#cb166-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-931"><a href="#cb166-931" aria-hidden="true" tabindex="-1"></a> Suponha que, temos interesse em buscar informações acerca dos aeroportos de origem realizados pelos aviões em <span class="in">`flights2`</span>. Porém, apenas temos interesse em informações que aparecem em ambos bancos. Para isso, basta unirmos as tabelas <span class="in">`flights2`</span> com <span class="in">`airports`</span>.</span>
<span id="cb166-932"><a href="#cb166-932" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb166-933"><a href="#cb166-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-934"><a href="#cb166-934" aria-hidden="true" tabindex="-1"></a>origin_flights <span class="ot">=</span> flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-935"><a href="#cb166-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span><span class="ot">=</span> <span class="st">"faa"</span>))</span>
<span id="cb166-936"><a href="#cb166-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-937"><a href="#cb166-937" aria-hidden="true" tabindex="-1"></a>origin_flights <span class="ot">=</span> flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-938"><a href="#cb166-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(airports, <span class="fu">join_by</span>(origin <span class="sc">==</span> faa))</span>
<span id="cb166-939"><a href="#cb166-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-940"><a href="#cb166-940" aria-hidden="true" tabindex="-1"></a>origin_flights</span>
<span id="cb166-941"><a href="#cb166-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-942"><a href="#cb166-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-943"><a href="#cb166-943" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.6.4.4 Full Join</span></span>
<span id="cb166-944"><a href="#cb166-944" aria-hidden="true" tabindex="-1"></a>O <span class="in">`full_join`</span> retorna todas as linhas de ambos os conjuntos de dados (tabelas à esquerda e à direita). Ele preenche com <span class="in">`NA`</span> aqueles valores que não têm correspondência em uma das tabelas.</span>
<span id="cb166-945"><a href="#cb166-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-946"><a href="#cb166-946" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/fulljoin.svg)</span></span>
<span id="cb166-947"><a href="#cb166-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-948"><a href="#cb166-948" aria-hidden="true" tabindex="-1"></a>Suponha que, temos interesse em buscar informações acerca dos aeroportos de destino realizados pelos aviões em <span class="in">`flights2`</span>. Porém, apenas temos interesse em todas informações que aparecem em ambos bancos. Para isso, basta unirmos as tabelas <span class="in">`flights2`</span> com <span class="in">`airports`</span>.</span>
<span id="cb166-949"><a href="#cb166-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-950"><a href="#cb166-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-951"><a href="#cb166-951" aria-hidden="true" tabindex="-1"></a>dest_flights <span class="ot">=</span> flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-952"><a href="#cb166-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span><span class="ot">=</span> <span class="st">"faa"</span>))</span>
<span id="cb166-953"><a href="#cb166-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-954"><a href="#cb166-954" aria-hidden="true" tabindex="-1"></a>dest_flights <span class="ot">=</span> flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-955"><a href="#cb166-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(airports, <span class="fu">join_by</span>(dest <span class="sc">==</span> faa))</span>
<span id="cb166-956"><a href="#cb166-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-957"><a href="#cb166-957" aria-hidden="true" tabindex="-1"></a>dest_flights</span>
<span id="cb166-958"><a href="#cb166-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-959"><a href="#cb166-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-960"><a href="#cb166-960" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6.5 Junções de Filtragem</span></span>
<span id="cb166-961"><a href="#cb166-961" aria-hidden="true" tabindex="-1"></a>Como o próprio nome sugere, a ação principal de uma junção de filtragem é filtrar as linhas. Existem dois tipos: semi-junções e anti-junções. Semi-junções mantêm todas as linhas em <span class="in">`x`</span> que têm uma correspondência em <span class="in">`y`</span>. Por exemplo, poderíamos usar uma semi-junção para filtrar o conjunto de dados de aeroportos (<span class="in">`airports`</span>) para mostrar apenas os aeroportos de origem:</span>
<span id="cb166-962"><a href="#cb166-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-963"><a href="#cb166-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-964"><a href="#cb166-964" aria-hidden="true" tabindex="-1"></a>airports <span class="sc">%&gt;%</span> </span>
<span id="cb166-965"><a href="#cb166-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(flights2, <span class="fu">join_by</span>(faa <span class="sc">==</span> origin))</span>
<span id="cb166-966"><a href="#cb166-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-967"><a href="#cb166-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-968"><a href="#cb166-968" aria-hidden="true" tabindex="-1"></a>Anti-junções são o oposto: elas retornam todas as linhas em <span class="in">`x`</span> que não têm correspondência em <span class="in">`y`</span>. São úteis para encontrar valores ausentes que são implícitos nos dados. Valores implicitamente ausentes não aparecem como NAs, mas sim existem apenas como uma ausência. Por exemplo, podemos encontrar linhas ausentes em aeroportos procurando voos que não tenham um aeroporto de destino correspondente:</span>
<span id="cb166-969"><a href="#cb166-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-970"><a href="#cb166-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-971"><a href="#cb166-971" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb166-972"><a href="#cb166-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(airports, <span class="fu">join_by</span>(dest <span class="sc">==</span> faa)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-973"><a href="#cb166-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(dest)</span>
<span id="cb166-974"><a href="#cb166-974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-975"><a href="#cb166-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-976"><a href="#cb166-976" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.7 Exercícios</span></span>
<span id="cb166-977"><a href="#cb166-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-978"><a href="#cb166-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-979"><a href="#cb166-979" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(nycflights13)</span>
<span id="cb166-980"><a href="#cb166-980" aria-hidden="true" tabindex="-1"></a>flights_voos <span class="ot">&lt;-</span> flights</span>
<span id="cb166-981"><a href="#cb166-981" aria-hidden="true" tabindex="-1"></a>flights_cias <span class="ot">&lt;-</span> airlines</span>
<span id="cb166-982"><a href="#cb166-982" aria-hidden="true" tabindex="-1"></a>flights_aeroportos <span class="ot">&lt;-</span> airports</span>
<span id="cb166-983"><a href="#cb166-983" aria-hidden="true" tabindex="-1"></a>flights_aviao <span class="ot">&lt;-</span> planes</span>
<span id="cb166-984"><a href="#cb166-984" aria-hidden="true" tabindex="-1"></a>flights_clima <span class="ot">&lt;-</span> weather</span>
<span id="cb166-985"><a href="#cb166-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-986"><a href="#cb166-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-987"><a href="#cb166-987" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Para vôos com atraso superior a 24 horas em <span class="in">`flights`</span>, verifique as condições climáticas em <span class="in">`weather`</span>. Há algum padrão? Quais os meses do ano em que você encontra os maiores atrasos?</span>
<span id="cb166-988"><a href="#cb166-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-989"><a href="#cb166-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-990"><a href="#cb166-990" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar os voos com atraso superior a 24 horas em "flights"</span></span>
<span id="cb166-991"><a href="#cb166-991" aria-hidden="true" tabindex="-1"></a>voos_atraso_24h <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb166-992"><a href="#cb166-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(arr_delay <span class="sc">&gt;</span> <span class="dv">12</span>)</span>
<span id="cb166-993"><a href="#cb166-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-994"><a href="#cb166-994" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntar os dados de clima de "weather" com os voos atrasados</span></span>
<span id="cb166-995"><a href="#cb166-995" aria-hidden="true" tabindex="-1"></a>voos_clima_atraso <span class="ot">&lt;-</span> voos_atraso_24h <span class="sc">%&gt;%</span></span>
<span id="cb166-996"><a href="#cb166-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(weather, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>))</span>
<span id="cb166-997"><a href="#cb166-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-998"><a href="#cb166-998" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar e calcular a contagem de voos atrasados por mês</span></span>
<span id="cb166-999"><a href="#cb166-999" aria-hidden="true" tabindex="-1"></a>contagem_atrasos_por_mes <span class="ot">&lt;-</span> voos_clima_atraso <span class="sc">%&gt;%</span></span>
<span id="cb166-1000"><a href="#cb166-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb166-1001"><a href="#cb166-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_atrasos =</span> <span class="fu">n</span>())</span>
<span id="cb166-1002"><a href="#cb166-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1003"><a href="#cb166-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir os meses com os maiores atrasos</span></span>
<span id="cb166-1004"><a href="#cb166-1004" aria-hidden="true" tabindex="-1"></a>meses_maior_atraso <span class="ot">&lt;-</span> contagem_atrasos_por_mes <span class="sc">%&gt;%</span></span>
<span id="cb166-1005"><a href="#cb166-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_atrasos)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1006"><a href="#cb166-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb166-1007"><a href="#cb166-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1008"><a href="#cb166-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir a tabela de frequência dos meses com os maiores atrasos</span></span>
<span id="cb166-1009"><a href="#cb166-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(meses_maior_atraso)</span>
<span id="cb166-1010"><a href="#cb166-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1011"><a href="#cb166-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1012"><a href="#cb166-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1013"><a href="#cb166-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Encontre os 20 destinos mais comuns e identifique seu aeroporto. Qual a temperatura média (mensal) em Celcius desses lugares? E a precipitação média, em cm?</span>
<span id="cb166-1014"><a href="#cb166-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-1015"><a href="#cb166-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertendo temperatura de °F para °C e polegadas para cm</span></span>
<span id="cb166-1016"><a href="#cb166-1016" aria-hidden="true" tabindex="-1"></a>flights_clima <span class="ot">&lt;-</span> flights_clima <span class="sc">%&gt;%</span></span>
<span id="cb166-1017"><a href="#cb166-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_celsius =</span> (temp <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">/</span> <span class="fl">1.8</span>,</span>
<span id="cb166-1018"><a href="#cb166-1018" aria-hidden="true" tabindex="-1"></a>         <span class="at">precip_cm =</span> precip <span class="sc">*</span> <span class="fl">2.54</span>)</span>
<span id="cb166-1019"><a href="#cb166-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1020"><a href="#cb166-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># Flitrando flight voos e identificando seu aeroporto</span></span>
<span id="cb166-1021"><a href="#cb166-1021" aria-hidden="true" tabindex="-1"></a>flights_destinos <span class="ot">&lt;-</span> flights_voos <span class="sc">%&gt;%</span></span>
<span id="cb166-1022"><a href="#cb166-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span><span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1023"><a href="#cb166-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, origin, name, time_hour)</span>
<span id="cb166-1024"><a href="#cb166-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1025"><a href="#cb166-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># Encontrando os 20 maiores destino, e media de temperatura e precipitação</span></span>
<span id="cb166-1026"><a href="#cb166-1026" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> flights_destinos <span class="sc">%&gt;%</span></span>
<span id="cb166-1027"><a href="#cb166-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., flights_clima) <span class="sc">%&gt;%</span></span>
<span id="cb166-1028"><a href="#cb166-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dest, origin, name, time_hour, temp_celsius, precip_cm) <span class="sc">%&gt;%</span></span>
<span id="cb166-1029"><a href="#cb166-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest, name) <span class="sc">%&gt;%</span></span>
<span id="cb166-1030"><a href="#cb166-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_temp =</span> <span class="fu">mean</span>(temp_celsius, <span class="at">na.rm =</span> T),</span>
<span id="cb166-1031"><a href="#cb166-1031" aria-hidden="true" tabindex="-1"></a>            <span class="at">media_precip =</span> <span class="fu">mean</span>(precip_cm, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1032"><a href="#cb166-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb166-1033"><a href="#cb166-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1034"><a href="#cb166-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo o resultado</span></span>
<span id="cb166-1035"><a href="#cb166-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(q2)</span>
<span id="cb166-1036"><a href="#cb166-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1037"><a href="#cb166-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1038"><a href="#cb166-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1039"><a href="#cb166-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1040"><a href="#cb166-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Inclua uma coluna com a cia aérea na tabela <span class="in">`planes`</span>. Quantas companhias áreas voaram cada avião naquele ano?</span>
<span id="cb166-1041"><a href="#cb166-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-1042"><a href="#cb166-1042" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrando voos de cada companhia aerea</span></span>
<span id="cb166-1043"><a href="#cb166-1043" aria-hidden="true" tabindex="-1"></a>flights_by_cia <span class="ot">&lt;-</span> flights_cias <span class="sc">%&gt;%</span></span>
<span id="cb166-1044"><a href="#cb166-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(flights_voos, <span class="at">by =</span> <span class="st">"carrier"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-1045"><a href="#cb166-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tailnum, carrier, name) <span class="sc">%&gt;%</span></span>
<span id="cb166-1046"><a href="#cb166-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_voos =</span> <span class="fu">n</span>())</span>
<span id="cb166-1047"><a href="#cb166-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1048"><a href="#cb166-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando se a filtragem está correta</span></span>
<span id="cb166-1049"><a href="#cb166-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(flights_by_cia<span class="sc">$</span>total_voos))</span>
<span id="cb166-1050"><a href="#cb166-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">nrow</span>(flights_voos))</span>
<span id="cb166-1051"><a href="#cb166-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1052"><a href="#cb166-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntando as informações das companhias aéreas com os aviões</span></span>
<span id="cb166-1053"><a href="#cb166-1053" aria-hidden="true" tabindex="-1"></a>planes_with_airlines <span class="ot">&lt;-</span> flights_aviao <span class="sc">%&gt;%</span></span>
<span id="cb166-1054"><a href="#cb166-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flights_by_cia, </span>
<span id="cb166-1055"><a href="#cb166-1055" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"tailnum"</span>)</span>
<span id="cb166-1056"><a href="#cb166-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1057"><a href="#cb166-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo o resultado</span></span>
<span id="cb166-1058"><a href="#cb166-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(planes_with_airlines)</span>
<span id="cb166-1059"><a href="#cb166-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1060"><a href="#cb166-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1061"><a href="#cb166-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1062"><a href="#cb166-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1063"><a href="#cb166-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1064"><a href="#cb166-1064" aria-hidden="true" tabindex="-1"></a>Inclua a latitude e longitude de cada origem destino na tabela <span class="in">`flights`</span>.</span>
<span id="cb166-1065"><a href="#cb166-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-1066"><a href="#cb166-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrando flights_aeroportos</span></span>
<span id="cb166-1067"><a href="#cb166-1067" aria-hidden="true" tabindex="-1"></a>flights_lat_long <span class="ot">&lt;-</span> <span class="fu">select</span>(flights_aeroportos, faa, lat, lon)</span>
<span id="cb166-1068"><a href="#cb166-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1069"><a href="#cb166-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Agora, vamos juntar as informações de latitude e longitude com a tabela "flights"</span></span>
<span id="cb166-1070"><a href="#cb166-1070" aria-hidden="true" tabindex="-1"></a>flights_coordinates <span class="ot">&lt;-</span> flights_voos <span class="sc">%&gt;%</span></span>
<span id="cb166-1071"><a href="#cb166-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(origin, dest) <span class="sc">%&gt;%</span></span>
<span id="cb166-1072"><a href="#cb166-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flights_lat_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1073"><a href="#cb166-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin_lat =</span> lat, <span class="at">origin_lon =</span> lon) <span class="sc">%&gt;%</span></span>
<span id="cb166-1074"><a href="#cb166-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flights_lat_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1075"><a href="#cb166-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dest_lat =</span> lat, <span class="at">dest_lon =</span> lon)</span>
<span id="cb166-1076"><a href="#cb166-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1077"><a href="#cb166-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir o resultado</span></span>
<span id="cb166-1078"><a href="#cb166-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(flights_coordinates)</span>
<span id="cb166-1079"><a href="#cb166-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1080"><a href="#cb166-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1081"><a href="#cb166-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1082"><a href="#cb166-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1083"><a href="#cb166-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.8 Organização de dados</span></span>
<span id="cb166-1084"><a href="#cb166-1084" aria-hidden="true" tabindex="-1"></a>Compreender a organização de dados é fundamental para análises estatísticas eficazes. Quando trabalhamos com dados em R, é importante seguir as regras que tornam um conjunto de dados *tidy* (organizado), o que facilita o processamento e a interpretação dos dados. Existem três regras inter-relacionadas que tornam um conjunto de dados *tidy*:</span>
<span id="cb166-1085"><a href="#cb166-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1086"><a href="#cb166-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Cada variável é uma coluna; cada coluna é uma variável**: Isso significa que cada característica ou medida que você está analisando deve ser representada por uma coluna separada no conjunto de dados.</span>
<span id="cb166-1087"><a href="#cb166-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1088"><a href="#cb166-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Por exemplo, se você estiver trabalhando com dados de pacientes, as variáveis como idade, gênero, altura e peso devem ser colunas separadas.</span>
<span id="cb166-1089"><a href="#cb166-1089" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1090"><a href="#cb166-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Cada observação é uma linha; cada linha é uma observação**: Cada linha do conjunto de dados deve representar uma única observação, caso ou instância. Isso garante que os dados estejam organizados de maneira que seja fácil identificar e comparar diferentes casos.</span>
<span id="cb166-1091"><a href="#cb166-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1092"><a href="#cb166-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Por exemplo, cada linha pode representar um paciente individual em um conjunto de dados médicos.</span>
<span id="cb166-1093"><a href="#cb166-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1094"><a href="#cb166-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Cada valor é uma célula; cada célula é um único valor**: Cada célula no conjunto de dados deve conter um único valor. Isso significa que não deve haver combinações de valores em uma única célula. Cada célula deve conter uma informação única e específica relacionada à variável e à observação correspondente.</span>
<span id="cb166-1095"><a href="#cb166-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1096"><a href="#cb166-1096" aria-hidden="true" tabindex="-1"></a>Ao seguir essas três regras, você cria um conjunto de dados tidy que é fácil de manipular, visualizar e analisar. Essa organização facilita a utilização de funções como <span class="in">`pivot_longer`</span> e <span class="in">`pivot_wider`</span> para remodelar os dados quando necessário a fim de adaptá-los às necessidades de sua análise estatística em R</span>
<span id="cb166-1097"><a href="#cb166-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1098"><a href="#cb166-1098" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/tidy_data.svg)</span></span>
<span id="cb166-1099"><a href="#cb166-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1100"><a href="#cb166-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8.1 Pivotagem</span></span>
<span id="cb166-1101"><a href="#cb166-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1102"><a href="#cb166-1102" aria-hidden="true" tabindex="-1"></a>Pivotar, como o próprio nome sugere, é um processo de transformação de um conjunto de dados, no qual as colunas e linhas são reorganizadas de tal forma que os valores que originalmente estavam dispostos em linhas agora são apresentados como colunas, e vice-versa. Esse procedimento é fundamental para preparar e organizar dados para análises estatísticas e visualizações mais eficazes.</span>
<span id="cb166-1103"><a href="#cb166-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1104"><a href="#cb166-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.8.1.1 Formato Wide (Largo) e Formato Long (Longo)</span></span>
<span id="cb166-1105"><a href="#cb166-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1106"><a href="#cb166-1106" aria-hidden="true" tabindex="-1"></a>Em ciência de dados, é comum falarmos em dois formatos principais: o formato *wide* (largo) e o formato *long* (longo). Essas representações são especialmente úteis para diferentes tipos de análises e visualizações.</span>
<span id="cb166-1107"><a href="#cb166-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1108"><a href="#cb166-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Formato Wide (Largo)**: Nesse formato, os dados são organizados de forma que cada variável é representada por uma coluna separada e cada observação (ou instância) ocupa uma única linha. Isso significa que as informações são distribuídas em várias colunas, tornando-o mais adequado para conjuntos de dados com poucas variáveis, onde as informações são bem condensadas.</span>
<span id="cb166-1109"><a href="#cb166-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1110"><a href="#cb166-1110" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/tidy_data.svg)</span></span>
<span id="cb166-1111"><a href="#cb166-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1112"><a href="#cb166-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Formato Long (Longo)**: Já no formato long (ou longo), os dados são organizados de maneira que as variáveis estão empilhadas em uma única coluna, enquanto uma coluna adicional é usada para indicar o nome da variável. Cada observação é representada por uma linha separada. Esse formato é ideal quando se trabalha com conjuntos de dados mais complexos, nos quais as informações estão espalhadas em várias categorias ou momentos de tempo, por exemplo.</span>
<span id="cb166-1113"><a href="#cb166-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1114"><a href="#cb166-1114" aria-hidden="true" tabindex="-1"></a><span class="al">![Descrição da Imagem](./imagens/long_data.svg)</span></span>
<span id="cb166-1115"><a href="#cb166-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1116"><a href="#cb166-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8.2 Exercício</span></span>
<span id="cb166-1117"><a href="#cb166-1117" aria-hidden="true" tabindex="-1"></a>Com os dois conjuntos de dados abaixo, defina qual a versão *organizada* dos dados.</span>
<span id="cb166-1118"><a href="#cb166-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1119"><a href="#cb166-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Conjunto 1:**</span>
<span id="cb166-1120"><a href="#cb166-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1121"><a href="#cb166-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Wide**:</span>
<span id="cb166-1122"><a href="#cb166-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1123"><a href="#cb166-1123" aria-hidden="true" tabindex="-1"></a>|Nome     |Idade|Peso (kg)|Gênero   |</span>
<span id="cb166-1124"><a href="#cb166-1124" aria-hidden="true" tabindex="-1"></a>|---------|-----|---------|---------|</span>
<span id="cb166-1125"><a href="#cb166-1125" aria-hidden="true" tabindex="-1"></a>|Alice    |34   |52.16    |Feminino |</span>
<span id="cb166-1126"><a href="#cb166-1126" aria-hidden="true" tabindex="-1"></a>|Bob      |35   |72.57    |Masculino|</span>
<span id="cb166-1127"><a href="#cb166-1127" aria-hidden="true" tabindex="-1"></a>|Christine|38   |56.70    |Feminino |</span>
<span id="cb166-1128"><a href="#cb166-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1129"><a href="#cb166-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Long**:</span>
<span id="cb166-1130"><a href="#cb166-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1131"><a href="#cb166-1131" aria-hidden="true" tabindex="-1"></a>|Nome     |Variável |Valor     |</span>
<span id="cb166-1132"><a href="#cb166-1132" aria-hidden="true" tabindex="-1"></a>|---------|---------|----------|</span>
<span id="cb166-1133"><a href="#cb166-1133" aria-hidden="true" tabindex="-1"></a>|Alice    |Idade    |34        |</span>
<span id="cb166-1134"><a href="#cb166-1134" aria-hidden="true" tabindex="-1"></a>|Alice    |Peso (kg)|52.16     |</span>
<span id="cb166-1135"><a href="#cb166-1135" aria-hidden="true" tabindex="-1"></a>|Alice    |Gênero   |Feminino  |</span>
<span id="cb166-1136"><a href="#cb166-1136" aria-hidden="true" tabindex="-1"></a>|Bob      |Idade    |35        |</span>
<span id="cb166-1137"><a href="#cb166-1137" aria-hidden="true" tabindex="-1"></a>|Bob      |Peso (kg)|72.57     |</span>
<span id="cb166-1138"><a href="#cb166-1138" aria-hidden="true" tabindex="-1"></a>|Bob      |Gênero   |Masculino |</span>
<span id="cb166-1139"><a href="#cb166-1139" aria-hidden="true" tabindex="-1"></a>|Christine|Idade    |38        |</span>
<span id="cb166-1140"><a href="#cb166-1140" aria-hidden="true" tabindex="-1"></a>|Christine|Peso (kg)|56.70     |</span>
<span id="cb166-1141"><a href="#cb166-1141" aria-hidden="true" tabindex="-1"></a>|Christine|Gênero   |Feminino  |</span>
<span id="cb166-1142"><a href="#cb166-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1143"><a href="#cb166-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Conjunto 2:**</span>
<span id="cb166-1144"><a href="#cb166-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1145"><a href="#cb166-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Wide**:</span>
<span id="cb166-1146"><a href="#cb166-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1147"><a href="#cb166-1147" aria-hidden="true" tabindex="-1"></a>|Tamanho da Pedra |Tratamento A - Recuperados|Tratamento A - Falhas|Tratamento B - Recuperados|Tratamento B - Falhas|</span>
<span id="cb166-1148"><a href="#cb166-1148" aria-hidden="true" tabindex="-1"></a>|-----------------|--------------------------|---------------------|--------------------------|---------------------|</span>
<span id="cb166-1149"><a href="#cb166-1149" aria-hidden="true" tabindex="-1"></a>|Pequeno          |81                        |6                    |234                       |36                   |</span>
<span id="cb166-1150"><a href="#cb166-1150" aria-hidden="true" tabindex="-1"></a>|Grande           |192                       |71                   |55                        |25                   |</span>
<span id="cb166-1151"><a href="#cb166-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1152"><a href="#cb166-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Long**:</span>
<span id="cb166-1153"><a href="#cb166-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1154"><a href="#cb166-1154" aria-hidden="true" tabindex="-1"></a>|Tamanho da Pedra   |Tratamento   |Recuperado |Falha  |</span>
<span id="cb166-1155"><a href="#cb166-1155" aria-hidden="true" tabindex="-1"></a>|-------------------|-------------|-----------|-------|</span>
<span id="cb166-1156"><a href="#cb166-1156" aria-hidden="true" tabindex="-1"></a>|Pequena            |A            |81         |6      |</span>
<span id="cb166-1157"><a href="#cb166-1157" aria-hidden="true" tabindex="-1"></a>|Pequena            |B            |234        |36     |</span>
<span id="cb166-1158"><a href="#cb166-1158" aria-hidden="true" tabindex="-1"></a>|Grande             |A            |192        |71     |</span>
<span id="cb166-1159"><a href="#cb166-1159" aria-hidden="true" tabindex="-1"></a>|Grande             |B            |55         |25     |</span>
<span id="cb166-1160"><a href="#cb166-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1161"><a href="#cb166-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8.2 Pivotando dados em R</span></span>
<span id="cb166-1162"><a href="#cb166-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1163"><a href="#cb166-1163" aria-hidden="true" tabindex="-1"></a>Para aprendermos sobre os tipos de *pivot* em R, vamos utilizar o banco de dados <span class="in">`table1`</span>. Esse banco de dados possui dados de casos reportados de Tuberculose e o tamanho da população em dois anos para três países. Esses dados são provenientes dos dados <span class="in">`who`</span>.</span>
<span id="cb166-1164"><a href="#cb166-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1165"><a href="#cb166-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-1166"><a href="#cb166-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyr)</span>
<span id="cb166-1167"><a href="#cb166-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr)</span>
<span id="cb166-1168"><a href="#cb166-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dplyr)</span>
<span id="cb166-1169"><a href="#cb166-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1170"><a href="#cb166-1170" aria-hidden="true" tabindex="-1"></a>table1</span>
<span id="cb166-1171"><a href="#cb166-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1172"><a href="#cb166-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1173"><a href="#cb166-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1174"><a href="#cb166-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.8.2.1 `pivot_wider`</span></span>
<span id="cb166-1175"><a href="#cb166-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1176"><a href="#cb166-1176" aria-hidden="true" tabindex="-1"></a>A função <span class="in">`pivot_wider`</span> é usada para transformar um conjunto de dados de um formato longo para um formato largo. Isso é útil quando temos informações em uma única coluna que desejamos espalhar em várias colunas.</span>
<span id="cb166-1177"><a href="#cb166-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1178"><a href="#cb166-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Sintaxe:**</span>
<span id="cb166-1179"><a href="#cb166-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1180"><a href="#cb166-1180" aria-hidden="true" tabindex="-1"></a><span class="in">`pivot_wider(data, names_from, values_from)`</span> - <span class="in">`data`</span>: O conjunto de dados que você deseja transformar. - <span class="in">`names_from`</span>: A coluna que contém os nomes das variáveis que você deseja espalhar. - <span class="in">`values_from`</span>: A coluna que contém os valores correspondentes a essas variáveis.</span>
<span id="cb166-1181"><a href="#cb166-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1182"><a href="#cb166-1182" aria-hidden="true" tabindex="-1"></a>**Exemplo**: Transformando em dados de <span class="in">`table1`</span> em wide.</span>
<span id="cb166-1183"><a href="#cb166-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1184"><a href="#cb166-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Suponha que queremos o número de casos por ano.</span>
<span id="cb166-1185"><a href="#cb166-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1188"><a href="#cb166-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1189"><a href="#cb166-1189" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1190"><a href="#cb166-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, cases) <span class="sc">%&gt;%</span> </span>
<span id="cb166-1191"><a href="#cb166-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> cases)</span>
<span id="cb166-1192"><a href="#cb166-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1193"><a href="#cb166-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1194"><a href="#cb166-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.8.2.2 `pivot_longer` </span></span>
<span id="cb166-1195"><a href="#cb166-1195" aria-hidden="true" tabindex="-1"></a>A função pivot_longer é utilizada para transformar um conjunto de dados de um formato largo (wide) para um formato longo (long). Isso é útil quando temos variáveis espalhadas em várias colunas e desejamos organizar esses dados em uma única coluna, tornando-os mais adequados para análises e visualizações. Geralmente, usamos <span class="in">`pivot_longer`</span> quando temos variáveis empilhadas em diferentes colunas e queremos reunir essas informações em uma única coluna.</span>
<span id="cb166-1196"><a href="#cb166-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1197"><a href="#cb166-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Sintaxe:** <span class="in">`pivot_longer(data, cols, names_to, values_to)`</span></span>
<span id="cb166-1198"><a href="#cb166-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`data`</span>: O conjunto de dados que você deseja transformar.</span>
<span id="cb166-1199"><a href="#cb166-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`cols`</span>: As colunas que você deseja empilhar no formato longo.</span>
<span id="cb166-1200"><a href="#cb166-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`names_to`</span>: O nome da nova coluna que irá conter os nomes das variáveis empilhadas.</span>
<span id="cb166-1201"><a href="#cb166-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`values_to`</span>: O nome da nova coluna que irá conter os valores das variáveis empilhadas.</span>
<span id="cb166-1202"><a href="#cb166-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1203"><a href="#cb166-1203" aria-hidden="true" tabindex="-1"></a>**Exemplo**: Transformando em dados de <span class="in">`table1`</span> em long.</span>
<span id="cb166-1204"><a href="#cb166-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1205"><a href="#cb166-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Suponha que queremos os casos e o tamanho da população como uma variável.</span>
<span id="cb166-1206"><a href="#cb166-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1209"><a href="#cb166-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1210"><a href="#cb166-1210" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1211"><a href="#cb166-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(country, year), </span>
<span id="cb166-1212"><a href="#cb166-1212" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"variavel"</span>, </span>
<span id="cb166-1213"><a href="#cb166-1213" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"tamanho"</span>)</span>
<span id="cb166-1214"><a href="#cb166-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1215"><a href="#cb166-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1216"><a href="#cb166-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.8.2.3 Separando observações</span></span>
<span id="cb166-1217"><a href="#cb166-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1218"><a href="#cb166-1218" aria-hidden="true" tabindex="-1"></a>A função separate() divide uma única coluna em várias colunas, dividindo-a sempre que um caractere separador aparece. Vamos considerar o exemplo da <span class="in">`table3`</span>:</span>
<span id="cb166-1219"><a href="#cb166-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1222"><a href="#cb166-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1223"><a href="#cb166-1223" aria-hidden="true" tabindex="-1"></a>table3</span>
<span id="cb166-1224"><a href="#cb166-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1225"><a href="#cb166-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1226"><a href="#cb166-1226" aria-hidden="true" tabindex="-1"></a>Note que a coluna <span class="in">`rate`</span> é na verdade uma coluna onde temos os casos e a população separadas por “/”. Podemos separar essa coluna em duas utilizando a função separate.</span>
<span id="cb166-1227"><a href="#cb166-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1230"><a href="#cb166-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1231"><a href="#cb166-1231" aria-hidden="true" tabindex="-1"></a>separated <span class="ot">=</span> table3 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1232"><a href="#cb166-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"population"</span>))</span>
<span id="cb166-1233"><a href="#cb166-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1234"><a href="#cb166-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1235"><a href="#cb166-1235" aria-hidden="true" tabindex="-1"></a>Caso tenhamos interesse em uni-las novamente, podemos utilizar a função <span class="in">`unite`</span>.</span>
<span id="cb166-1236"><a href="#cb166-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1239"><a href="#cb166-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1240"><a href="#cb166-1240" aria-hidden="true" tabindex="-1"></a>separated <span class="sc">%&gt;%</span> </span>
<span id="cb166-1241"><a href="#cb166-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(rate, cases, population, <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb166-1242"><a href="#cb166-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1243"><a href="#cb166-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1244"><a href="#cb166-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8.3 Exemplo</span></span>
<span id="cb166-1245"><a href="#cb166-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1246"><a href="#cb166-1246" aria-hidden="true" tabindex="-1"></a>Vamos utilizar os dados de notificações de casos provenientes do site do <span class="co">[</span><span class="ot">WHO</span><span class="co">](https://www.who.int/teams/global-tuberculosis-programme/data)</span>.</span>
<span id="cb166-1247"><a href="#cb166-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1250"><a href="#cb166-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1251"><a href="#cb166-1251" aria-hidden="true" tabindex="-1"></a>TB <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"./datasets/TB.csv.gz"</span>)</span>
<span id="cb166-1252"><a href="#cb166-1252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1253"><a href="#cb166-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1254"><a href="#cb166-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1255"><a href="#cb166-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1256"><a href="#cb166-1256" aria-hidden="true" tabindex="-1"></a>Este conjunto de dados exemplifica uma situação comum na vida real, onde os dados estão desorganizados e não estão em um formato adequado para análises. Ele apresenta colunas redundantes, códigos de variáveis incomuns e uma abundância de valores ausentes. Em suma, está em uma condição “bagunçada” e precisaremos de várias etapas para limpá-lo e organizá-lo de forma apropriada. Assim como o pacote <span class="in">`dplyr`</span>, o <span class="in">`tidyr`</span> foi projetado para que cada função tenha uma função específica e bem definida. Isso significa que, em cenários da vida real, você geralmente precisará encadear várias dessas funções em uma sequência lógica para obter os dados em um estado utilizável.</span>
<span id="cb166-1257"><a href="#cb166-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1258"><a href="#cb166-1258" aria-hidden="true" tabindex="-1"></a>O ponto de partida mais eficaz geralmente é reunir as colunas que não são consideradas variáveis. Vamos examinar o que temos:</span>
<span id="cb166-1259"><a href="#cb166-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1260"><a href="#cb166-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Country (país), iso2 e iso3**: Essas três colunas parecem redundantes e especificam o país de formas diferentes. Variável redundante.</span>
<span id="cb166-1261"><a href="#cb166-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1262"><a href="#cb166-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Year (ano)**: É claramente uma variável que representa o ano em que os dados foram registrados.</span>
<span id="cb166-1263"><a href="#cb166-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1264"><a href="#cb166-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Outras Colunas Não Identificadas**: As colunas restantes, como “new_sp_m014”, “new_ep_m014” e “new_ep_f014”, não sabemos o que representam ainda. De acordo com a estrutura dos nomes das colunas, elas provavelmente contêm valores, não são variáveis.</span>
<span id="cb166-1265"><a href="#cb166-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1266"><a href="#cb166-1266" aria-hidden="true" tabindex="-1"></a>Portanto, nossa primeira tarefa é agrupar todas as colunas, desde “new_sp_m014” até “newrel_f65”, porque ainda não compreendemos completamente o que essas colunas representam. Chamaremos essa variável genérica de “chave”. Além disso, sabemos que as células dessas colunas representam a contagem de casos, então criaremos uma variável chamada “casos” para armazenar esses valores.</span>
<span id="cb166-1267"><a href="#cb166-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1268"><a href="#cb166-1268" aria-hidden="true" tabindex="-1"></a>É importante observar que há muitos valores ausentes nos dados atuais. Para facilitar a análise inicial, usaremos a função “values_drop_na” para nos concentrarmos apenas nos valores que estão presentes, deixando os valores ausentes de lado temporariamente.</span>
<span id="cb166-1269"><a href="#cb166-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1270"><a href="#cb166-1270" aria-hidden="true" tabindex="-1"></a>Dessa forma, estaremos prontos para começar o processo de organização e limpeza desses dados desorganizados.</span>
<span id="cb166-1271"><a href="#cb166-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1274"><a href="#cb166-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1275"><a href="#cb166-1275" aria-hidden="true" tabindex="-1"></a>TB1 <span class="ot">&lt;-</span> TB <span class="sc">%&gt;%</span> </span>
<span id="cb166-1276"><a href="#cb166-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb166-1277"><a href="#cb166-1277" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb166-1278"><a href="#cb166-1278" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"chave"</span>, </span>
<span id="cb166-1279"><a href="#cb166-1279" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"casos"</span>, </span>
<span id="cb166-1280"><a href="#cb166-1280" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span></span>
<span id="cb166-1281"><a href="#cb166-1281" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb166-1282"><a href="#cb166-1282" aria-hidden="true" tabindex="-1"></a>TB1</span>
<span id="cb166-1283"><a href="#cb166-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1284"><a href="#cb166-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1285"><a href="#cb166-1285" aria-hidden="true" tabindex="-1"></a>Para tentarmos entender a estrutura de chave, vamos contar ela.</span>
<span id="cb166-1286"><a href="#cb166-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1289"><a href="#cb166-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1290"><a href="#cb166-1290" aria-hidden="true" tabindex="-1"></a>TB1 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1291"><a href="#cb166-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(chave)</span>
<span id="cb166-1292"><a href="#cb166-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1293"><a href="#cb166-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1294"><a href="#cb166-1294" aria-hidden="true" tabindex="-1"></a>Se olharmos o dicionário de variáveis, presente junto aos dados, estamos interessados nos casos, ou seja, nas variáveis descritas por <span class="in">`new`</span>. Vamos então, filtrar nossos dados para manter apenas essas variáveis.</span>
<span id="cb166-1295"><a href="#cb166-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1298"><a href="#cb166-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1299"><a href="#cb166-1299" aria-hidden="true" tabindex="-1"></a>TB1 <span class="sc">%&lt;&gt;%</span> <span class="fu">filter</span>(chave <span class="sc">%like%</span> <span class="st">"^new"</span>)</span>
<span id="cb166-1300"><a href="#cb166-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1301"><a href="#cb166-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1302"><a href="#cb166-1302" aria-hidden="true" tabindex="-1"></a>Além disso, o dicionário das variáveis nos informa o seguinte:</span>
<span id="cb166-1303"><a href="#cb166-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1304"><a href="#cb166-1304" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>As três primeiras letras de cada coluna indicam se a coluna contém casos novos (new) ou antigos (old) de tuberculose.</span>
<span id="cb166-1305"><a href="#cb166-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1306"><a href="#cb166-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>As letras seguintes descrevem o tipo de tuberculose:</span>
<span id="cb166-1307"><a href="#cb166-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1308"><a href="#cb166-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“rel” indica casos de recaída.</span>
<span id="cb166-1309"><a href="#cb166-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1310"><a href="#cb166-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“ep” indica casos de tuberculose extrapulmonar.</span>
<span id="cb166-1311"><a href="#cb166-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1312"><a href="#cb166-1312" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“sn” indica casos de tuberculose pulmonar que não puderam ser diagnosticados por esfregaço pulmonar (*smear negative*).</span>
<span id="cb166-1313"><a href="#cb166-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1314"><a href="#cb166-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“sp” indica casos de tuberculose pulmonar que puderam ser diagnosticados por esfregaço pulmonar (*smear positive*).</span>
<span id="cb166-1315"><a href="#cb166-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1316"><a href="#cb166-1316" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A sexta letra indica o sexo dos pacientes com tuberculose, sendo “m” para masculino e “f” para feminino.</span>
<span id="cb166-1317"><a href="#cb166-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1318"><a href="#cb166-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Os números restantes representam os grupos etários. O conjunto de dados agrupa os casos em sete faixas etárias:</span>
<span id="cb166-1319"><a href="#cb166-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1320"><a href="#cb166-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“014” = 0 a 14 anos</span>
<span id="cb166-1321"><a href="#cb166-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1322"><a href="#cb166-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“1524” = 15 a 24 anos</span>
<span id="cb166-1323"><a href="#cb166-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1324"><a href="#cb166-1324" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“2534” = 25 a 34 anos</span>
<span id="cb166-1325"><a href="#cb166-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1326"><a href="#cb166-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“3544” = 35 a 44 anos</span>
<span id="cb166-1327"><a href="#cb166-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1328"><a href="#cb166-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“4554” = 45 a 54 anos</span>
<span id="cb166-1329"><a href="#cb166-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1330"><a href="#cb166-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“5564” = 55 a 64 anos</span>
<span id="cb166-1331"><a href="#cb166-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1332"><a href="#cb166-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>“65” = 65 anos ou mais</span>
<span id="cb166-1333"><a href="#cb166-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1334"><a href="#cb166-1334" aria-hidden="true" tabindex="-1"></a>Para tornar o formato dos nomes das colunas mais consistente, é necessário fazer um pequeno ajuste: infelizmente, os nomes estão ligeiramente inconsistentes, pois em vez de “new_rel”, temos “newrel”. Para isso, vamos utilizar a função <span class="in">`str_replace()`</span>, a ideia básica é simples: substituir os caracteres “newrel” por “new_rel”. Isso tornará todos os nomes das variáveis consistentes.</span>
<span id="cb166-1335"><a href="#cb166-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1338"><a href="#cb166-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1339"><a href="#cb166-1339" aria-hidden="true" tabindex="-1"></a>TB2 <span class="ot">&lt;-</span> TB1 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1340"><a href="#cb166-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chave =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(chave, <span class="st">"newrel"</span>, <span class="st">"new_rel"</span>))</span>
<span id="cb166-1341"><a href="#cb166-1341" aria-hidden="true" tabindex="-1"></a>TB2</span>
<span id="cb166-1342"><a href="#cb166-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1343"><a href="#cb166-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1344"><a href="#cb166-1344" aria-hidden="true" tabindex="-1"></a>Podemos separar os valores em cada código usando duas etapas da função <span class="in">`separate()`</span>. A primeira etapa dividirá os códigos em cada sublinhado (underscore).</span>
<span id="cb166-1345"><a href="#cb166-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1348"><a href="#cb166-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1349"><a href="#cb166-1349" aria-hidden="true" tabindex="-1"></a>TB3 <span class="ot">&lt;-</span> TB2 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1350"><a href="#cb166-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(chave, <span class="fu">c</span>(<span class="st">"new"</span>, <span class="st">"type"</span>, <span class="st">"sexage"</span>), </span>
<span id="cb166-1351"><a href="#cb166-1351" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb166-1352"><a href="#cb166-1352" aria-hidden="true" tabindex="-1"></a>TB3</span>
<span id="cb166-1353"><a href="#cb166-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1354"><a href="#cb166-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1355"><a href="#cb166-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1356"><a href="#cb166-1356" aria-hidden="true" tabindex="-1"></a>Nesse caso, podemos eliminar a nova coluna, já que ela é constante em todo o conjunto de dados. Além disso, como mencionado anteriormente, as colunas “iso2” e “iso3” são redundantes e podem ser removidas. A eliminação de colunas não essenciais ajuda a simplificar o conjunto de dados e a economizar espaço de armazenamento.</span>
<span id="cb166-1357"><a href="#cb166-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1360"><a href="#cb166-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1361"><a href="#cb166-1361" aria-hidden="true" tabindex="-1"></a>TB4 <span class="ot">&lt;-</span> TB3 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1362"><a href="#cb166-1362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>new, <span class="sc">-</span>iso2, <span class="sc">-</span>iso3)</span>
<span id="cb166-1363"><a href="#cb166-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1364"><a href="#cb166-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1365"><a href="#cb166-1365" aria-hidden="true" tabindex="-1"></a>Agora podemos separar o sexo e a idade.</span>
<span id="cb166-1366"><a href="#cb166-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1369"><a href="#cb166-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1370"><a href="#cb166-1370" aria-hidden="true" tabindex="-1"></a>TB5 <span class="ot">&lt;-</span> TB4 <span class="sc">%&gt;%</span> </span>
<span id="cb166-1371"><a href="#cb166-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sexage, <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"idade"</span>), <span class="at">sep =</span> <span class="dv">1</span>)</span>
<span id="cb166-1372"><a href="#cb166-1372" aria-hidden="true" tabindex="-1"></a>TB5</span>
<span id="cb166-1373"><a href="#cb166-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1374"><a href="#cb166-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1375"><a href="#cb166-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8.4 Exercícios</span></span>
<span id="cb166-1376"><a href="#cb166-1376" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Utilizando os dados de TB5, crie uma tabela em formato wide, com a quantidade de casos por país por ano. Cada ano deve ser chamado “Ano_.</span>
<span id="cb166-1377"><a href="#cb166-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb166-1378"><a href="#cb166-1378" aria-hidden="true" tabindex="-1"></a>TB6 <span class="ot">&lt;-</span> TB5 <span class="sc">%&gt;%</span></span>
<span id="cb166-1379"><a href="#cb166-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, </span>
<span id="cb166-1380"><a href="#cb166-1380" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> casos,</span>
<span id="cb166-1381"><a href="#cb166-1381" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"Ano_"</span>)</span>
<span id="cb166-1382"><a href="#cb166-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1383"><a href="#cb166-1383" aria-hidden="true" tabindex="-1"></a>TB6</span>
<span id="cb166-1384"><a href="#cb166-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1385"><a href="#cb166-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1386"><a href="#cb166-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1387"><a href="#cb166-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Utilizando os dados de TB5, crie uma tabela em formato wide, com a quantidade de casos por país, ano, idade e sexo.</span>
<span id="cb166-1388"><a href="#cb166-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Dica: Utilize o argumento <span class="in">`values_fn`</span> da função.</span>
<span id="cb166-1389"><a href="#cb166-1389" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1390"><a href="#cb166-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Volte o banco criado em 1 e 2 para o formato <span class="in">`long`</span>.</span>
<span id="cb166-1391"><a href="#cb166-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1392"><a href="#cb166-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1393"><a href="#cb166-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.9 Strings</span></span>
<span id="cb166-1394"><a href="#cb166-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1395"><a href="#cb166-1395" aria-hidden="true" tabindex="-1"></a>No <span class="co">[</span><span class="ot">Capítulo 2</span><span class="co">](https://gysi.quarto.pub/ce302/chapters/02_basicR.html)</span> vimos como criar a fazer manipulações simples em *strings*. Agora vamos aprofundar nossos conhecimentos em manipulação de *strings*. Para trabalharmos com strings em R, podemos utilizar diversos pacotes, como o <span class="in">`base`</span>, <span class="in">`stringr`</span> e <span class="in">`stringi`</span> . Nas aulas introdutórias focamos apenas nas funções do <span class="in">`base`</span>, agora vamos focar nas funções do stringr. As funções do pacote <span class="in">`stringr`</span> são, na sua maioria, wrappers das funções implementadas no <span class="in">`stringi`</span> .</span>
<span id="cb166-1396"><a href="#cb166-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1397"><a href="#cb166-1397" aria-hidden="true" tabindex="-1"></a>Strings são objetos (ou variáveis) do tipo texto, e são delimitadas por aspas (duplas ou simples).</span>
<span id="cb166-1398"><a href="#cb166-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1401"><a href="#cb166-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1402"><a href="#cb166-1402" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb166-1403"><a href="#cb166-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1404"><a href="#cb166-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1407"><a href="#cb166-1407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1408"><a href="#cb166-1408" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr)</span>
<span id="cb166-1409"><a href="#cb166-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1410"><a href="#cb166-1410" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">"Seu nome aqui"</span></span>
<span id="cb166-1411"><a href="#cb166-1411" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">'Seu nome aqui'</span></span>
<span id="cb166-1412"><a href="#cb166-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1413"><a href="#cb166-1413" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> y</span>
<span id="cb166-1414"><a href="#cb166-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1415"><a href="#cb166-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1416"><a href="#cb166-1416" aria-hidden="true" tabindex="-1"></a>Caso eu tenha interesse em criar uma string que contenha aspas, podemos cria-la da seguinte maneira:</span>
<span id="cb166-1417"><a href="#cb166-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1420"><a href="#cb166-1420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1421"><a href="#cb166-1421" aria-hidden="true" tabindex="-1"></a>var_com_aspas <span class="ot">&lt;-</span> <span class="st">"Ela disse: 'Eu adoro lasanha.'"</span></span>
<span id="cb166-1422"><a href="#cb166-1422" aria-hidden="true" tabindex="-1"></a>var_com_aspas</span>
<span id="cb166-1423"><a href="#cb166-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1424"><a href="#cb166-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1427"><a href="#cb166-1427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1428"><a href="#cb166-1428" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(var_com_aspas)</span>
<span id="cb166-1429"><a href="#cb166-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1430"><a href="#cb166-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1433"><a href="#cb166-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1434"><a href="#cb166-1434" aria-hidden="true" tabindex="-1"></a>var_com_aspas2 <span class="ot">&lt;-</span> <span class="st">'Ela disse: "Eu adoro lasanha."'</span></span>
<span id="cb166-1435"><a href="#cb166-1435" aria-hidden="true" tabindex="-1"></a>var_com_aspas2</span>
<span id="cb166-1436"><a href="#cb166-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1437"><a href="#cb166-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1440"><a href="#cb166-1440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1441"><a href="#cb166-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(var_com_aspas2)</span>
<span id="cb166-1442"><a href="#cb166-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1443"><a href="#cb166-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1446"><a href="#cb166-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1447"><a href="#cb166-1447" aria-hidden="true" tabindex="-1"></a>var_com_aspas3 <span class="ot">&lt;-</span> <span class="st">"Ela disse: </span><span class="sc">\"</span><span class="st">Eu adoro lasanha.</span><span class="sc">\"</span><span class="st">"</span></span>
<span id="cb166-1448"><a href="#cb166-1448" aria-hidden="true" tabindex="-1"></a>var_com_aspas3</span>
<span id="cb166-1449"><a href="#cb166-1449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1450"><a href="#cb166-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1451"><a href="#cb166-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1454"><a href="#cb166-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1455"><a href="#cb166-1455" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(var_com_aspas3)</span>
<span id="cb166-1456"><a href="#cb166-1456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1457"><a href="#cb166-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1460"><a href="#cb166-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1461"><a href="#cb166-1461" aria-hidden="true" tabindex="-1"></a>var_com_aspas4 <span class="ot">&lt;-</span> <span class="st">'Ela disse: </span><span class="sc">\'</span><span class="st">Eu adoro lasanha.</span><span class="sc">\'</span><span class="st">'</span></span>
<span id="cb166-1462"><a href="#cb166-1462" aria-hidden="true" tabindex="-1"></a>var_com_aspas4</span>
<span id="cb166-1463"><a href="#cb166-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1464"><a href="#cb166-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1467"><a href="#cb166-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1468"><a href="#cb166-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(var_com_aspas4)</span>
<span id="cb166-1469"><a href="#cb166-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1470"><a href="#cb166-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1471"><a href="#cb166-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.1 Caracteres especiais</span></span>
<span id="cb166-1472"><a href="#cb166-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1473"><a href="#cb166-1473" aria-hidden="true" tabindex="-1"></a>Quando estamos trabalhando com textos, frequentemente temos caracteres especiais. Caracteres especiais são caracteres que não são alfanuméricos e muitas vezes têm funções específicas ou significados especiais em linguagens de programação e processamento de texto. Aqui estão alguns exemplos comuns de caracteres especiais:</span>
<span id="cb166-1474"><a href="#cb166-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1475"><a href="#cb166-1475" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Espaço em Branco**: O espaço em branco, muitas vezes representado como ” ” ou “\s” em linguagens de programação, é um caractere especial que denota um espaço vazio entre palavras ou caracteres em uma string.</span>
<span id="cb166-1476"><a href="#cb166-1476" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Em R, podemos usar espaços em branco em strings de texto da maneira usual. Por exemplo:</span>
<span id="cb166-1477"><a href="#cb166-1477" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1480"><a href="#cb166-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1481"><a href="#cb166-1481" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="st">"Isso é um exemplo de texto com espaços em branco."</span></span>
<span id="cb166-1482"><a href="#cb166-1482" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto)</span>
<span id="cb166-1483"><a href="#cb166-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1484"><a href="#cb166-1484" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1485"><a href="#cb166-1485" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Nova Linha (\n)**: O caractere “\n” é usado para representar uma quebra de linha em uma string. Quando incluído em uma string, ele faz com que o texto subsequente seja exibido em uma nova linha.</span>
<span id="cb166-1486"><a href="#cb166-1486" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Para criar uma nova linha em uma string, podemos usar “\n”. Isso é útil para criar múltiplas linhas de texto.</span>
<span id="cb166-1487"><a href="#cb166-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1490"><a href="#cb166-1490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1491"><a href="#cb166-1491" aria-hidden="true" tabindex="-1"></a>texto_multilinhas <span class="ot">&lt;-</span> <span class="st">"Primeira linha</span><span class="sc">\n</span><span class="st">Segunda linha</span><span class="sc">\n</span><span class="st">Terceira linha"</span></span>
<span id="cb166-1492"><a href="#cb166-1492" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto_multilinhas)</span>
<span id="cb166-1493"><a href="#cb166-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1494"><a href="#cb166-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1495"><a href="#cb166-1495" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Tabulação (\t)**: O caractere “\t” representa uma tabulação horizontal. É frequentemente usado para criar recuos ou alinhar o texto em colunas.</span>
<span id="cb166-1496"><a href="#cb166-1496" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Para adicionar tabulações em uma string, você pode usar “\t”.</span>
<span id="cb166-1497"><a href="#cb166-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1500"><a href="#cb166-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1501"><a href="#cb166-1501" aria-hidden="true" tabindex="-1"></a>texto_tabulado <span class="ot">&lt;-</span> <span class="st">"Primeira coluna</span><span class="sc">\t</span><span class="st">Segunda coluna</span><span class="sc">\t</span><span class="st">Terceira coluna"</span> </span>
<span id="cb166-1502"><a href="#cb166-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto_tabulado)</span>
<span id="cb166-1503"><a href="#cb166-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1504"><a href="#cb166-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1505"><a href="#cb166-1505" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Caracteres de Escape (\)**: O caractere “\” é usado como um caractere de escape em muitas linguagens de programação. Isso significa que ele “escapa” o significado especial de outros caracteres, permitindo que você os inclua em uma string. Por exemplo, “\” é usado para representar uma única barra invertida em vez de um caractere de escape.</span>
<span id="cb166-1506"><a href="#cb166-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1509"><a href="#cb166-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1510"><a href="#cb166-1510" aria-hidden="true" tabindex="-1"></a>texto_com_barras <span class="ot">&lt;-</span> <span class="st">"Isso é uma única barra invertida: </span><span class="sc">\\</span><span class="st">"</span></span>
<span id="cb166-1511"><a href="#cb166-1511" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto_com_barras)</span>
<span id="cb166-1512"><a href="#cb166-1512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1513"><a href="#cb166-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1514"><a href="#cb166-1514" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Caracteres Unicode**: Em linguagens de programação modernas, podemos usar caracteres Unicode em strings para representar uma ampla variedade de caracteres especiais de diferentes idiomas e símbolos.</span>
<span id="cb166-1515"><a href="#cb166-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Podemos utilizar códigos Unicode para incluir caracteres especiais em uma string em R. Por exemplo, o símbolo do grau (°) pode ser representado pelo código Unicode “\u00B0”.</span>
<span id="cb166-1516"><a href="#cb166-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1517"><a href="#cb166-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1520"><a href="#cb166-1520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1521"><a href="#cb166-1521" aria-hidden="true" tabindex="-1"></a>texto_unicode_grau <span class="ot">&lt;-</span> <span class="st">"A temperatura é de 25\u00B0C."</span></span>
<span id="cb166-1522"><a href="#cb166-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto_unicode_grau)</span>
<span id="cb166-1523"><a href="#cb166-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1524"><a href="#cb166-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1525"><a href="#cb166-1525" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>O símbolo “\n” (nova linha), pode ser representados usando seus códigos Unicode.</span>
<span id="cb166-1528"><a href="#cb166-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1529"><a href="#cb166-1529" aria-hidden="true" tabindex="-1"></a>texto_multilinhas_unicode <span class="ot">&lt;-</span> <span class="st">"Primeira linha\u000ASegunda linha"</span></span>
<span id="cb166-1530"><a href="#cb166-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(texto_multilinhas_unicode)</span>
<span id="cb166-1531"><a href="#cb166-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1532"><a href="#cb166-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1533"><a href="#cb166-1533" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Caracteres matemáticos, como o símbolo de somatório ($\sum$), podem ser representados com seus códigos Unicode.</span>
<span id="cb166-1534"><a href="#cb166-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1537"><a href="#cb166-1537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1538"><a href="#cb166-1538" aria-hidden="true" tabindex="-1"></a>simbolo_somatorio <span class="ot">&lt;-</span> <span class="st">"O símolo do somatório é: \u2211"</span></span>
<span id="cb166-1539"><a href="#cb166-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(simbolo_somatorio)</span>
<span id="cb166-1540"><a href="#cb166-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1541"><a href="#cb166-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1542"><a href="#cb166-1542" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Emojis também podem ser representados por Unicode.</span>
<span id="cb166-1543"><a href="#cb166-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1546"><a href="#cb166-1546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1547"><a href="#cb166-1547" aria-hidden="true" tabindex="-1"></a>emoji <span class="ot">&lt;-</span> <span class="st">"OMG! Também posso usar emoji! \U1F631"</span></span>
<span id="cb166-1548"><a href="#cb166-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(emoji)</span>
<span id="cb166-1549"><a href="#cb166-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1550"><a href="#cb166-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1551"><a href="#cb166-1551" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.2 Concatenando strings</span></span>
<span id="cb166-1552"><a href="#cb166-1552" aria-hidden="true" tabindex="-1"></a>Muitas vezes temos interesse em combinar strings, como faziamos antes com a função <span class="in">`paste()`</span>.</span>
<span id="cb166-1553"><a href="#cb166-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1556"><a href="#cb166-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1557"><a href="#cb166-1557" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">nome =</span> <span class="fu">c</span>(<span class="st">"Ana"</span>, <span class="st">"Maria"</span>, <span class="st">"João"</span>, <span class="cn">NA</span>), </span>
<span id="cb166-1558"><a href="#cb166-1558" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sobrenome=</span> <span class="fu">c</span>(<span class="st">"Santos"</span>, <span class="st">"Silva"</span>, <span class="st">"Souza"</span>, <span class="cn">NA</span>))</span>
<span id="cb166-1559"><a href="#cb166-1559" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1560"><a href="#cb166-1560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ola =</span> <span class="fu">str_c</span>(<span class="st">"Boa noite "</span>, nome, <span class="st">" "</span>, sobrenome, <span class="st">"!"</span>))</span>
<span id="cb166-1561"><a href="#cb166-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1562"><a href="#cb166-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1563"><a href="#cb166-1563" aria-hidden="true" tabindex="-1"></a>Alternativamente, quando temos diversas variáveis que queremos combinar, podemos utilizar a função <span class="in">`str_glue`</span>.</span>
<span id="cb166-1564"><a href="#cb166-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1567"><a href="#cb166-1567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1568"><a href="#cb166-1568" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1569"><a href="#cb166-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mensagem =</span> <span class="fu">str_glue</span>(<span class="st">"Boa noite {nome} {sobrenome}!"</span>))</span>
<span id="cb166-1570"><a href="#cb166-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1571"><a href="#cb166-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1572"><a href="#cb166-1572" aria-hidden="true" tabindex="-1"></a>Outra opção para a qual utilizamavamos o <span class="in">`paste`</span>, era para unir todos os elementos de uma string, utilizando o argumento <span class="in">`collapse`</span>.</span>
<span id="cb166-1573"><a href="#cb166-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1574"><a href="#cb166-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1577"><a href="#cb166-1577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1578"><a href="#cb166-1578" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>nome <span class="sc">%&gt;%</span> </span>
<span id="cb166-1579"><a href="#cb166-1579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(., <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb166-1580"><a href="#cb166-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1581"><a href="#cb166-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1582"><a href="#cb166-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1583"><a href="#cb166-1583" aria-hidden="true" tabindex="-1"></a>Uma alternativa é utilizarmos a função <span class="in">`str_flatten`</span>.</span>
<span id="cb166-1584"><a href="#cb166-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1587"><a href="#cb166-1587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1588"><a href="#cb166-1588" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>nome <span class="sc">%&gt;%</span> </span>
<span id="cb166-1589"><a href="#cb166-1589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_flatten</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-1590"><a href="#cb166-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1591"><a href="#cb166-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1594"><a href="#cb166-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1595"><a href="#cb166-1595" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>nome <span class="sc">%&gt;%</span> </span>
<span id="cb166-1596"><a href="#cb166-1596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_flatten</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">collapse =</span> <span class="st">", "</span>, <span class="at">last =</span> <span class="st">" e "</span>)</span>
<span id="cb166-1597"><a href="#cb166-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1598"><a href="#cb166-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1599"><a href="#cb166-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.3 Separando Strings</span></span>
<span id="cb166-1600"><a href="#cb166-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1601"><a href="#cb166-1601" aria-hidden="true" tabindex="-1"></a>Muitas vezes precisamos separar uma string em duas (ou mais). Na aula passada vimos a função <span class="in">`separate`</span>. Hoje vamos ver a <span class="in">`str_split`</span>.</span>
<span id="cb166-1602"><a href="#cb166-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1605"><a href="#cb166-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1606"><a href="#cb166-1606" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb166-1607"><a href="#cb166-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nome_Sobrenome =</span> <span class="fu">str_c</span>(nome, sobrenome, <span class="at">sep =</span> <span class="st">" "</span>))</span>
<span id="cb166-1608"><a href="#cb166-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1609"><a href="#cb166-1609" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Nome_Sobrenome <span class="sc">%&gt;%</span> </span>
<span id="cb166-1610"><a href="#cb166-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(., <span class="st">" "</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-1611"><a href="#cb166-1611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1612"><a href="#cb166-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1613"><a href="#cb166-1613" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.4 Formatação básica</span></span>
<span id="cb166-1614"><a href="#cb166-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1615"><a href="#cb166-1615" aria-hidden="true" tabindex="-1"></a>Muitas vezes queremos passar um texto para caixa alta, caixa baixa, título ou até mesmo formato de sentença. Para isso podemos utilizar as funções: <span class="in">`str_to_upper()`</span>, <span class="in">`str_to_lower()`</span>, <span class="in">`str_to_title()`</span> e <span class="in">`str_to_sentence()`</span> respectivamente.</span>
<span id="cb166-1616"><a href="#cb166-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1617"><a href="#cb166-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1620"><a href="#cb166-1620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1621"><a href="#cb166-1621" aria-hidden="true" tabindex="-1"></a>texto_exemplo <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"caixa baixa"</span>, <span class="st">"CAIXA ALTA"</span>, <span class="st">"Texto de sentença"</span>, <span class="st">"Texto Em Título"</span>)</span>
<span id="cb166-1622"><a href="#cb166-1622" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_lower</span>(texto_exemplo)</span>
<span id="cb166-1623"><a href="#cb166-1623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1624"><a href="#cb166-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1625"><a href="#cb166-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1628"><a href="#cb166-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1629"><a href="#cb166-1629" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_sentence</span>(texto_exemplo)</span>
<span id="cb166-1630"><a href="#cb166-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1631"><a href="#cb166-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1634"><a href="#cb166-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1635"><a href="#cb166-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_title</span>(texto_exemplo)</span>
<span id="cb166-1636"><a href="#cb166-1636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1637"><a href="#cb166-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1640"><a href="#cb166-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1641"><a href="#cb166-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">str_to_upper</span>(texto_exemplo)</span>
<span id="cb166-1642"><a href="#cb166-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1643"><a href="#cb166-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1644"><a href="#cb166-1644" aria-hidden="true" tabindex="-1"></a>Algumas vezes recebemos um texto desformatado, no sentido de conter diversos espaços no meio do texto. E temos interesse em limpar os excessos de espaço. Para isso podemos utilizar as seguintes funções: <span class="in">`str_trim()`</span> e <span class="in">`str_squish()`</span>.</span>
<span id="cb166-1645"><a href="#cb166-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1648"><a href="#cb166-1648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1649"><a href="#cb166-1649" aria-hidden="true" tabindex="-1"></a>texto_com_espaços <span class="ot">=</span> <span class="st">"  Olá, esse texto tem    diversos        espaços completamente desnecessários. "</span></span>
<span id="cb166-1650"><a href="#cb166-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1651"><a href="#cb166-1651" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(texto_com_espaços, <span class="at">side =</span> <span class="st">"left"</span>)</span>
<span id="cb166-1652"><a href="#cb166-1652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1653"><a href="#cb166-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1656"><a href="#cb166-1656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1657"><a href="#cb166-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(texto_com_espaços, <span class="at">side =</span> <span class="st">"right"</span>)</span>
<span id="cb166-1658"><a href="#cb166-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1659"><a href="#cb166-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1662"><a href="#cb166-1662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1663"><a href="#cb166-1663" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(texto_com_espaços, <span class="at">side =</span> <span class="st">"both"</span>)</span>
<span id="cb166-1664"><a href="#cb166-1664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1665"><a href="#cb166-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1668"><a href="#cb166-1668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1669"><a href="#cb166-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">str_squish</span>(texto_com_espaços)</span>
<span id="cb166-1670"><a href="#cb166-1670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1671"><a href="#cb166-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1672"><a href="#cb166-1672" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.5 Comprimento de string</span></span>
<span id="cb166-1673"><a href="#cb166-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1674"><a href="#cb166-1674" aria-hidden="true" tabindex="-1"></a>Muitas vezes temos interesse em encontrar textos incorretos em um banco de dados, uma maneira de identificar essas observações é simplesmente por contar a quantidade de caracteres de uma string. Para isso podemos utilizar a função <span class="in">`str_length()`</span>.</span>
<span id="cb166-1675"><a href="#cb166-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1678"><a href="#cb166-1678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1679"><a href="#cb166-1679" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1680"><a href="#cb166-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comprimento_nome =</span> <span class="fu">str_length</span>(nome))</span>
<span id="cb166-1681"><a href="#cb166-1681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1682"><a href="#cb166-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1683"><a href="#cb166-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1684"><a href="#cb166-1684" aria-hidden="true" tabindex="-1"></a>Alternativamente podemos estar interessados em contar a quantidade de caracteres especificos. Para isso, utilizamos a função <span class="in">`str_count()`</span>.</span>
<span id="cb166-1685"><a href="#cb166-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1688"><a href="#cb166-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1689"><a href="#cb166-1689" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1690"><a href="#cb166-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qtd_a =</span> <span class="fu">str_count</span>(nome, <span class="st">"a"</span>))</span>
<span id="cb166-1691"><a href="#cb166-1691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1692"><a href="#cb166-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1695"><a href="#cb166-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1696"><a href="#cb166-1696" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1697"><a href="#cb166-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qtd_vogais =</span> <span class="fu">str_count</span>(nome, <span class="st">"[aeiou]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-1698"><a href="#cb166-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qtd_consoantes =</span> <span class="fu">str_count</span>(nome, <span class="st">"[^aeiou]"</span>))</span>
<span id="cb166-1699"><a href="#cb166-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1700"><a href="#cb166-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1701"><a href="#cb166-1701" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.6 Substituição de strings</span></span>
<span id="cb166-1702"><a href="#cb166-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1703"><a href="#cb166-1703" aria-hidden="true" tabindex="-1"></a>Algumas vezes podemos estar interessados em substituir alguma string por outra. Para isso podemos utilizar a função <span class="in">`str_replace()`</span>.</span>
<span id="cb166-1704"><a href="#cb166-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1707"><a href="#cb166-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1708"><a href="#cb166-1708" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1709"><a href="#cb166-1709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nome =</span> <span class="fu">str_replace</span>(nome, <span class="st">"ã"</span>, <span class="st">"a"</span>))</span>
<span id="cb166-1710"><a href="#cb166-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1711"><a href="#cb166-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1712"><a href="#cb166-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1713"><a href="#cb166-1713" aria-hidden="true" tabindex="-1"></a>Outras vezes queremos simplesmente remover algum caracter. Para isso utilizamos a função <span class="in">`str_remove()`</span> para remover a primeira instância do caracter ou <span class="in">`str_remove_all()`</span> para remover todas as instâncias.</span>
<span id="cb166-1714"><a href="#cb166-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1717"><a href="#cb166-1717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1718"><a href="#cb166-1718" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1719"><a href="#cb166-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nome =</span> <span class="fu">str_remove</span>(nome, <span class="st">"[aeiouã]"</span>))</span>
<span id="cb166-1720"><a href="#cb166-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1721"><a href="#cb166-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1724"><a href="#cb166-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1725"><a href="#cb166-1725" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb166-1726"><a href="#cb166-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nome =</span> <span class="fu">str_remove_all</span>(nome, <span class="st">"[aeiouã]"</span>))</span>
<span id="cb166-1727"><a href="#cb166-1727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1728"><a href="#cb166-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1729"><a href="#cb166-1729" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.7 Expressões Regulares</span></span>
<span id="cb166-1730"><a href="#cb166-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1731"><a href="#cb166-1731" aria-hidden="true" tabindex="-1"></a>Expressões regulares, muitas vezes abreviadas como “RegEx” são padrões de texto que descrevem conjuntos de *strings*. Elas são amplamente utilizadas para realizar operações de busca, correspondência e manipulação de *strings* em linguagens de programação e ferramentas de processamento de texto, incluindo R. Alguns símbolos e conceitos-chave em expressões regulares:</span>
<span id="cb166-1732"><a href="#cb166-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1733"><a href="#cb166-1733" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Literais:** Caracteres literais correspondem a si mesmos. Por exemplo, a regex “abc” corresponderá à sequência “abc” em uma string.</span>
<span id="cb166-1734"><a href="#cb166-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1737"><a href="#cb166-1737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1738"><a href="#cb166-1738" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="st">"O gato é um animal adorável."</span></span>
<span id="cb166-1739"><a href="#cb166-1739" aria-hidden="true" tabindex="-1"></a>padrao <span class="ot">&lt;-</span> <span class="st">"gato"</span></span>
<span id="cb166-1740"><a href="#cb166-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, padrao)</span>
<span id="cb166-1741"><a href="#cb166-1741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1742"><a href="#cb166-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1743"><a href="#cb166-1743" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Meta-caracteres:** São caracteres com significados especiais em regex. Alguns exemplos incluem:</span>
<span id="cb166-1744"><a href="#cb166-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1745"><a href="#cb166-1745" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`.`</span> (ponto): Corresponde a qualquer caractere, exceto uma nova linha.</span>
<span id="cb166-1746"><a href="#cb166-1746" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`*`</span>: Corresponde a zero ou mais ocorrências do caractere ou grupo anterior.</span>
<span id="cb166-1747"><a href="#cb166-1747" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`+`</span>: Corresponde a uma ou mais ocorrências do caractere ou grupo anterior.</span>
<span id="cb166-1748"><a href="#cb166-1748" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`?`</span>: Corresponde a zero ou uma ocorrência do caractere ou grupo anterior.</span>
<span id="cb166-1749"><a href="#cb166-1749" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`[]`</span>: Define uma classe de caracteres. Por exemplo, <span class="in">`[aeiou]`</span> corresponde a qualquer vogal.</span>
<span id="cb166-1750"><a href="#cb166-1750" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`|`</span> (barra vertical): Funciona como um “OU” lógico. Por exemplo, “a|b” corresponde a “a” ou “b”.</span>
<span id="cb166-1751"><a href="#cb166-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1754"><a href="#cb166-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1755"><a href="#cb166-1755" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"O rato correu para o buraco."</span>, </span>
<span id="cb166-1756"><a href="#cb166-1756" aria-hidden="true" tabindex="-1"></a>           <span class="st">"O gato correu para o buraco."</span>,</span>
<span id="cb166-1757"><a href="#cb166-1757" aria-hidden="true" tabindex="-1"></a>           <span class="st">"O mato."</span>)</span>
<span id="cb166-1758"><a href="#cb166-1758" aria-hidden="true" tabindex="-1"></a>padrao <span class="ot">&lt;-</span> <span class="st">"(g|r)ato"</span></span>
<span id="cb166-1759"><a href="#cb166-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, padrao)</span>
<span id="cb166-1760"><a href="#cb166-1760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1761"><a href="#cb166-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1762"><a href="#cb166-1762" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Âncoras**: São usadas para ancorar padrões em posições específicas da string.</span>
<span id="cb166-1763"><a href="#cb166-1763" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`^`</span>: Corresponde ao início da string.</span>
<span id="cb166-1764"><a href="#cb166-1764" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`$`</span>: Corresponde ao final da string.</span>
<span id="cb166-1765"><a href="#cb166-1765" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`\b`</span>: Corresponde a uma borda de palavra (início ou fim de uma palavra).</span>
<span id="cb166-1766"><a href="#cb166-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1769"><a href="#cb166-1769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1770"><a href="#cb166-1770" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Banana"</span>, <span class="st">"Ana"</span>, <span class="st">"Ananas"</span>)</span>
<span id="cb166-1771"><a href="#cb166-1771" aria-hidden="true" tabindex="-1"></a>padrao <span class="ot">&lt;-</span> <span class="st">"^ana"</span></span>
<span id="cb166-1772"><a href="#cb166-1772" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, padrao)</span>
<span id="cb166-1773"><a href="#cb166-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1774"><a href="#cb166-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1777"><a href="#cb166-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1778"><a href="#cb166-1778" aria-hidden="true" tabindex="-1"></a><span class="do">## Ignorar case</span></span>
<span id="cb166-1779"><a href="#cb166-1779" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, <span class="st">"(?i)ana"</span>)</span>
<span id="cb166-1780"><a href="#cb166-1780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1781"><a href="#cb166-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1784"><a href="#cb166-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1785"><a href="#cb166-1785" aria-hidden="true" tabindex="-1"></a><span class="do">## Ignorar case, terminar com ana</span></span>
<span id="cb166-1786"><a href="#cb166-1786" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, <span class="st">"(?i)ana$"</span>)</span>
<span id="cb166-1787"><a href="#cb166-1787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1788"><a href="#cb166-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1791"><a href="#cb166-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1792"><a href="#cb166-1792" aria-hidden="true" tabindex="-1"></a><span class="do">## Ignorar case, começar com ana</span></span>
<span id="cb166-1793"><a href="#cb166-1793" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, <span class="st">"(?i)^ana"</span>)</span>
<span id="cb166-1794"><a href="#cb166-1794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1795"><a href="#cb166-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1798"><a href="#cb166-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1799"><a href="#cb166-1799" aria-hidden="true" tabindex="-1"></a><span class="do">## Ignorar case, exatamente  ana</span></span>
<span id="cb166-1800"><a href="#cb166-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(texto, <span class="st">"(?i)^ana$"</span>)</span>
<span id="cb166-1801"><a href="#cb166-1801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1802"><a href="#cb166-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1803"><a href="#cb166-1803" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Grupos**: Parênteses <span class="in">`()`</span> são usados para agrupar caracteres em subexpressões. Isso é útil para aplicar operadores a um conjunto de caracteres.</span>
<span id="cb166-1804"><a href="#cb166-1804" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Exemplo: <span class="in">`(abc)+`</span> corresponde a “abc”, “abcabc”, “abcabcabc”, etc.</span>
<span id="cb166-1805"><a href="#cb166-1805" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1808"><a href="#cb166-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1809"><a href="#cb166-1809" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(texto, <span class="st">"(na)+"</span>)</span>
<span id="cb166-1810"><a href="#cb166-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1811"><a href="#cb166-1811" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1812"><a href="#cb166-1812" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Quantificadores**: Controlam o número de ocorrências de um caractere ou grupo.</span>
<span id="cb166-1813"><a href="#cb166-1813" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`{n}`</span>: Corresponde exatamente a n ocorrências.</span>
<span id="cb166-1814"><a href="#cb166-1814" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`{n,}`</span>: Corresponde a pelo menos n ocorrências.</span>
<span id="cb166-1815"><a href="#cb166-1815" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`{n,m}`</span>: Corresponde de n a m ocorrências.</span>
<span id="cb166-1816"><a href="#cb166-1816" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1819"><a href="#cb166-1819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1820"><a href="#cb166-1820" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="st">"Os números 123 e 456 são importantes."</span></span>
<span id="cb166-1821"><a href="#cb166-1821" aria-hidden="true" tabindex="-1"></a>padrao <span class="ot">&lt;-</span> <span class="st">"</span><span class="sc">\\</span><span class="st">d{3}"</span></span>
<span id="cb166-1822"><a href="#cb166-1822" aria-hidden="true" tabindex="-1"></a>numeros <span class="ot">&lt;-</span> <span class="fu">str_extract_all</span>(texto, padrao, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-1823"><a href="#cb166-1823" aria-hidden="true" tabindex="-1"></a>numeros</span>
<span id="cb166-1824"><a href="#cb166-1824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1825"><a href="#cb166-1825" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-1828"><a href="#cb166-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb166-1829"><a href="#cb166-1829" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> <span class="st">"Os números 123, 456 e 78 são importantes."</span></span>
<span id="cb166-1830"><a href="#cb166-1830" aria-hidden="true" tabindex="-1"></a>padrao <span class="ot">&lt;-</span> <span class="st">"</span><span class="sc">\\</span><span class="st">d{2}"</span></span>
<span id="cb166-1831"><a href="#cb166-1831" aria-hidden="true" tabindex="-1"></a>numeros <span class="ot">&lt;-</span> <span class="fu">str_extract_all</span>(texto, padrao, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-1832"><a href="#cb166-1832" aria-hidden="true" tabindex="-1"></a>numeros</span>
<span id="cb166-1833"><a href="#cb166-1833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb166-1834"><a href="#cb166-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1835"><a href="#cb166-1835" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9.8 Exercício</span></span>
<span id="cb166-1836"><a href="#cb166-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1837"><a href="#cb166-1837" aria-hidden="true" tabindex="-1"></a>Utilizando os dados disponíveis em <span class="in">`words`</span> crie RegEx capaz de encontrar palavras que:</span>
<span id="cb166-1838"><a href="#cb166-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1839"><a href="#cb166-1839" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Comece com “y”.</span>
<span id="cb166-1840"><a href="#cb166-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1841"><a href="#cb166-1841" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Não comece com “y”.</span>
<span id="cb166-1842"><a href="#cb166-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1843"><a href="#cb166-1843" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Termine com “x”.</span>
<span id="cb166-1844"><a href="#cb166-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1845"><a href="#cb166-1845" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Tenham exatamente três letras.</span>
<span id="cb166-1846"><a href="#cb166-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1847"><a href="#cb166-1847" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Tenham sete letras ou mais.</span>
<span id="cb166-1848"><a href="#cb166-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1849"><a href="#cb166-1849" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Contenham um par vogal-consoante.</span>
<span id="cb166-1850"><a href="#cb166-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1851"><a href="#cb166-1851" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Contenham pelo menos dois pares vogal-consoante consecutivos.</span>
<span id="cb166-1852"><a href="#cb166-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1853"><a href="#cb166-1853" aria-hidden="true" tabindex="-1"></a>Para cada um dos desafios a seguir, tente resolvê-los usando tanto uma única expressão regular quanto uma combinação de várias chamadas de <span class="in">`str_detect()`</span>:</span>
<span id="cb166-1854"><a href="#cb166-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1855"><a href="#cb166-1855" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Encontre todas as palavras que começam ou terminam com “x”.</span>
<span id="cb166-1856"><a href="#cb166-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1857"><a href="#cb166-1857" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Encontre todas as palavras que começam com uma vogal e terminam com uma consoante.</span>
<span id="cb166-1858"><a href="#cb166-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1859"><a href="#cb166-1859" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Existem palavras que contêm pelo menos uma de cada vogal diferente?</span>
<span id="cb166-1860"><a href="#cb166-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1861"><a href="#cb166-1861" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Em <span class="in">`colors()`</span> existem diversos modificadores de cores como *light* e *dark*. Crie um banco contendo o nome da cor original e o nome sem o modificador.</span>
<span id="cb166-1862"><a href="#cb166-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1863"><a href="#cb166-1863" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.10 Cheatsheets</span></span>
<span id="cb166-1864"><a href="#cb166-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1865"><a href="#cb166-1865" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">TidyR</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf)</span></span>
<span id="cb166-1866"><a href="#cb166-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1867"><a href="#cb166-1867" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Manipulando dados</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/translations/portuguese/data-wrangling_pt.pdf)</span></span>
<span id="cb166-1868"><a href="#cb166-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1869"><a href="#cb166-1869" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Lubridate</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/lubridate.pdf)</span></span>
<span id="cb166-1870"><a href="#cb166-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1871"><a href="#cb166-1871" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Strings</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/strings.pdf)</span></span>
<span id="cb166-1872"><a href="#cb166-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1873"><a href="#cb166-1873" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">RegEx</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/regex.pdf)</span></span>
<span id="cb166-1874"><a href="#cb166-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1875"><a href="#cb166-1875" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Para saber mais sobre RegEx</span><span class="co">](https://regexr.com/)</span></span>
<span id="cb166-1876"><a href="#cb166-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-1877"><a href="#cb166-1877" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Jogo de palavra cruzadas em <span class="co">[</span><span class="ot">RegEx</span><span class="co">](https://regexcrossword.com/)</span>.</span>
<span id="cb166-1878"><a href="#cb166-1878" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>