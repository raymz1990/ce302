{
  "hash": "a56f632cb4a3d3f6731e4ff35a285031",
  "result": {
    "markdown": "---\nalways_allow_html: true\ntitle: \"Aula 08\"\n---\n\n\n## Aula 08\n\n## Filtros, Sumarização de dados & manipulação de datas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(magrittr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::between()     masks data.table::between()\n✖ tidyr::extract()     masks magrittr::extract()\n✖ dplyr::filter()      masks stats::filter()\n✖ dplyr::first()       masks data.table::first()\n✖ lubridate::hour()    masks data.table::hour()\n✖ lubridate::isoweek() masks data.table::isoweek()\n✖ dplyr::lag()         masks stats::lag()\n✖ dplyr::last()        masks data.table::last()\n✖ lubridate::mday()    masks data.table::mday()\n✖ lubridate::minute()  masks data.table::minute()\n✖ lubridate::month()   masks data.table::month()\n✖ lubridate::quarter() masks data.table::quarter()\n✖ lubridate::second()  masks data.table::second()\n✖ purrr::set_names()   masks magrittr::set_names()\n✖ purrr::transpose()   masks data.table::transpose()\n✖ lubridate::wday()    masks data.table::wday()\n✖ lubridate::week()    masks data.table::week()\n✖ lubridate::yday()    masks data.table::yday()\n✖ lubridate::year()    masks data.table::year()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\ncar_crash <- fread(\"./data/Brazil Total highway crashes 2010 - 2023.csv.gz\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in (if (.Platform$OS.type == \"unix\") system else shell)(paste0(\"(\", :\nexecução de '(./data/Brazil Total highway crashes 2010 - 2023.csv.gz) >\nC:\\Users\\CONVID~1\\AppData\\Local\\Temp\\RtmpiocT2J\\file290c2eb8763c' falhou com\ncódigo de erro 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in fread(\"./data/Brazil Total highway crashes 2010 - 2023.csv.gz\"):\nFile 'C:\\Users\\CONVID~1\\AppData\\Local\\Temp\\RtmpiocT2J\\file290c2eb8763c' has\nsize 0. Returning a NULL data.table.\n```\n:::\n:::\n\n\n## Filtros nas observações\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(automovel > 8)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `automovel > 8`.\nCaused by error:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(automovel > 8 & caminhao > 5)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `automovel > 8 & caminhao > 5`.\nCaused by error:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(automovel > 8, caminhao > 5) # & implicito\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `automovel > 8`.\nCaused by error:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(automovel == 8 | caminhao == 5) # OU\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `automovel == 8 | caminhao == 5`.\nCaused by error:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(between(caminhao, 2, 7)) # valores dentro de um intervalo\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `between(caminhao, 2, 7)`.\nCaused by error in `between()`:\n! objeto 'caminhao' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(caminhao >= 2 & caminhao <= 7)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `caminhao >= 2 & caminhao <= 7`.\nCaused by error:\n! objeto 'caminhao' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# %in% Operador utilizado em strings / char / fatores\n\ncom_sem_vitima = car_crash %>% \n  filter(tipo_de_ocorrencia %in% c(\"com vítima\", \n                                   \"sem vítima\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")`.\nCaused by error in `tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n\n```{.r .cell-code}\ncontrario = car_crash %>% \n  filter(!(tipo_de_ocorrencia %in% c(\"com vítima\", \n                                   \"sem vítima\")))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `!(tipo_de_ocorrencia %in% c(\"com vítima\", \"sem\n  vítima\"))`.\nCaused by error in `tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n\n```{.r .cell-code}\n`%ni%` <- Negate(`%in%`) # define um operador de negação \"fora\"\n\ncontrario2 = car_crash %>% \n  filter(tipo_de_ocorrencia %ni% c(\"com vítima\", \n                                   \"sem vítima\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `tipo_de_ocorrencia %ni% c(\"com vítima\", \"sem vítima\")`.\nCaused by error in `f()`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(automovel > mean(automovel, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `automovel > mean(automovel, na.rm = TRUE)`.\nCaused by error:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(tipo_de_ocorrencia == \"vítima\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `tipo_de_ocorrencia == \"vítima\"`.\nCaused by error:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n\n```{.r .cell-code}\nvitima = car_crash %>% \n  filter(tipo_de_ocorrencia %like% \"vítima\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `tipo_de_ocorrencia %like% \"vítima\"`.\nCaused by error in `is.factor()`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n    filter(grepl(\"ilesa|fatal\", tipo_de_ocorrencia))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `grepl(\"ilesa|fatal\", tipo_de_ocorrencia)`.\nCaused by error in `is.factor()`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n:::\n\n\n## Sumarização de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabela <- car_crash %>% \n  summarise(n = n(), \n            media_ac_automoveis = mean(automovel, na.rm = T), \n            media_ac_caminhao = mean(caminhao, na.rm = TRUE), \n            mediana_ac_trator, median(trator_maquinas, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `summarise()`:\nℹ In argument: `media_ac_automoveis = mean(automovel, na.rm = T)`.\nCaused by error in `mean()`:\n! objeto 'automovel' não encontrado\n```\n:::\n:::\n\n\n### Resumo por caracteristicas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_crash %>% \n  filter(tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")) %>% \n  group_by(tipo_de_ocorrencia) %>% \n  summarise(n = n(), max = max(automovel, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\nℹ In argument: `tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")`.\nCaused by error in `tipo_de_ocorrencia %in% c(\"com vítima\", \"sem vítima\")`:\n! objeto 'tipo_de_ocorrencia' não encontrado\n```\n:::\n:::\n\n\n## Exercícios\n\nUtilizando o banco de dados starwars faça o que se pede: 1. Qual é o número total de espécies únicas presentes? Qual a frequência de indivíduos por espécie?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars %>% \n  group_by(species) %>% \n  summarise(n = n()) %>% \n  arrange(desc(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 38 × 2\n   species      n\n   <chr>    <int>\n 1 Human       35\n 2 Droid        6\n 3 <NA>         4\n 4 Gungan       3\n 5 Kaminoan     2\n 6 Mirialan     2\n 7 Twi'lek      2\n 8 Wookiee      2\n 9 Zabrak       2\n10 Aleena       1\n# ℹ 28 more rows\n```\n:::\n:::\n\n\n2.  Calcule a altura média de personagens masculinos e femininos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars %>% \n  group_by(gender) %>% \n  summarise(media = mean(height, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  gender    media\n  <chr>     <dbl>\n1 feminine   165.\n2 masculine  177.\n3 <NA>       181.\n```\n:::\n:::\n\n\n3.  Qual é a média de idade dos personagens de cada espécie para personagens masculinos?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars %>% \n  filter(gender,= \"masculine\") %>% \n  group_by(species) %>% \n  summarise(mean = mean(birth_year, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: <text>:2:17: '=' inesperado\n1: starwars %>% \n2:   filter(gender,=\n                   ^\n```\n:::\n:::\n\n\n4.  Para cada espécie presente na base de dados, identifique o personagem mais velho e sua idade correspondente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars %>% \n  group_by(species) %>% \n  mutate(max_idade = max(birth_year, na.rm = TRUE)) %>% \n  filter(max_idade == birth_year) %>% \n  ungroup() %>% \n  select(name, max_idade) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There were 22 warnings in `mutate()`.\nThe first warning was:\nℹ In argument: `max_idade = max(birth_year, na.rm = TRUE)`.\nℹ In group 1: `species = \"Aleena\"`.\nCaused by warning in `max()`:\n! nenhum argumento não faltante para max; retornando -Inf\nℹ Run `dplyr::last_dplyr_warnings()` to see the 21 remaining warnings.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 16 × 2\n   name                  max_idade\n   <chr>                     <dbl>\n 1 C-3PO                       112\n 2 Chewbacca                   200\n 3 Greedo                       44\n 4 Jabba Desilijic Tiure       600\n 5 Yoda                        896\n 6 Bossk                        53\n 7 Ackbar                       41\n 8 Wicket Systri Warrick         8\n 9 Jar Jar Binks                52\n10 Quarsh Panaka                62\n11 Darth Maul                   54\n12 Ayla Secura                  48\n13 Ki-Adi-Mundi                 92\n14 Plo Koon                     22\n15 Luminara Unduli              58\n16 Dooku                       102\n```\n:::\n:::\n\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nminha_data = \"11-09-2023\"\nminha_data = as.Date(minha_data, format = \"%d-%m-%Y\")\n\n##YYYYMMDD\n\nminha_data +5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2023-09-16\"\n```\n:::\n\n```{.r .cell-code}\nminha_data > minha_data +25\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nano = format(minha_data, \"%Y\")\nANO = format(minha_data, \"%y\")\nmes = format(minha_data, \"%m\")\ndia = format(minha_data, \"%d\")\n\ndifftime(minha_data, (minha_data + 25))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of -25 days\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(lubridate)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}