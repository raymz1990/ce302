{
  "hash": "de641610fece9a9c7e8577f5dfac1691",
  "result": {
    "markdown": "---\nalways_allow_html: true\ntitle: \"Aula 09\"\n---\n\n\n# Aula 09\n\n## Junção de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(nycflights13)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: nycflights13\n```\n:::\n\n```{.r .cell-code}\n# install.packages(\"nycflights13\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nairlines\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 16 × 2\n   carrier name                       \n   <chr>   <chr>                      \n 1 9E      Endeavor Air Inc.          \n 2 AA      American Airlines Inc.     \n 3 AS      Alaska Airlines Inc.       \n 4 B6      JetBlue Airways            \n 5 DL      Delta Air Lines Inc.       \n 6 EV      ExpressJet Airlines Inc.   \n 7 F9      Frontier Airlines Inc.     \n 8 FL      AirTran Airways Corporation\n 9 HA      Hawaiian Airlines Inc.     \n10 MQ      Envoy Air                  \n11 OO      SkyWest Airlines Inc.      \n12 UA      United Air Lines Inc.      \n13 US      US Airways Inc.            \n14 VX      Virgin America             \n15 WN      Southwest Airlines Co.     \n16 YV      Mesa Airlines Inc.         \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nairports\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,458 × 8\n   faa   name                             lat    lon   alt    tz dst   tzone    \n   <chr> <chr>                          <dbl>  <dbl> <dbl> <dbl> <chr> <chr>    \n 1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…\n 2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…\n 3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…\n 4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…\n 5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…\n 6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…\n 7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…\n 8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…\n 9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…\n10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…\n# ℹ 1,448 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: dplyr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nplanes %>%  # chave primaria de planes é tailnum\n  count(tailnum) %>% \n  filter(n > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 2\n# ℹ 2 variables: tailnum <chr>, n <int>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather %>% \n  count(time_hour, origin) %>% \n  filter(n > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 3\n# ℹ 3 variables: time_hour <dttm>, origin <chr>, n <int>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather %>% \n  filter(is.na(time_hour)|is.na(origin))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 15\n# ℹ 15 variables: origin <chr>, year <int>, month <int>, day <int>, hour <int>,\n#   temp <dbl>, dewp <dbl>, humid <dbl>, wind_dir <dbl>, wind_speed <dbl>,\n#   wind_gust <dbl>, precip <dbl>, pressure <dbl>, visib <dbl>,\n#   time_hour <dttm>\n```\n:::\n\n```{.r .cell-code}\nplanes %>% \n  filter(is.na(tailnum))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 9\n# ℹ 9 variables: tailnum <chr>, year <int>, type <chr>, manufacturer <chr>,\n#   model <chr>, engines <int>, seats <int>, speed <int>, engine <chr>\n```\n:::\n:::\n\n\n## Junções\n\n### Junções Mutacionais\n\n-   inner_join\n-   full_join\n-   left_join\n-   right_join\n\nem Excel -\\> vlookup / procv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflights2 <- flights %>% \n  filter(distance > 2000) %>% \n  select(year, time_hour, origin, dest, tailnum, carrier)\n\nflights2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 6\n    year time_hour           origin dest  tailnum carrier\n   <int> <dttm>              <chr>  <chr> <chr>   <chr>  \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA     \n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA     \n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA     \n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA     \n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US     \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US     \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA     \n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA     \n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6     \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL     \n# ℹ 51,685 more rows\n```\n:::\n:::\n\n\n### Left Join\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflights2 %>% \n  left_join(., airlines)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(carrier)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n\n```{.r .cell-code}\nflights2 %>% \n  left_join(airlines)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(carrier)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n\n```{.r .cell-code}\nleft_join(flights2, airlines)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(carrier)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflights2 %>% \n  left_join(airlines, \n            by = \"carrier\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n\n```{.r .cell-code}\nflights2 %>% \n  left_join(airlines, \n            by = c(\"carrier\"=\"carrier\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n\n```{.r .cell-code}\nflights2 %>% \n  left_join(airlines, \n            join_by(carrier))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 7\n    year time_hour           origin dest  tailnum carrier name                 \n   <int> <dttm>              <chr>  <chr> <chr>   <chr>   <chr>                \n 1  2013 2013-01-01 06:00:00 JFK    LAX   N29129  UA      United Air Lines Inc.\n 2  2013 2013-01-01 06:00:00 EWR    SFO   N53441  UA      United Air Lines Inc.\n 3  2013 2013-01-01 06:00:00 EWR    LAS   N76515  UA      United Air Lines Inc.\n 4  2013 2013-01-01 06:00:00 JFK    SFO   N532UA  UA      United Air Lines Inc.\n 5  2013 2013-01-01 06:00:00 EWR    PHX   N807AW  US      US Airways Inc.      \n 6  2013 2013-01-01 06:00:00 JFK    PHX   N535UW  US      US Airways Inc.      \n 7  2013 2013-01-01 06:00:00 EWR    LAX   N33289  UA      United Air Lines Inc.\n 8  2013 2013-01-01 06:00:00 EWR    SNA   N38727  UA      United Air Lines Inc.\n 9  2013 2013-01-01 06:00:00 JFK    LAS   N558JB  B6      JetBlue Airways      \n10  2013 2013-01-01 07:00:00 JFK    SFO   N705TW  DL      Delta Air Lines Inc. \n# ℹ 51,685 more rows\n```\n:::\n:::\n\n\n## Right Join\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplanes_flights = flights2 %>% \n  right_join(planes, join_by(tailnum))\n```\n:::\n\n\n## Inner Join\n\n\n::: {.cell}\n\n```{.r .cell-code}\norigin_flights = flights2 %>% \n  inner_join(airports, by = c(\"origin\"= \"faa\"))\n\norigin_flights = flights2 %>% \n  inner_join(airports, join_by(origin == faa))\n```\n:::\n\n\n## Full Join\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndest_flights = flights2 %>% \n  full_join(airports, by = c(\"dest\"= \"faa\"))\n\ndest_flights = flights2 %>% \n  full_join(airports, join_by(dest == faa))\n```\n:::\n\n\n## Semi-Join\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairports %>% \n  semi_join(flights2, join_by(faa == origin))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 8\n  faa   name                  lat   lon   alt    tz dst   tzone           \n  <chr> <chr>               <dbl> <dbl> <dbl> <dbl> <chr> <chr>           \n1 EWR   Newark Liberty Intl  40.7 -74.2    18    -5 A     America/New_York\n2 JFK   John F Kennedy Intl  40.6 -73.8    13    -5 A     America/New_York\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nairports %>% \n  inner_join(flights2, join_by(faa == origin))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 51,695 × 13\n   faa   name        lat   lon   alt    tz dst   tzone  year time_hour          \n   <chr> <chr>     <dbl> <dbl> <dbl> <dbl> <chr> <chr> <int> <dttm>             \n 1 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 06:00:00\n 2 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 06:00:00\n 3 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 06:00:00\n 4 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 06:00:00\n 5 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 06:00:00\n 6 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 07:00:00\n 7 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 07:00:00\n 8 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 08:00:00\n 9 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 08:00:00\n10 EWR   Newark L…  40.7 -74.2    18    -5 A     Amer…  2013 2013-01-01 08:00:00\n# ℹ 51,685 more rows\n# ℹ 3 more variables: dest <chr>, tailnum <chr>, carrier <chr>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflights %>%\n  anti_join(airports, join_by(dest == faa)) %>% \n  distinct(dest)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 1\n  dest \n  <chr>\n1 BQN  \n2 SJU  \n3 STT  \n4 PSE  \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}